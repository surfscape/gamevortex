{% extends "./base.njk" %}

{% block content %}

    <div class="game--window">
        <div id="gameContainer" class="container">
            <canvas id="#canvas"></canvas>
        </div>
        <div class="game--window--controls">
            <span class="game--window--title">{{title}}</span>
            <button id="fullscreenButton">Fullscreen</button>
        </div>
    </div>
    <script src="/public/libs/UnityLoader.js"></script>
    <a style="display:none;"id="sourceLink" href="/public/library/unity/{{gamePath}}/{{gamePath}}.json">Game File</a>
    <script>
        const sourceLink = document
            .getElementById("sourceLink")
            .getAttribute("href");
        var gameInstance = UnityLoader.instantiate("gameContainer", sourceLink);
    </script>
    {{ content | safe}}
    <script>
        /* fullscreen handling */
        var fullscreenButton = document.getElementById('fullscreenButton');
        var container = document.getElementsByClassName('container');

        fullscreenButton.addEventListener('click', function () {
            if (container.requestFullscreen) {
                container.requestFullscreen();
            } else if (container.mozRequestFullScreen) {
                container.mozRequestFullScreen();
            } else if (container.webkitRequestFullscreen) {
                container.webkitRequestFullscreen();
            } else if (container.msRequestFullscreen) {
                container.msRequestFullscreen();
            }
        });
        document.addEventListener('fullscreenchange', function () {
            if (document.fullscreenElement === container) {
                container
                    .classList
                    .add('fullscreen');
            } else {
                container
                    .classList
                    .remove('fullscreen');
            }
        });
    </script>
{% endblock %}