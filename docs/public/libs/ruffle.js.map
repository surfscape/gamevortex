{"version":3,"file":"ruffle.js","mappings":"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","sources":["webpack://ruffle-selfhosted/webpack/runtime/load script","webpack://ruffle-selfhosted/webpack/bootstrap","webpack://ruffle-selfhosted/webpack/runtime/define property getters","webpack://ruffle-selfhosted/webpack/runtime/ensure chunk","webpack://ruffle-selfhosted/webpack/runtime/get javascript chunk filename","webpack://ruffle-selfhosted/webpack/runtime/global","webpack://ruffle-selfhosted/webpack/runtime/harmony module decorator","webpack://ruffle-selfhosted/webpack/runtime/hasOwnProperty shorthand","webpack://ruffle-selfhosted/webpack/runtime/make namespace object","webpack://ruffle-selfhosted/webpack/runtime/publicPath","webpack://ruffle-selfhosted/webpack/runtime/jsonp chunk loading","webpack://ruffle-selfhosted/../core/dist/version.js","webpack://ruffle-selfhosted/../core/dist/version-range.js","webpack://ruffle-selfhosted/../../node_modules/wasm-feature-detect/dist/esm/index.js","webpack://ruffle-selfhosted/../core/dist/js-polyfills.js","webpack://ruffle-selfhosted/../core/dist/public-path.js","webpack://ruffle-selfhosted/../core/dist/load-ruffle.js","webpack://ruffle-selfhosted/../core/dist/shadow-template.js","webpack://ruffle-selfhosted/../core/dist/register-element.js","webpack://ruffle-selfhosted/../core/dist/config.js","webpack://ruffle-selfhosted/../core/dist/flash-identifiers.js","webpack://ruffle-selfhosted/../core/dist/swf-utils.js","webpack://ruffle-selfhosted/../core/dist/build-info.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/types.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/resolver.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/scope.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/builtins.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/memoizer.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/bundle.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/bundle/esm/resource.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/langneg/esm/locale.js","webpack://ruffle-selfhosted/../core/dist/i18n.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/langneg/esm/negotiate_languages.js","webpack://ruffle-selfhosted/../../node_modules/@fluent/langneg/esm/matches.js","webpack://ruffle-selfhosted/../core/dist/ruffle-player.js","webpack://ruffle-selfhosted/../core/dist/ruffle-embed.js","webpack://ruffle-selfhosted/../core/dist/ruffle-object.js","webpack://ruffle-selfhosted/../core/dist/plugin-polyfill.js","webpack://ruffle-selfhosted/../core/dist/polyfills.js","webpack://ruffle-selfhosted/../core/dist/source-api.js","webpack://ruffle-selfhosted/../core/dist/public-api.js","webpack://ruffle-selfhosted/./js/ruffle.js"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"ruffle-selfhosted:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"core.ruffle.\" + {\"159\":\"273696e20790eb4f121d\",\"339\":\"1f63c5b1396ac9e10d6d\"}[chunkId] + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkruffle_selfhosted\"] = self[\"webpackChunkruffle_selfhosted\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/**\n * A representation of a semver 2 compliant version string\n */\nexport class Version {\n    /**\n     * Construct a Version from specific components.\n     *\n     * If you wish to parse a string into a Version then please use [[fromSemver]].\n     *\n     * @param major The major version component.\n     * @param minor The minor version component.\n     * @param patch The patch version component.\n     * @param prIdent A list of pre-release identifiers, if any\n     * @param buildIdent A list of build identifiers, if any\n     */\n    constructor(major, minor, patch, prIdent, \n    // @ts-expect-error: Property 'buildIdent' is declared but its value is never read.\n    buildIdent) {\n        this.major = major;\n        this.minor = minor;\n        this.patch = patch;\n        this.prIdent = prIdent;\n        this.buildIdent = buildIdent;\n    }\n    /**\n     * Construct a version from a semver 2 compliant string.\n     *\n     * This function is intended for use with semver 2 compliant strings.\n     * Malformed strings may still parse correctly, but this result is not\n     * guaranteed.\n     *\n     * @param versionString A semver 2.0.0 compliant version string\n     * @returns A version object\n     */\n    static fromSemver(versionString) {\n        const buildSplit = versionString.split(\"+\"), prSplit = buildSplit[0].split(\"-\"), versionSplit = prSplit[0].split(\".\");\n        const major = parseInt(versionSplit[0], 10);\n        let minor = 0;\n        let patch = 0;\n        let prIdent = null;\n        let buildIdent = null;\n        if (versionSplit[1] !== undefined) {\n            minor = parseInt(versionSplit[1], 10);\n        }\n        if (versionSplit[2] !== undefined) {\n            patch = parseInt(versionSplit[2], 10);\n        }\n        if (prSplit[1] !== undefined) {\n            prIdent = prSplit[1].split(\".\");\n        }\n        if (buildSplit[1] !== undefined) {\n            buildIdent = buildSplit[1].split(\".\");\n        }\n        return new Version(major, minor, patch, prIdent, buildIdent);\n    }\n    /**\n     * Returns true if a given version is compatible with this one.\n     *\n     * Compatibility is defined as having the same nonzero major version\n     * number, or if both major versions are zero, the same nonzero minor\n     * version number, or if both minor versions are zero, the same nonzero\n     * patch version number.\n     *\n     * This implements the ^ operator in npm's semver package, with the\n     * exception of the prerelease exclusion rule.\n     *\n     * @param other The other version to test against\n     * @returns True if compatible\n     */\n    isCompatibleWith(other) {\n        return ((this.major !== 0 && this.major === other.major) ||\n            (this.major === 0 &&\n                other.major === 0 &&\n                this.minor !== 0 &&\n                this.minor === other.minor) ||\n            (this.major === 0 &&\n                other.major === 0 &&\n                this.minor === 0 &&\n                other.minor === 0 &&\n                this.patch !== 0 &&\n                this.patch === other.patch));\n    }\n    /**\n     * Returns true if this version has precedence over (is newer than) another\n     * version.\n     *\n     * Precedence is defined as in the Semver 2 spec. This implements the >\n     * operator in npm's semver package, with the exception of the prerelease\n     * exclusion rule.\n     *\n     * @param other The other version to test against\n     * @returns True if this version has precedence over the other one\n     */\n    hasPrecedenceOver(other) {\n        if (this.major > other.major) {\n            return true;\n        }\n        else if (this.major < other.major) {\n            return false;\n        }\n        if (this.minor > other.minor) {\n            return true;\n        }\n        else if (this.minor < other.minor) {\n            return false;\n        }\n        if (this.patch > other.patch) {\n            return true;\n        }\n        else if (this.patch < other.patch) {\n            return false;\n        }\n        if (this.prIdent === null && other.prIdent !== null) {\n            return true;\n        }\n        else if (this.prIdent !== null && other.prIdent !== null) {\n            const isNumeric = /^[0-9]*$/;\n            for (let i = 0; i < this.prIdent.length && i < other.prIdent.length; i += 1) {\n                if (!isNumeric.test(this.prIdent[i]) &&\n                    isNumeric.test(other.prIdent[i])) {\n                    return true;\n                }\n                else if (isNumeric.test(this.prIdent[i]) &&\n                    isNumeric.test(other.prIdent[i])) {\n                    if (parseInt(this.prIdent[i], 10) >\n                        parseInt(other.prIdent[i], 10)) {\n                        return true;\n                    }\n                    else if (parseInt(this.prIdent[i], 10) <\n                        parseInt(other.prIdent[i], 10)) {\n                        return false;\n                    }\n                }\n                else if (isNumeric.test(this.prIdent[i]) &&\n                    !isNumeric.test(other.prIdent[i])) {\n                    return false;\n                }\n                else if (!isNumeric.test(this.prIdent[i]) &&\n                    !isNumeric.test(other.prIdent[i])) {\n                    if (this.prIdent[i] > other.prIdent[i]) {\n                        return true;\n                    }\n                    else if (this.prIdent[i] < other.prIdent[i]) {\n                        return false;\n                    }\n                }\n            }\n            return this.prIdent.length > other.prIdent.length;\n        }\n        return false;\n    }\n    /**\n     * Tests if a given version is equivalent to this one.\n     *\n     * Build and prerelease tags are ignored.\n     *\n     * @param other The other version to test against\n     * @returns True if the given version is equivalent\n     */\n    isEqual(other) {\n        return (this.major === other.major &&\n            this.minor === other.minor &&\n            this.patch === other.patch);\n    }\n    /**\n     * Tests if a given version is stable or a compatible prerelease for this\n     * version.\n     *\n     * This implements the prerelease exclusion rule of NPM semver: a\n     * prerelease version can only pass this check if the major/minor/patch\n     * components of both versions are the same. Otherwise, the prerelease\n     * version always fails.\n     *\n     * @param other The other version to test against\n     * @returns True if the given version is either stable, or a\n     * prerelease in the same series as this one.\n     */\n    isStableOrCompatiblePrerelease(other) {\n        if (other.prIdent === null) {\n            return true;\n        }\n        else {\n            return (this.major === other.major &&\n                this.minor === other.minor &&\n                this.patch === other.patch);\n        }\n    }\n}\n","import { Version } from \"./version\";\n/**\n * Represents a set of version requirements.\n */\nexport class VersionRange {\n    /**\n     * Constructs a range of versions as specified by the given requirements.\n     *\n     * If you wish to construct this object from a string representation,\n     * then use [[fromRequirementString]].\n     *\n     * @param requirements Requirements to set this range by\n     */\n    constructor(requirements) {\n        this.requirements = requirements;\n    }\n    /**\n     * Determine if a given version satisfies this range.\n     *\n     * @param fver A version object to test against.\n     * @returns Whether or not the given version matches this range\n     */\n    satisfiedBy(fver) {\n        for (const requirement of this.requirements) {\n            let matches = true;\n            for (const { comparator, version } of requirement) {\n                matches =\n                    matches && version.isStableOrCompatiblePrerelease(fver);\n                if (comparator === \"\" || comparator === \"=\") {\n                    matches = matches && version.isEqual(fver);\n                }\n                else if (comparator === \">\") {\n                    matches = matches && fver.hasPrecedenceOver(version);\n                }\n                else if (comparator === \">=\") {\n                    matches =\n                        matches &&\n                            (fver.hasPrecedenceOver(version) ||\n                                version.isEqual(fver));\n                }\n                else if (comparator === \"<\") {\n                    matches = matches && version.hasPrecedenceOver(fver);\n                }\n                else if (comparator === \"<=\") {\n                    matches =\n                        matches &&\n                            (version.hasPrecedenceOver(fver) ||\n                                version.isEqual(fver));\n                }\n                else if (comparator === \"^\") {\n                    matches = matches && version.isCompatibleWith(fver);\n                }\n            }\n            if (matches) {\n                return true;\n            }\n        }\n        return false;\n    }\n    /**\n     * Parse a requirement string into a version range.\n     *\n     * @param requirement The version requirements, consisting of a\n     * series of space-separated strings, each one being a semver version\n     * optionally prefixed by a comparator or a separator.\n     *\n     * Valid comparators are:\n     * - `\"\"` or `\"=\"`: Precisely this version\n     * - `\">`\": A version newer than this one\n     * - `\">`=\": A version newer or equal to this one\n     * - `\"<\"`: A version older than this one\n     * - `\"<=\"`: A version older or equal to this one\n     * - `\"^\"`: A version that is compatible with this one\n     *\n     * A separator is `\"||`\" which splits the requirement string into\n     * left OR right.\n     * @returns A version range object.\n     */\n    static fromRequirementString(requirement) {\n        const components = requirement.split(\" \");\n        let set = [];\n        const requirements = [];\n        for (const component of components) {\n            if (component === \"||\") {\n                if (set.length > 0) {\n                    requirements.push(set);\n                    set = [];\n                }\n            }\n            else if (component.length > 0) {\n                const match = /[0-9]/.exec(component);\n                if (match) {\n                    const comparator = component.slice(0, match.index).trim();\n                    const version = Version.fromSemver(component.slice(match.index).trim());\n                    set.push({ comparator, version });\n                }\n            }\n        }\n        if (set.length > 0) {\n            requirements.push(set);\n        }\n        return new VersionRange(requirements);\n    }\n}\n","export const bigInt=()=>(async e=>{try{return(await WebAssembly.instantiate(e)).instance.exports.b(BigInt(0))===BigInt(0)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,126,1,126,3,2,1,0,7,5,1,1,98,0,0,10,6,1,4,0,32,0,11])),bulkMemory=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),exceptions=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),extendedConst=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,5,3,1,0,1,11,9,1,0,65,1,65,2,106,11,0])),gc=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,10,2,95,1,125,0,96,0,1,107,0,3,2,1,1,10,12,1,10,0,67,0,0,0,0,251,7,0,11])),memory64=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,5,3,1,4,1])),multiValue=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,0,2,127,127,3,2,1,0,10,8,1,6,0,65,0,65,0,11])),mutableGlobals=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,2,8,1,1,97,1,98,3,127,1,6,6,1,127,1,65,0,11,7,5,1,1,97,3,1])),referenceTypes=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,7,1,5,0,208,112,26,11])),relaxedSimd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,15,1,13,0,65,1,253,15,65,2,253,15,253,128,2,11])),saturatedFloatToInt=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])),signExtensions=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])),simd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),streamingCompilation=()=>(async()=>\"compileStreaming\"in WebAssembly)(),tailCall=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,6,1,4,0,18,0,11])),threads=()=>(async e=>{try{return\"undefined\"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));\n","/**\n * Polyfills the `Array.prototype.reduce` method.\n *\n * Production steps of ECMA-262, Edition 5, 15.4.4.21\n * Reference: https://es5.github.io/#x15.4.4.21\n * https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n */\nfunction polyfillArrayPrototypeReduce() {\n    Object.defineProperty(Array.prototype, \"reduce\", {\n        value(...args) {\n            if (args.length === 0 &&\n                window.Prototype &&\n                window.Prototype.Version &&\n                window.Prototype.Version < \"1.6.1\") {\n                // Off-spec: compatibility with prototype.js\n                return this.length > 1 ? this : this[0];\n            }\n            const callback = args[0];\n            if (this === null) {\n                throw new TypeError(\"Array.prototype.reduce called on null or undefined\");\n            }\n            if (typeof callback !== \"function\") {\n                throw new TypeError(`${callback} is not a function`);\n            }\n            const o = Object(this);\n            const len = o.length >>> 0;\n            let k = 0;\n            let value;\n            if (args.length >= 2) {\n                value = args[1];\n            }\n            else {\n                while (k < len && !(k in o)) {\n                    k++;\n                }\n                if (k >= len) {\n                    throw new TypeError(\"Reduce of empty array with no initial value\");\n                }\n                value = o[k++];\n            }\n            while (k < len) {\n                if (k in o) {\n                    value = callback(value, o[k], k, o);\n                }\n                k++;\n            }\n            return value;\n        },\n    });\n}\n/**\n * Polyfills the `Window` function.\n */\nfunction polyfillWindow() {\n    if (typeof window.constructor !== \"function\" ||\n        !isNativeFunction(window.constructor)) {\n        // Don't polyfill `Window` if `window.constructor` has been overridden.\n        return;\n    }\n    // @ts-expect-error: `Function not assignable to { new (): Window; prototype: Window; }`\n    window.Window = window.constructor;\n}\n/**\n * Polyfills the `Reflect` object and members.\n *\n * This is a partial implementation, just enough to match our needs.\n */\nfunction tryPolyfillReflect() {\n    if (window.Reflect === undefined || window.Reflect === null) {\n        // @ts-expect-error: {} indeed doesn't implement Reflect's interface.\n        window.Reflect = {};\n    }\n    if (typeof Reflect.get !== \"function\") {\n        Object.defineProperty(Reflect, \"get\", {\n            value(target, key) {\n                return target[key];\n            },\n        });\n    }\n    if (typeof Reflect.set !== \"function\") {\n        Object.defineProperty(Reflect, \"set\", {\n            value(target, key, value) {\n                target[key] = value;\n            },\n        });\n    }\n    if (typeof Reflect.has !== \"function\") {\n        Object.defineProperty(Reflect, \"has\", {\n            value(target, key) {\n                // @ts-expect-error: Type 'T' is not assignable to type 'object'.\n                return key in target;\n            },\n        });\n    }\n    if (typeof Reflect.ownKeys !== \"function\") {\n        Object.defineProperty(Reflect, \"ownKeys\", {\n            value(target) {\n                return [\n                    ...Object.getOwnPropertyNames(target),\n                    ...Object.getOwnPropertySymbols(target),\n                ];\n            },\n        });\n    }\n}\n/**\n * Determines whether a function is native or not.\n *\n * @param func The function to test.\n * @returns True if the function hasn't been overridden.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction isNativeFunction(func) {\n    const val = typeof Function.prototype.toString === \"function\"\n        ? Function.prototype.toString()\n        : null;\n    if (typeof val === \"string\" && val.indexOf(\"[native code]\") >= 0) {\n        return (Function.prototype.toString.call(func).indexOf(\"[native code]\") >= 0);\n    }\n    return false;\n}\n/**\n * Checks and applies the polyfills to the current window, if needed.\n */\nexport function setPolyfillsOnLoad() {\n    if (typeof Array.prototype.reduce !== \"function\" ||\n        !isNativeFunction(Array.prototype.reduce)) {\n        // Some external libraries override the `Array.prototype.reduce` method in a way\n        // that causes Webpack to crash (#1507, #1865), so we need to override it again.\n        polyfillArrayPrototypeReduce();\n    }\n    if (typeof Window !== \"function\" || !isNativeFunction(Window)) {\n        // Overriding the native `Window` function causes issues in wasm-bindgen, as a\n        // code like `window instanceof Window` will no longer work.\n        polyfillWindow();\n    }\n    // Some pages override the native `Reflect` object, which causes various issues:\n    // 1- wasm-bindgen's stdlib may crash (#3173).\n    // 2- FlashVars may be ignored (#8537).\n    tryPolyfillReflect();\n}\n","// This must be in global scope because `document.currentScript`\n// works only while the script is initially being processed.\nlet currentScriptURL = \"\";\ntry {\n    if (document.currentScript !== undefined &&\n        document.currentScript !== null &&\n        \"src\" in document.currentScript &&\n        document.currentScript.src !== \"\") {\n        let src = document.currentScript.src;\n        // CDNs allow omitting the filename. If it's omitted, append a slash to\n        // prevent the last component from being dropped.\n        if (!src.endsWith(\".js\") && !src.endsWith(\"/\")) {\n            src += \"/\";\n        }\n        currentScriptURL = new URL(\".\", src).href;\n    }\n}\ncatch (e) {\n    console.warn(\"Unable to get currentScript URL\");\n}\n/**\n * Attempt to discover the public path of the current Ruffle source. This can\n * be used to configure Webpack.\n *\n * A global public path can be specified for all sources using the RufflePlayer\n * config:\n *\n * ```js\n * window.RufflePlayer.config.publicPath = \"/dist/\";\n * ```\n *\n * If no such config is specified, then the parent path of where this script is\n * hosted is assumed, which should be the correct default in most cases.\n *\n * @param config The `window.RufflePlayer.config` object.\n * @returns The public path for the given source.\n */\nexport function publicPath(config) {\n    // Default to the directory where this script resides.\n    let path = currentScriptURL;\n    if (\"publicPath\" in config &&\n        config.publicPath !== null &&\n        config.publicPath !== undefined) {\n        path = config.publicPath;\n    }\n    // Webpack expects the paths to end with a slash.\n    if (path !== \"\" && !path.endsWith(\"/\")) {\n        path += \"/\";\n    }\n    return path;\n}\n","/**\n * Conditional ruffle loader\n */\nimport { bulkMemory, simd, saturatedFloatToInt, signExtensions, referenceTypes, } from \"wasm-feature-detect\";\nimport { setPolyfillsOnLoad } from \"./js-polyfills\";\nimport { publicPath } from \"./public-path\";\n/**\n * Load ruffle from an automatically-detected location.\n *\n * This function returns a new instance of Ruffle and downloads it every time.\n * You should not use it directly; this module will memoize the resource\n * download.\n *\n * @param config The `window.RufflePlayer.config` object.\n * @param progressCallback The callback that will be run with Ruffle's download progress.\n * @returns A ruffle constructor that may be used to create new Ruffle\n * instances.\n */\nasync function fetchRuffle(config, progressCallback) {\n    // Apply some pure JavaScript polyfills to prevent conflicts with external\n    // libraries, if needed.\n    setPolyfillsOnLoad();\n    // NOTE: Keep this list in sync with $RUSTFLAGS in the CI build config!\n    const extensionsSupported = (await Promise.all([\n        bulkMemory(),\n        simd(),\n        saturatedFloatToInt(),\n        signExtensions(),\n        referenceTypes(),\n    ])).every(Boolean);\n    if (!extensionsSupported) {\n        console.log(\"Some WebAssembly extensions are NOT available, falling back to the vanilla WebAssembly module\");\n    }\n    __webpack_public_path__ = publicPath(config);\n    // Note: The argument passed to import() has to be a simple string literal,\n    // otherwise some bundler will get confused and won't include the module?\n    const { default: init, Ruffle } = await (extensionsSupported\n        ? import(\"../dist/ruffle_web-wasm_extensions\")\n        : import(\"../dist/ruffle_web\"));\n    let response;\n    const wasmUrl = extensionsSupported\n        ? new URL(\"../dist/ruffle_web-wasm_extensions_bg.wasm\", import.meta.url)\n        : new URL(\"../dist/ruffle_web_bg.wasm\", import.meta.url);\n    const wasmResponse = await fetch(wasmUrl);\n    if (progressCallback) {\n        const contentLength = wasmResponse.headers.get(\"content-length\") || \"\";\n        let bytesLoaded = 0;\n        // Use parseInt rather than Number so the empty string is coerced to NaN instead of 0\n        const bytesTotal = parseInt(contentLength);\n        response = new Response(new ReadableStream({\n            async start(controller) {\n                var _a;\n                const reader = (_a = wasmResponse.body) === null || _a === void 0 ? void 0 : _a.getReader();\n                if (!reader) {\n                    throw \"Response had no body\";\n                }\n                progressCallback(bytesLoaded, bytesTotal);\n                for (;;) {\n                    const { done, value } = await reader.read();\n                    if (done) {\n                        break;\n                    }\n                    if (value === null || value === void 0 ? void 0 : value.byteLength) {\n                        bytesLoaded += value === null || value === void 0 ? void 0 : value.byteLength;\n                    }\n                    controller.enqueue(value);\n                    progressCallback(bytesLoaded, bytesTotal);\n                }\n                controller.close();\n            },\n        }), wasmResponse);\n    }\n    else {\n        response = wasmResponse;\n    }\n    await init(response);\n    return Ruffle;\n}\nlet lastLoaded = null;\n/**\n * Obtain an instance of `Ruffle`.\n *\n * This function returns a promise which yields `Ruffle` asynchronously.\n *\n * @param config The `window.RufflePlayer.config` object.\n * @param progressCallback The callback that will be run with Ruffle's download progress.\n * @returns A ruffle constructor that may be used to create new Ruffle\n * instances.\n */\nexport function loadRuffle(config, progressCallback) {\n    if (lastLoaded === null) {\n        lastLoaded = fetchRuffle(config, progressCallback);\n    }\n    return lastLoaded;\n}\n","/**\n * The shadow template which is used to fill the actual Ruffle player element\n * on the page.\n */\nexport const ruffleShadowTemplate = document.createElement(\"template\");\nruffleShadowTemplate.innerHTML = `\n    <style>\n        :host {\n            all: initial;\n\n            --ruffle-blue: #37528c;\n            --ruffle-orange: #ffad33;\n\n            display: inline-block;\n            position: relative;\n            /* Default width/height; this will get overridden by user styles/attributes. */\n            width: 550px;\n            height: 400px;\n            font-family: Arial, sans-serif;\n            letter-spacing: 0.4px;\n            touch-action: none;\n            user-select: none;\n            -webkit-user-select: none;\n            -webkit-tap-highlight-color: transparent;\n        }\n\n        /* Ruffle's width/height CSS interferes with Safari's fullscreen CSS. */\n        /* Ensure that Safari's fullscreen mode actually fills the screen. */\n        :host(:-webkit-full-screen) {\n            display: block;\n            width: 100% !important;\n            height: 100% !important;\n        }\n\n        .hidden {\n            display: none !important;\n        }\n\n        /* All of these use the dimensions specified by the embed. */\n        #container,\n        #play_button,\n        #unmute_overlay,\n        #unmute_overlay .background,\n        #panic,\n        #splash-screen,\n        #message_overlay {\n            position: absolute;\n            top: 0;\n            bottom: 0;\n            left: 0;\n            right: 0;\n        }\n\n        #container {\n            overflow: hidden;\n        }\n\n        #container canvas {\n            width: 100%;\n            height: 100%;\n        }\n\n        #play_button,\n        #unmute_overlay {\n            cursor: pointer;\n            display: none;\n        }\n\n        #unmute_overlay .background {\n            background: black;\n            opacity: 0.7;\n        }\n\n        #play_button .icon,\n        #unmute_overlay .icon {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            width: 50%;\n            height: 50%;\n            max-width: 384px;\n            max-height: 384px;\n            transform: translate(-50%, -50%);\n            opacity: 0.8;\n        }\n\n        #play_button:hover .icon,\n        #unmute_overlay:hover .icon {\n            opacity: 1;\n        }\n\n        #panic {\n            font-size: 20px;\n            text-align: center;\n            /* Inverted colors from play button! */\n            background: linear-gradient(180deg, #fd3a40 0%, #fda138 100%);\n            color: white;\n            display: flex;\n            flex-flow: column;\n            justify-content: space-around;\n        }\n\n        #panic a {\n            color: var(--ruffle-blue);\n            font-weight: bold;\n        }\n\n        #panic-title {\n            font-size: xxx-large;\n            font-weight: bold;\n        }\n\n        #panic-body.details {\n            flex: 0.9;\n            margin: 0 10px;\n        }\n\n        #panic-body textarea {\n            width: 100%;\n            height: 100%;\n            resize: none;\n        }\n\n        #panic ul {\n            padding: 0;\n            display: flex;\n            list-style-type: none;\n            justify-content: space-evenly;\n        }\n\n        #message_overlay {\n            position: absolute;\n            background: var(--ruffle-blue);\n            color: var(--ruffle-orange);\n            opacity: 1;\n            z-index: 2;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            overflow: auto;\n        }\n\n        #message_overlay .message {\n            text-align: center;\n            max-height: 100%;\n            max-width: 100%;\n            padding: 5%;\n            font-size: 20px;\n        }\n\n        #message_overlay p {\n            margin: 0.5em 0;\n        }\n\n        #message_overlay .message div {\n            display: flex;\n            justify-content: center;\n            flex-wrap: wrap;\n            column-gap: 1em;\n        }\n\n        #message_overlay a, #message_overlay button {\n            cursor: pointer;\n            background: var(--ruffle-blue);\n            color: var(--ruffle-orange);\n            border: 2px solid var(--ruffle-orange);\n            font-weight: bold;\n            font-size: 1.25em;\n            border-radius: 0.6em;\n            padding: 10px;\n            text-decoration: none;\n            margin: 2% 0;\n        }\n\n        #message_overlay a:hover, #message_overlay button:hover {\n            background: #ffffff4c;\n        }\n\n        #continue-btn {\n             cursor: pointer;\n             background: var(--ruffle-blue);\n             color: var(--ruffle-orange);\n             border: 2px solid var(--ruffle-orange);\n             font-weight: bold;\n             font-size: 20px;\n             border-radius: 20px;\n             padding: 10px;\n        }\n\n        #continue-btn:hover {\n            background: #ffffff4c;\n        }\n\n        #context-menu {\n            display: none;\n            color: black;\n            background: #fafafa;\n            border: 1px solid gray;\n            box-shadow: 0px 5px 10px -5px black;\n            position: absolute;\n            font-size: 14px;\n            text-align: left;\n            list-style: none;\n            padding: 0;\n            margin: 0;\n        }\n\n        #context-menu .menu_item {\n            padding: 5px 10px;\n            cursor: pointer;\n            color: black;\n        }\n\n        #context-menu .menu_item.disabled {\n            cursor: default;\n            color: gray;\n        }\n\n        #context-menu .menu_item:not(.disabled):hover {\n            background: lightgray;\n        }\n\n        #context-menu .menu_separator hr {\n            border: none;\n            border-bottom: 1px solid lightgray;\n            margin: 2px;\n        }\n\n        #splash-screen {\n            display: flex;\n            flex-direction: column;\n            background: var(--splash-screen-background, var(--preloader-background, var(--ruffle-blue)));\n            align-items: center;\n            justify-content: center;\n        }\n\n        .loadbar {\n            width: 100%;\n            max-width: 316px;\n            max-height: 10px;\n            height: 20%;\n            background: #253559;\n        }\n\n        .loadbar-inner {\n            width: 0px;\n            max-width: 100%;\n            height: 100%;\n            background: var(--ruffle-orange);\n        }\n            \n        .logo {\n            display: var(--logo-display, block);\n            max-width: 380px;\n            max-height: 150px;\n        }\n\n        .loading-animation {\n            max-width: 28px;\n            max-height: 28px;\n            margin-bottom: 2%;\n            width: 10%;\n            aspect-ratio: 1;\n        }\n\n        .spinner {\n            stroke-dasharray: 180;\n            stroke-dashoffset: 135;\n            stroke: var(--ruffle-orange);\n            transform-origin: 50% 50%;\n            animation: rotate 1.5s linear infinite;\n        }\n\n        @keyframes rotate {\n            to {\n                transform: rotate(360deg);\n            }\n        }\n\n        #virtual-keyboard {\n            position: absolute;\n            opacity: 0;\n            top: -100px;\n            width: 1px;\n            height: 1px;\n        }\n\n        #save-manager {\n            height: inherit;\n            user-select: text;\n        }\n        #modal-area {\n            position: sticky;\n            background: white;\n            width: fit-content;\n            padding: 16px;\n            border: 3px solid black;\n            margin: auto;\n            height: 500px;\n            max-height: calc(100% - 38px);\n            min-height: 80px;\n        }\n\n        #restore-save {\n            display: none;\n        }\n\n        .replace-save {\n            display: none;\n        }\n\n        .save-option {\n            display: inline-block;\n            padding: 3px 10px;\n            margin: 5px 2px;\n            cursor: pointer;\n            border-radius: 50px;\n            background-color: var(--ruffle-blue);\n            color: white;\n        }\n\n        #close-modal {\n            position: absolute;\n            top: 5px;\n            right: 10px;\n            cursor: pointer;\n            font-size: x-large;\n        }\n\n        .general-save-options {\n            text-align: center;\n            padding-bottom: 8px;\n            border-bottom: 2px solid #888;\n        }\n\n        #local-saves {\n            border-collapse: collapse;\n            overflow-y: auto;\n            display: block;\n            padding-right: 16px;\n            height: calc(100% - 45px);\n            min-height: 30px;\n        }\n\n        #local-saves td {\n            border-bottom: 1px solid #bbb;\n            height: 30px;\n        }\n\n        #local-saves tr td:nth-child(1) {\n            padding-right: 1em;\n            word-break: break-all;\n        }\n\n        #local-saves tr:nth-child(even) {\n            background-color: #f2f2f2;\n        }\n    </style>\n    <style id=\"dynamic_styles\"></style>\n\n    <div id=\"container\">\n        <div id=\"play_button\"><div class=\"icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMidYMid\" viewBox=\"0 0 250 250\" width=\"100%\" height=\"100%\"><defs><linearGradient id=\"a\" gradientUnits=\"userSpaceOnUse\" x1=\"125\" y1=\"0\" x2=\"125\" y2=\"250\" spreadMethod=\"pad\"><stop offset=\"0%\" stop-color=\"#FDA138\"/><stop offset=\"100%\" stop-color=\"#FD3A40\"/></linearGradient><g id=\"b\"><path fill=\"url(#a)\" d=\"M250 125q0-52-37-88-36-37-88-37T37 37Q0 73 0 125t37 88q36 37 88 37t88-37q37-36 37-88M87 195V55l100 70-100 70z\"/><path fill=\"#FFF\" d=\"M87 55v140l100-70L87 55z\"/></g></defs><use xlink:href=\"#b\"/></svg></div></div>\n        <div id=\"unmute_overlay\"><div class=\"background\"></div><div class=\"icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMidYMid\" viewBox=\"0 0 512 584\"  width=\"100%\" height=\"100%\" scale=\"0.8\" id=\"unmute_overlay_svg\"><path fill=\"#FFF\" stroke=\"#FFF\" d=\"m457.941 256 47.029-47.029c9.372-9.373 9.372-24.568 0-33.941-9.373-9.373-24.568-9.373-33.941 0l-47.029 47.029-47.029-47.029c-9.373-9.373-24.568-9.373-33.941 0-9.372 9.373-9.372 24.568 0 33.941l47.029 47.029-47.029 47.029c-9.372 9.373-9.372 24.568 0 33.941 4.686 4.687 10.827 7.03 16.97 7.03s12.284-2.343 16.971-7.029l47.029-47.03 47.029 47.029c4.687 4.687 10.828 7.03 16.971 7.03s12.284-2.343 16.971-7.029c9.372-9.373 9.372-24.568 0-33.941z\"/><path fill=\"#FFF\" stroke=\"#FFF\" d=\"m99 160h-55c-24.301 0-44 19.699-44 44v104c0 24.301 19.699 44 44 44h55c2.761 0 5-2.239 5-5v-182c0-2.761-2.239-5-5-5z\"/><path fill=\"#FFF\" stroke=\"#FFF\" d=\"m280 56h-24c-5.269 0-10.392 1.734-14.578 4.935l-103.459 79.116c-1.237.946-1.963 2.414-1.963 3.972v223.955c0 1.557.726 3.026 1.963 3.972l103.459 79.115c4.186 3.201 9.309 4.936 14.579 4.936h23.999c13.255 0 24-10.745 24-24v-352.001c0-13.255-10.745-24-24-24z\"/><text x=\"256\" y=\"560\" text-anchor=\"middle\" font-size=\"60px\" fill=\"#FFF\" stroke=\"#FFF\" id=\"unmute_text\"></text></svg></div></div>\n        <input id=\"virtual-keyboard\" type=\"text\" autocapitalize=\"off\" autocomplete=\"off\" autocorrect=\"off\">\n    </div>\n    <div class=\"hidden\" id=\"splash-screen\">\n        <svg class=\"logo\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMidYMid\" viewBox=\"0 0 380 150\"><g><path fill=\"#966214\" d=\"M58.75 85.6q.75-.1 1.5-.35.85-.25 1.65-.75.55-.35 1.05-.8.5-.45.95-1 .5-.5.75-1.2-.05.05-.15.1-.1.15-.25.25l-.1.2q-.15.05-.25.1-.4 0-.8.05-.5-.25-.9-.5-.3-.1-.55-.3l-.6-.6-4.25-6.45-1.5 11.25h3.45m83.15-.2h3.45q.75-.1 1.5-.35.25-.05.45-.15.35-.15.65-.3l.5-.3q.25-.15.5-.35.45-.35.9-.75.45-.35.75-.85l.1-.1q.1-.2.2-.35.2-.3.35-.6l-.3.4-.15.15q-.5.15-1.1.1-.25 0-.4-.05-.5-.15-.8-.4-.15-.1-.25-.25-.3-.3-.55-.6l-.05-.05v-.05l-4.25-6.4-1.5 11.25m-21.15-3.95q-.3-.3-.55-.6l-.05-.05v-.05l-4.25-6.4-1.5 11.25h3.45q.75-.1 1.5-.35.85-.25 1.6-.75.75-.5 1.4-1.1.45-.35.75-.85.35-.5.65-1.05l-.45.55q-.5.15-1.1.1-.9 0-1.45-.7m59.15.3q-.75-.5-1.4-1-3.15-2.55-3.5-6.4l-1.5 11.25h21q-3.1-.25-5.7-.75-5.6-1.05-8.9-3.1m94.2 3.85h3.45q.6-.1 1.2-.3.4-.1.75-.2.35-.15.65-.3.7-.35 1.35-.8.75-.55 1.3-1.25.1-.15.25-.3-2.55-.25-3.25-1.8l-4.2-6.3-1.5 11.25m-45.3-4.85q-.5-.4-.9-.8-2.3-2.35-2.6-5.6l-1.5 11.25h21q-11.25-.95-16-4.85m97.7 4.85q-.3-.05-.6-.05-10.8-1-15.4-4.8-3.15-2.55-3.5-6.35l-1.5 11.2h21Z\"/><path fill=\"var(--ruffle-orange)\" d=\"M92.6 54.8q-1.95-1.4-4.5-1.4H60.35q-1.35 0-2.6.45-1.65.55-3.15 1.8-2.75 2.25-3.25 5.25l-1.65 12h.05v.3l5.85 1.15h-9.5q-.5.05-1 .15-.5.15-1 .35-.5.2-.95.45-.5.3-.95.7-.45.35-.85.8-.35.4-.65.85-.3.45-.5.9-.15.45-.3.95l-5.85 41.6H50.3l5-35.5 1.5-11.25 4.25 6.45.6.6q.25.2.55.3.4.25.9.5.4-.05.8-.05.1-.05.25-.1l.1-.2q.15-.1.25-.25.1-.05.15-.1l.3-1.05 1.75-12.3h11.15L75.8 82.6h16.5l2.3-16.25h-.05l.8-5.7q.4-2.45-1-4.2-.35-.4-.75-.8-.25-.25-.55-.5-.2-.2-.45-.35m16.2 18.1h.05l-.05.3 5.85 1.15H105.2q-.5.05-1 .15-.5.15-1 .35-.5.2-.95.45-.5.3-1 .65-.4.4-.8.85-.25.3-.55.65-.05.1-.15.2-.25.45-.4.9-.2.45-.3.95-.1.65-.2 1.25-.2 1.15-.4 2.25l-4.3 30.6q-.25 3 1.75 5.25 1.6 1.8 4 2.15.6.1 1.25.1h27.35q3.25 0 6-2.25.35-.35.7-.55l.3-.2q2-2 2.25-4.5l1.65-11.6q.05-.05.1-.05l1.65-11.35h.05l.7-5.2 1.5-11.25 4.25 6.4v.05l.05.05q.25.3.55.6.1.15.25.25.3.25.8.4.15.05.4.05.6.05 1.1-.1l.15-.15.3-.4.3-1.05 1.3-9.05h-.05l.7-5.05h-.05l.15-1.25h-.05l1.65-11.7h-16.25l-2.65 19.5h.05v.2l-.05.1h.05l5.8 1.15H132.7q-.5.05-1 .15-.5.15-1 .35-.15.05-.3.15-.3.1-.55.25-.05 0-.1.05-.5.3-1 .65-.4.35-.7.7-.55.7-.95 1.45-.35.65-.55 1.4-.15.7-.25 1.4v.05q-.15 1.05-.35 2.05l-1.2 8.75v.1l-2.1 14.7H111.4l2.25-15.55h.05l.7-5.2 1.5-11.25 4.25 6.4v.05l.05.05q.25.3.55.6.55.7 1.45.7.6.05 1.1-.1l.45-.55.3-1.05 1.3-9.05h-.05l.7-5.05h-.05l.15-1.25h-.05l1.65-11.7h-16.25l-2.65 19.5m106.5-41.75q-2.25-2.25-5.5-2.25h-27.75q-3 0-5.75 2.25-1.3.95-2.05 2.1-.45.6-.7 1.2-.2.5-.35 1-.1.45-.15.95l-4.15 29.95h-.05l-.7 5.2h-.05l-.2 1.35h.05l-.05.3 5.85 1.15h-9.45q-2.1.05-3.95 1.6-1.9 1.55-2.25 3.55l-.5 3.5h-.05l-5.3 38.1h16.25l5-35.5 1.5-11.25q.35 3.85 3.5 6.4.65.5 1.4 1 3.3 2.05 8.9 3.1 2.6.5 5.7.75l1.75-11.25h-12.2l.4-2.95h-.05l.7-5.05h-.05q.1-.9.3-1.9.1-.75.2-1.6.85-5.9 2.15-14.9 0-.15.05-.25l.1-.9q.2-1.55.45-3.15h11.25l-3.1 20.8h16.5l4.1-28.05q.15-1.7-.4-3.15-.5-1.1-1.35-2.1m46.65 44.15q-.5.3-1 .65-.4.4-.8.85-.35.4-.7.85-.25.45-.45.9-.15.45-.3.95l-5.85 41.6h16.25l5-35.5 1.5-11.25 4.2 6.3q.7 1.55 3.25 1.8l.05-.1q.25-.4.35-.85l.3-1.05 1.8-14.05v-.05l5.35-37.45h-16.25l-6.15 44.3 5.85 1.15h-9.45q-.5.05-1 .15-.5.15-1 .35-.5.2-.95.45m5.4-38.9q.15-1.7-.4-3.15-.5-1.1-1.35-2.1-2.25-2.25-5.5-2.25h-27.75q-2.3 0-4.45 1.35-.65.35-1.3.9-1.3.95-2.05 2.1-.45.6-.7 1.2-.4.9-.5 1.95l-4.15 29.95h-.05l-.7 5.2h-.05l-.2 1.35h.05l-.05.3 5.85 1.15h-9.45q-2.1.05-3.95 1.6-1.9 1.55-2.25 3.55l-.5 3.5h-.05l-1.2 8.75v.1l-4.1 29.25h16.25l5-35.5 1.5-11.25q.3 3.25 2.6 5.6.4.4.9.8 4.75 3.9 16 4.85l1.75-11.25h-12.2l.4-2.95h-.05l.7-5.05h-.05q.15-.9.3-1.9.1-.75.25-1.6.15-1.25.35-2.65v-.05q.95-6.7 2.35-16.5h11.25l-3.1 20.8h16.5l4.1-28.05M345 66.35h-.05l1.15-8.2q.5-3-1.75-5.25-1.25-1.25-3-1.75-1-.5-2.25-.5h-27.95q-.65 0-1.3.1-2.5.35-4.7 2.15-2.75 2.25-3.25 5.25l-1.95 14.7v.05l-.05.3 5.85 1.15h-9.45q-1.9.05-3.6 1.35-.2.1-.35.25-1.9 1.55-2.25 3.55l-4.85 34.1q-.25 3 1.75 5.25 1.25 1.4 3 1.95 1.05.3 2.25.3H320q3.25 0 6-2.25 2.75-2 3.25-5l2.75-18.5h-16.5l-1.75 11H302.5l2.1-14.75h.05l.85-6 1.5-11.2q.35 3.8 3.5 6.35 4.6 3.8 15.4 4.8.3 0 .6.05h15.75L345 66.35m-16.4-.95-1.25 8.95h-11.3l.4-2.95h-.05l.7-5.05h-.1l.15-.95h11.45Z\"/></g></svg>\n        <svg class=\"loading-animation\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 66 66\">\n            <circle class=\"spinner\" fill=\"none\" stroke-width=\"6\" stroke-linecap=\"round\" cx=\"33\" cy=\"33\" r=\"30\"></circle>\n        </svg>        \n        <div class=\"loadbar\"><div class=\"loadbar-inner\"></div></div>\n    </div>\n\n    <div id=\"save-manager\" class=\"hidden\">\n        <div id=\"modal-area\">\n            <span id=\"close-modal\">&times;</span>\n            <div class=\"general-save-options\">\n                <span class=\"save-option\" id=\"backup-saves\"></span>\n            </div>\n            <table id=\"local-saves\"></table>\n        </div>\n    </div>\n    <ul id=\"context-menu\"></ul>\n`;\n","/**\n * Number of times to try defining a custom element.\n */\nconst MAX_TRIES = 999;\n/**\n * A mapping between internal element IDs and DOM element IDs.\n */\nconst privateRegistry = {};\n/**\n * Lookup a previously registered custom element.\n *\n * The returned object will have `name`, `class`, and `internal_name`\n * properties listing the external name, implementing class, and internal name\n * respectively.\n *\n * @param elementName The internal element name, previously used to\n * register the element with the private registry.\n * @returns The element data in the registry, or null if there is\n * no such element name registered.\n */\nexport function lookupElement(elementName) {\n    const data = privateRegistry[elementName];\n    if (data !== undefined) {\n        return {\n            internalName: elementName,\n            name: data.name,\n            class: data.class,\n        };\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Register a custom element.\n *\n * This function is designed to be tolerant of naming conflicts. If\n * registration fails, we modify the name, and try again. As a result, this\n * function returns the real element name to use.\n *\n * Calling this function multiple times will *not* register multiple elements.\n * We store a private registry mapping internal element names to DOM names.\n * Thus, the proper way to use this function is to call it every time you are\n * about to work with custom element names.\n *\n * @param elementName The internal name of the element.\n * @param elementClass The class of the element.\n *\n * You must call this function with the same class every time.\n * @returns The actual element name.\n * @throws Throws an error if two different elements were registered with the\n * same internal name.\n */\nexport function registerElement(elementName, elementClass) {\n    const registration = privateRegistry[elementName];\n    if (registration !== undefined) {\n        if (registration.class !== elementClass) {\n            throw new Error(\"Internal naming conflict on \" + elementName);\n        }\n        else {\n            return registration.name;\n        }\n    }\n    let tries = 0;\n    if (window.customElements !== undefined) {\n        while (tries < MAX_TRIES) {\n            let externalName = elementName;\n            if (tries > 0) {\n                externalName = externalName + \"-\" + tries;\n            }\n            if (window.customElements.get(externalName) !== undefined) {\n                tries += 1;\n                continue;\n            }\n            else {\n                window.customElements.define(externalName, elementClass);\n            }\n            privateRegistry[elementName] = {\n                class: elementClass,\n                name: externalName,\n                internalName: elementName,\n            };\n            return externalName;\n        }\n    }\n    throw new Error(\"Failed to assign custom element \" + elementName);\n}\n","export const DEFAULT_CONFIG = {\n    allowScriptAccess: false,\n    parameters: {},\n    autoplay: \"auto\" /* AutoPlay.Auto */,\n    backgroundColor: null,\n    letterbox: \"fullscreen\" /* Letterbox.Fullscreen */,\n    unmuteOverlay: \"visible\" /* UnmuteOverlay.Visible */,\n    upgradeToHttps: true,\n    compatibilityRules: true,\n    warnOnUnsupportedContent: true,\n    logLevel: \"error\" /* LogLevel.Error */,\n    showSwfDownload: false,\n    contextMenu: \"on\" /* ContextMenu.On */,\n    // Backwards-compatibility option\n    preloader: true,\n    splashScreen: true,\n    maxExecutionDuration: 15,\n    base: null,\n    menu: true,\n    salign: \"\",\n    quality: \"high\",\n    scale: \"showAll\",\n    forceScale: false,\n    frameRate: null,\n    wmode: \"opaque\" /* WindowMode.Opaque */,\n    publicPath: null,\n    polyfills: true,\n    playerVersion: null,\n    preferredRenderer: null,\n    openUrlMode: \"allow\" /* OpenURLMode.Allow */,\n    allowNetworking: \"all\" /* NetworkingAccessMode.All */,\n};\n","export const FLASH_MIMETYPE = \"application/x-shockwave-flash\";\nexport const FUTURESPLASH_MIMETYPE = \"application/futuresplash\";\nexport const FLASH7_AND_8_MIMETYPE = \"application/x-shockwave-flash2-preview\";\nexport const FLASH_MOVIE_MIMETYPE = \"application/vnd.adobe.flash.movie\";\nexport const FLASH_ACTIVEX_CLASSID = \"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\";\n","import { FLASH_MIMETYPE, FUTURESPLASH_MIMETYPE, FLASH7_AND_8_MIMETYPE, FLASH_MOVIE_MIMETYPE, } from \"./flash-identifiers\";\n/**\n * Returns whether the given filename ends in a known flash extension.\n *\n * @param filename The filename to test.\n * @returns True if the filename is a flash movie (swf or spl).\n */\nexport function isSwfFilename(filename) {\n    if (filename) {\n        let pathname = \"\";\n        try {\n            // A base URL is required if `filename` is a relative URL, but we don't need to detect the real URL origin.\n            pathname = new URL(filename, \"https://example.com\").pathname;\n        }\n        catch (err) {\n            // Some invalid filenames, like `///`, could raise a TypeError. Let's fail silently in this situation.\n        }\n        if (pathname && pathname.length >= 4) {\n            const extension = pathname.slice(-4).toLowerCase();\n            if (extension === \".swf\" || extension === \".spl\") {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Returns whether the given MIME type is a known flash type.\n *\n * @param mimeType The MIME type to test.\n * @returns True if the MIME type is a flash MIME type.\n */\nexport function isSwfMimeType(mimeType) {\n    switch (mimeType.toLowerCase()) {\n        case FLASH_MIMETYPE.toLowerCase():\n        case FUTURESPLASH_MIMETYPE.toLowerCase():\n        case FLASH7_AND_8_MIMETYPE.toLowerCase():\n        case FLASH_MOVIE_MIMETYPE.toLowerCase():\n            return true;\n        default:\n            return false;\n    }\n}\n/**\n * Create a filename to save a downloaded SWF into.\n *\n * @param swfUrl The URL of the SWF file.\n * @returns The filename the SWF file can be saved at.\n */\nexport function swfFileName(swfUrl) {\n    const pathName = swfUrl.pathname;\n    const name = pathName.substring(pathName.lastIndexOf(\"/\") + 1);\n    return name;\n}\n","/**\n * Stores build information. The string literals are replaces at compile time by `set_version.js`.\n */\nexport const buildInfo = {\n    versionNumber: \"0.1.0\",\n    versionName: \"nightly 2023-05-10\",\n    versionChannel: \"nightly\",\n    buildDate: \"2023-05-10T00:20:16.287Z\",\n    commitHash: \"fc96fdf1ccdfcc4382090a451716f34a426d70fb\",\n};\n","/**\n * The `FluentType` class is the base of Fluent's type system.\n *\n * Fluent types wrap JavaScript values and store additional configuration for\n * them, which can then be used in the `toString` method together with a proper\n * `Intl` formatter.\n */\nexport class FluentType {\n    /**\n     * Create a `FluentType` instance.\n     *\n     * @param value The JavaScript value to wrap.\n     */\n    constructor(value) {\n        this.value = value;\n    }\n    /**\n     * Unwrap the raw value stored by this `FluentType`.\n     */\n    valueOf() {\n        return this.value;\n    }\n}\n/**\n * A `FluentType` representing no correct value.\n */\nexport class FluentNone extends FluentType {\n    /**\n     * Create an instance of `FluentNone` with an optional fallback value.\n     * @param value The fallback value of this `FluentNone`.\n     */\n    constructor(value = \"???\") {\n        super(value);\n    }\n    /**\n     * Format this `FluentNone` to the fallback string.\n     */\n    toString(scope) {\n        return `{${this.value}}`;\n    }\n}\n/**\n * A `FluentType` representing a number.\n *\n * A `FluentNumber` instance stores the number value of the number it\n * represents. It may also store an option bag of options which will be passed\n * to `Intl.NumerFormat` when the `FluentNumber` is formatted to a string.\n */\nexport class FluentNumber extends FluentType {\n    /**\n     * Create an instance of `FluentNumber` with options to the\n     * `Intl.NumberFormat` constructor.\n     *\n     * @param value The number value of this `FluentNumber`.\n     * @param opts Options which will be passed to `Intl.NumberFormat`.\n     */\n    constructor(value, opts = {}) {\n        super(value);\n        this.opts = opts;\n    }\n    /**\n     * Format this `FluentNumber` to a string.\n     */\n    toString(scope) {\n        try {\n            const nf = scope.memoizeIntlObject(Intl.NumberFormat, this.opts);\n            return nf.format(this.value);\n        }\n        catch (err) {\n            scope.reportError(err);\n            return this.value.toString(10);\n        }\n    }\n}\n/**\n * A `FluentType` representing a date and time.\n *\n * A `FluentDateTime` instance stores the number value of the date it\n * represents, as a numerical timestamp in milliseconds. It may also store an\n * option bag of options which will be passed to `Intl.DateTimeFormat` when the\n * `FluentDateTime` is formatted to a string.\n */\nexport class FluentDateTime extends FluentType {\n    /**\n     * Create an instance of `FluentDateTime` with options to the\n     * `Intl.DateTimeFormat` constructor.\n     *\n     * @param value The number value of this `FluentDateTime`, in milliseconds.\n     * @param opts Options which will be passed to `Intl.DateTimeFormat`.\n     */\n    constructor(value, opts = {}) {\n        super(value);\n        this.opts = opts;\n    }\n    /**\n     * Format this `FluentDateTime` to a string.\n     */\n    toString(scope) {\n        try {\n            const dtf = scope.memoizeIntlObject(Intl.DateTimeFormat, this.opts);\n            return dtf.format(this.value);\n        }\n        catch (err) {\n            scope.reportError(err);\n            return new Date(this.value).toISOString();\n        }\n    }\n}\n","/* global Intl */\n/**\n * @overview\n *\n * The role of the Fluent resolver is to format a `Pattern` to an instance of\n * `FluentValue`. For performance reasons, primitive strings are considered\n * such instances, too.\n *\n * Translations can contain references to other messages or variables,\n * conditional logic in form of select expressions, traits which describe their\n * grammatical features, and can use Fluent builtins which make use of the\n * `Intl` formatters to format numbers and dates into the bundle's languages.\n * See the documentation of the Fluent syntax for more information.\n *\n * In case of errors the resolver will try to salvage as much of the\n * translation as possible. In rare situations where the resolver didn't know\n * how to recover from an error it will return an instance of `FluentNone`.\n *\n * All expressions resolve to an instance of `FluentValue`. The caller should\n * use the `toString` method to convert the instance to a native value.\n *\n * Functions in this file pass around an instance of the `Scope` class, which\n * stores the data required for successful resolution and error recovery.\n */\nimport { FluentType, FluentNone, FluentNumber, FluentDateTime, } from \"./types.js\";\n/**\n * The maximum number of placeables which can be expanded in a single call to\n * `formatPattern`. The limit protects against the Billion Laughs and Quadratic\n * Blowup attacks. See https://msdn.microsoft.com/en-us/magazine/ee335713.aspx.\n */\nconst MAX_PLACEABLES = 100;\n/** Unicode bidi isolation characters. */\nconst FSI = \"\\u2068\";\nconst PDI = \"\\u2069\";\n/** Helper: match a variant key to the given selector. */\nfunction match(scope, selector, key) {\n    if (key === selector) {\n        // Both are strings.\n        return true;\n    }\n    // XXX Consider comparing options too, e.g. minimumFractionDigits.\n    if (key instanceof FluentNumber &&\n        selector instanceof FluentNumber &&\n        key.value === selector.value) {\n        return true;\n    }\n    if (selector instanceof FluentNumber && typeof key === \"string\") {\n        let category = scope\n            .memoizeIntlObject(Intl.PluralRules, selector.opts)\n            .select(selector.value);\n        if (key === category) {\n            return true;\n        }\n    }\n    return false;\n}\n/** Helper: resolve the default variant from a list of variants. */\nfunction getDefault(scope, variants, star) {\n    if (variants[star]) {\n        return resolvePattern(scope, variants[star].value);\n    }\n    scope.reportError(new RangeError(\"No default\"));\n    return new FluentNone();\n}\n/** Helper: resolve arguments to a call expression. */\nfunction getArguments(scope, args) {\n    const positional = [];\n    const named = Object.create(null);\n    for (const arg of args) {\n        if (arg.type === \"narg\") {\n            named[arg.name] = resolveExpression(scope, arg.value);\n        }\n        else {\n            positional.push(resolveExpression(scope, arg));\n        }\n    }\n    return { positional, named };\n}\n/** Resolve an expression to a Fluent type. */\nfunction resolveExpression(scope, expr) {\n    switch (expr.type) {\n        case \"str\":\n            return expr.value;\n        case \"num\":\n            return new FluentNumber(expr.value, {\n                minimumFractionDigits: expr.precision,\n            });\n        case \"var\":\n            return resolveVariableReference(scope, expr);\n        case \"mesg\":\n            return resolveMessageReference(scope, expr);\n        case \"term\":\n            return resolveTermReference(scope, expr);\n        case \"func\":\n            return resolveFunctionReference(scope, expr);\n        case \"select\":\n            return resolveSelectExpression(scope, expr);\n        default:\n            return new FluentNone();\n    }\n}\n/** Resolve a reference to a variable. */\nfunction resolveVariableReference(scope, { name }) {\n    let arg;\n    if (scope.params) {\n        // We're inside a TermReference. It's OK to reference undefined parameters.\n        if (Object.prototype.hasOwnProperty.call(scope.params, name)) {\n            arg = scope.params[name];\n        }\n        else {\n            return new FluentNone(`$${name}`);\n        }\n    }\n    else if (scope.args &&\n        Object.prototype.hasOwnProperty.call(scope.args, name)) {\n        // We're in the top-level Pattern or inside a MessageReference. Missing\n        // variables references produce ReferenceErrors.\n        arg = scope.args[name];\n    }\n    else {\n        scope.reportError(new ReferenceError(`Unknown variable: $${name}`));\n        return new FluentNone(`$${name}`);\n    }\n    // Return early if the argument already is an instance of FluentType.\n    if (arg instanceof FluentType) {\n        return arg;\n    }\n    // Convert the argument to a Fluent type.\n    switch (typeof arg) {\n        case \"string\":\n            return arg;\n        case \"number\":\n            return new FluentNumber(arg);\n        case \"object\":\n            if (arg instanceof Date) {\n                return new FluentDateTime(arg.getTime());\n            }\n        // eslint-disable-next-line no-fallthrough\n        default:\n            scope.reportError(new TypeError(`Variable type not supported: $${name}, ${typeof arg}`));\n            return new FluentNone(`$${name}`);\n    }\n}\n/** Resolve a reference to another message. */\nfunction resolveMessageReference(scope, { name, attr }) {\n    const message = scope.bundle._messages.get(name);\n    if (!message) {\n        scope.reportError(new ReferenceError(`Unknown message: ${name}`));\n        return new FluentNone(name);\n    }\n    if (attr) {\n        const attribute = message.attributes[attr];\n        if (attribute) {\n            return resolvePattern(scope, attribute);\n        }\n        scope.reportError(new ReferenceError(`Unknown attribute: ${attr}`));\n        return new FluentNone(`${name}.${attr}`);\n    }\n    if (message.value) {\n        return resolvePattern(scope, message.value);\n    }\n    scope.reportError(new ReferenceError(`No value: ${name}`));\n    return new FluentNone(name);\n}\n/** Resolve a call to a Term with key-value arguments. */\nfunction resolveTermReference(scope, { name, attr, args }) {\n    const id = `-${name}`;\n    const term = scope.bundle._terms.get(id);\n    if (!term) {\n        scope.reportError(new ReferenceError(`Unknown term: ${id}`));\n        return new FluentNone(id);\n    }\n    if (attr) {\n        const attribute = term.attributes[attr];\n        if (attribute) {\n            // Every TermReference has its own variables.\n            scope.params = getArguments(scope, args).named;\n            const resolved = resolvePattern(scope, attribute);\n            scope.params = null;\n            return resolved;\n        }\n        scope.reportError(new ReferenceError(`Unknown attribute: ${attr}`));\n        return new FluentNone(`${id}.${attr}`);\n    }\n    scope.params = getArguments(scope, args).named;\n    const resolved = resolvePattern(scope, term.value);\n    scope.params = null;\n    return resolved;\n}\n/** Resolve a call to a Function with positional and key-value arguments. */\nfunction resolveFunctionReference(scope, { name, args }) {\n    // Some functions are built-in. Others may be provided by the runtime via\n    // the `FluentBundle` constructor.\n    let func = scope.bundle._functions[name];\n    if (!func) {\n        scope.reportError(new ReferenceError(`Unknown function: ${name}()`));\n        return new FluentNone(`${name}()`);\n    }\n    if (typeof func !== \"function\") {\n        scope.reportError(new TypeError(`Function ${name}() is not callable`));\n        return new FluentNone(`${name}()`);\n    }\n    try {\n        let resolved = getArguments(scope, args);\n        return func(resolved.positional, resolved.named);\n    }\n    catch (err) {\n        scope.reportError(err);\n        return new FluentNone(`${name}()`);\n    }\n}\n/** Resolve a select expression to the member object. */\nfunction resolveSelectExpression(scope, { selector, variants, star }) {\n    let sel = resolveExpression(scope, selector);\n    if (sel instanceof FluentNone) {\n        return getDefault(scope, variants, star);\n    }\n    // Match the selector against keys of each variant, in order.\n    for (const variant of variants) {\n        const key = resolveExpression(scope, variant.key);\n        if (match(scope, sel, key)) {\n            return resolvePattern(scope, variant.value);\n        }\n    }\n    return getDefault(scope, variants, star);\n}\n/** Resolve a pattern (a complex string with placeables). */\nexport function resolveComplexPattern(scope, ptn) {\n    if (scope.dirty.has(ptn)) {\n        scope.reportError(new RangeError(\"Cyclic reference\"));\n        return new FluentNone();\n    }\n    // Tag the pattern as dirty for the purpose of the current resolution.\n    scope.dirty.add(ptn);\n    const result = [];\n    // Wrap interpolations with Directional Isolate Formatting characters\n    // only when the pattern has more than one element.\n    const useIsolating = scope.bundle._useIsolating && ptn.length > 1;\n    for (const elem of ptn) {\n        if (typeof elem === \"string\") {\n            result.push(scope.bundle._transform(elem));\n            continue;\n        }\n        scope.placeables++;\n        if (scope.placeables > MAX_PLACEABLES) {\n            scope.dirty.delete(ptn);\n            // This is a fatal error which causes the resolver to instantly bail out\n            // on this pattern. The length check protects against excessive memory\n            // usage, and throwing protects against eating up the CPU when long\n            // placeables are deeply nested.\n            throw new RangeError(`Too many placeables expanded: ${scope.placeables}, ` +\n                `max allowed is ${MAX_PLACEABLES}`);\n        }\n        if (useIsolating) {\n            result.push(FSI);\n        }\n        result.push(resolveExpression(scope, elem).toString(scope));\n        if (useIsolating) {\n            result.push(PDI);\n        }\n    }\n    scope.dirty.delete(ptn);\n    return result.join(\"\");\n}\n/**\n * Resolve a simple or a complex Pattern to a FluentString\n * (which is really the string primitive).\n */\nfunction resolvePattern(scope, value) {\n    // Resolve a simple pattern.\n    if (typeof value === \"string\") {\n        return scope.bundle._transform(value);\n    }\n    return resolveComplexPattern(scope, value);\n}\n","export class Scope {\n    constructor(bundle, errors, args) {\n        /**\n         * The Set of patterns already encountered during this resolution.\n         * Used to detect and prevent cyclic resolutions.\n         * @ignore\n         */\n        this.dirty = new WeakSet();\n        /** A dict of parameters passed to a TermReference. */\n        this.params = null;\n        /**\n         * The running count of placeables resolved so far.\n         * Used to detect the Billion Laughs and Quadratic Blowup attacks.\n         * @ignore\n         */\n        this.placeables = 0;\n        this.bundle = bundle;\n        this.errors = errors;\n        this.args = args;\n    }\n    reportError(error) {\n        if (!this.errors || !(error instanceof Error)) {\n            throw error;\n        }\n        this.errors.push(error);\n    }\n    memoizeIntlObject(ctor, opts) {\n        let cache = this.bundle._intls.get(ctor);\n        if (!cache) {\n            cache = {};\n            this.bundle._intls.set(ctor, cache);\n        }\n        let id = JSON.stringify(opts);\n        if (!cache[id]) {\n            cache[id] = new ctor(this.bundle.locales, opts);\n        }\n        return cache[id];\n    }\n}\n","/**\n * @overview\n *\n * The FTL resolver ships with a number of functions built-in.\n *\n * Each function take two arguments:\n *   - args - an array of positional args\n *   - opts - an object of key-value args\n *\n * Arguments to functions are guaranteed to already be instances of\n * `FluentValue`.  Functions must return `FluentValues` as well.\n */\nimport { FluentNone, FluentNumber, FluentDateTime, } from \"./types.js\";\nfunction values(opts, allowed) {\n    const unwrapped = Object.create(null);\n    for (const [name, opt] of Object.entries(opts)) {\n        if (allowed.includes(name)) {\n            unwrapped[name] = opt.valueOf();\n        }\n    }\n    return unwrapped;\n}\nconst NUMBER_ALLOWED = [\n    \"unitDisplay\",\n    \"currencyDisplay\",\n    \"useGrouping\",\n    \"minimumIntegerDigits\",\n    \"minimumFractionDigits\",\n    \"maximumFractionDigits\",\n    \"minimumSignificantDigits\",\n    \"maximumSignificantDigits\",\n];\n/**\n * The implementation of the `NUMBER()` builtin available to translations.\n *\n * Translations may call the `NUMBER()` builtin in order to specify formatting\n * options of a number. For example:\n *\n *     pi = The value of  is {NUMBER($pi, maximumFractionDigits: 2)}.\n *\n * The implementation expects an array of `FluentValues` representing the\n * positional arguments, and an object of named `FluentValues` representing the\n * named parameters.\n *\n * The following options are recognized:\n *\n *     unitDisplay\n *     currencyDisplay\n *     useGrouping\n *     minimumIntegerDigits\n *     minimumFractionDigits\n *     maximumFractionDigits\n *     minimumSignificantDigits\n *     maximumSignificantDigits\n *\n * Other options are ignored.\n *\n * @param args The positional arguments passed to this `NUMBER()`.\n * @param opts The named argments passed to this `NUMBER()`.\n */\nexport function NUMBER(args, opts) {\n    let arg = args[0];\n    if (arg instanceof FluentNone) {\n        return new FluentNone(`NUMBER(${arg.valueOf()})`);\n    }\n    if (arg instanceof FluentNumber) {\n        return new FluentNumber(arg.valueOf(), {\n            ...arg.opts,\n            ...values(opts, NUMBER_ALLOWED),\n        });\n    }\n    if (arg instanceof FluentDateTime) {\n        return new FluentNumber(arg.valueOf(), {\n            ...values(opts, NUMBER_ALLOWED),\n        });\n    }\n    throw new TypeError(\"Invalid argument to NUMBER\");\n}\nconst DATETIME_ALLOWED = [\n    \"dateStyle\",\n    \"timeStyle\",\n    \"fractionalSecondDigits\",\n    \"dayPeriod\",\n    \"hour12\",\n    \"weekday\",\n    \"era\",\n    \"year\",\n    \"month\",\n    \"day\",\n    \"hour\",\n    \"minute\",\n    \"second\",\n    \"timeZoneName\",\n];\n/**\n * The implementation of the `DATETIME()` builtin available to translations.\n *\n * Translations may call the `DATETIME()` builtin in order to specify\n * formatting options of a number. For example:\n *\n *     now = It's {DATETIME($today, month: \"long\")}.\n *\n * The implementation expects an array of `FluentValues` representing the\n * positional arguments, and an object of named `FluentValues` representing the\n * named parameters.\n *\n * The following options are recognized:\n *\n *     dateStyle\n *     timeStyle\n *     fractionalSecondDigits\n *     dayPeriod\n *     hour12\n *     weekday\n *     era\n *     year\n *     month\n *     day\n *     hour\n *     minute\n *     second\n *     timeZoneName\n *\n * Other options are ignored.\n *\n * @param args The positional arguments passed to this `DATETIME()`.\n * @param opts The named argments passed to this `DATETIME()`.\n */\nexport function DATETIME(args, opts) {\n    let arg = args[0];\n    if (arg instanceof FluentNone) {\n        return new FluentNone(`DATETIME(${arg.valueOf()})`);\n    }\n    if (arg instanceof FluentDateTime) {\n        return new FluentDateTime(arg.valueOf(), {\n            ...arg.opts,\n            ...values(opts, DATETIME_ALLOWED),\n        });\n    }\n    if (arg instanceof FluentNumber) {\n        return new FluentDateTime(arg.valueOf(), {\n            ...values(opts, DATETIME_ALLOWED),\n        });\n    }\n    throw new TypeError(\"Invalid argument to DATETIME\");\n}\n","const cache = new Map();\nexport function getMemoizerForLocale(locales) {\n    const stringLocale = Array.isArray(locales) ? locales.join(\" \") : locales;\n    let memoizer = cache.get(stringLocale);\n    if (memoizer === undefined) {\n        memoizer = new Map();\n        cache.set(stringLocale, memoizer);\n    }\n    return memoizer;\n}\n","import { resolveComplexPattern } from \"./resolver.js\";\nimport { Scope } from \"./scope.js\";\nimport { FluentNone } from \"./types.js\";\nimport { NUMBER, DATETIME } from \"./builtins.js\";\nimport { getMemoizerForLocale } from \"./memoizer.js\";\n/**\n * Message bundles are single-language stores of translation resources. They are\n * responsible for formatting message values and attributes to strings.\n */\nexport class FluentBundle {\n    /**\n     * Create an instance of `FluentBundle`.\n     *\n     * @example\n     * ```js\n     * let bundle = new FluentBundle([\"en-US\", \"en\"]);\n     *\n     * let bundle = new FluentBundle(locales, {useIsolating: false});\n     *\n     * let bundle = new FluentBundle(locales, {\n     *   useIsolating: true,\n     *   functions: {\n     *     NODE_ENV: () => process.env.NODE_ENV\n     *   }\n     * });\n     * ```\n     *\n     * @param locales - Used to instantiate `Intl` formatters used by translations.\n     * @param options - Optional configuration for the bundle.\n     */\n    constructor(locales, { functions, useIsolating = true, transform = (v) => v, } = {}) {\n        /** @ignore */\n        this._terms = new Map();\n        /** @ignore */\n        this._messages = new Map();\n        this.locales = Array.isArray(locales) ? locales : [locales];\n        this._functions = {\n            NUMBER,\n            DATETIME,\n            ...functions,\n        };\n        this._useIsolating = useIsolating;\n        this._transform = transform;\n        this._intls = getMemoizerForLocale(locales);\n    }\n    /**\n     * Check if a message is present in the bundle.\n     *\n     * @param id - The identifier of the message to check.\n     */\n    hasMessage(id) {\n        return this._messages.has(id);\n    }\n    /**\n     * Return a raw unformatted message object from the bundle.\n     *\n     * Raw messages are `{value, attributes}` shapes containing translation units\n     * called `Patterns`. `Patterns` are implementation-specific; they should be\n     * treated as black boxes and formatted with `FluentBundle.formatPattern`.\n     *\n     * @param id - The identifier of the message to check.\n     */\n    getMessage(id) {\n        return this._messages.get(id);\n    }\n    /**\n     * Add a translation resource to the bundle.\n     *\n     * @example\n     * ```js\n     * let res = new FluentResource(\"foo = Foo\");\n     * bundle.addResource(res);\n     * bundle.getMessage(\"foo\");\n     * //  {value: .., attributes: {..}}\n     * ```\n     *\n     * @param res\n     * @param options\n     */\n    addResource(res, { allowOverrides = false, } = {}) {\n        const errors = [];\n        for (let i = 0; i < res.body.length; i++) {\n            let entry = res.body[i];\n            if (entry.id.startsWith(\"-\")) {\n                // Identifiers starting with a dash (-) define terms. Terms are private\n                // and cannot be retrieved from FluentBundle.\n                if (allowOverrides === false && this._terms.has(entry.id)) {\n                    errors.push(new Error(`Attempt to override an existing term: \"${entry.id}\"`));\n                    continue;\n                }\n                this._terms.set(entry.id, entry);\n            }\n            else {\n                if (allowOverrides === false && this._messages.has(entry.id)) {\n                    errors.push(new Error(`Attempt to override an existing message: \"${entry.id}\"`));\n                    continue;\n                }\n                this._messages.set(entry.id, entry);\n            }\n        }\n        return errors;\n    }\n    /**\n     * Format a `Pattern` to a string.\n     *\n     * Format a raw `Pattern` into a string. `args` will be used to resolve\n     * references to variables passed as arguments to the translation.\n     *\n     * In case of errors `formatPattern` will try to salvage as much of the\n     * translation as possible and will still return a string. For performance\n     * reasons, the encountered errors are not returned but instead are appended\n     * to the `errors` array passed as the third argument.\n     *\n     * If `errors` is omitted, the first encountered error will be thrown.\n     *\n     * @example\n     * ```js\n     * let errors = [];\n     * bundle.addResource(\n     *     new FluentResource(\"hello = Hello, {$name}!\"));\n     *\n     * let hello = bundle.getMessage(\"hello\");\n     * if (hello.value) {\n     *     bundle.formatPattern(hello.value, {name: \"Jane\"}, errors);\n     *     // Returns \"Hello, Jane!\" and `errors` is empty.\n     *\n     *     bundle.formatPattern(hello.value, undefined, errors);\n     *     // Returns \"Hello, {$name}!\" and `errors` is now:\n     *     // [<ReferenceError: Unknown variable: name>]\n     * }\n     * ```\n     */\n    formatPattern(pattern, args = null, errors = null) {\n        // Resolve a simple pattern without creating a scope. No error handling is\n        // required; by definition simple patterns don't have placeables.\n        if (typeof pattern === \"string\") {\n            return this._transform(pattern);\n        }\n        // Resolve a complex pattern.\n        let scope = new Scope(this, errors, args);\n        try {\n            let value = resolveComplexPattern(scope, pattern);\n            return value.toString(scope);\n        }\n        catch (err) {\n            if (scope.errors && err instanceof Error) {\n                scope.errors.push(err);\n                return new FluentNone().toString(scope);\n            }\n            throw err;\n        }\n    }\n}\n","// This regex is used to iterate through the beginnings of messages and terms.\n// With the /m flag, the ^ matches at the beginning of every line.\nconst RE_MESSAGE_START = /^(-?[a-zA-Z][\\w-]*) *= */gm;\n// Both Attributes and Variants are parsed in while loops. These regexes are\n// used to break out of them.\nconst RE_ATTRIBUTE_START = /\\.([a-zA-Z][\\w-]*) *= */y;\nconst RE_VARIANT_START = /\\*?\\[/y;\nconst RE_NUMBER_LITERAL = /(-?[0-9]+(?:\\.([0-9]+))?)/y;\nconst RE_IDENTIFIER = /([a-zA-Z][\\w-]*)/y;\nconst RE_REFERENCE = /([$-])?([a-zA-Z][\\w-]*)(?:\\.([a-zA-Z][\\w-]*))?/y;\nconst RE_FUNCTION_NAME = /^[A-Z][A-Z0-9_-]*$/;\n// A \"run\" is a sequence of text or string literal characters which don't\n// require any special handling. For TextElements such special characters are: {\n// (starts a placeable), and line breaks which require additional logic to check\n// if the next line is indented. For StringLiterals they are: \\ (starts an\n// escape sequence), \" (ends the literal), and line breaks which are not allowed\n// in StringLiterals. Note that string runs may be empty; text runs may not.\nconst RE_TEXT_RUN = /([^{}\\n\\r]+)/y;\nconst RE_STRING_RUN = /([^\\\\\"\\n\\r]*)/y;\n// Escape sequences.\nconst RE_STRING_ESCAPE = /\\\\([\\\\\"])/y;\nconst RE_UNICODE_ESCAPE = /\\\\u([a-fA-F0-9]{4})|\\\\U([a-fA-F0-9]{6})/y;\n// Used for trimming TextElements and indents.\nconst RE_LEADING_NEWLINES = /^\\n+/;\nconst RE_TRAILING_SPACES = / +$/;\n// Used in makeIndent to strip spaces from blank lines and normalize CRLF to LF.\nconst RE_BLANK_LINES = / *\\r?\\n/g;\n// Used in makeIndent to measure the indentation.\nconst RE_INDENT = /( *)$/;\n// Common tokens.\nconst TOKEN_BRACE_OPEN = /{\\s*/y;\nconst TOKEN_BRACE_CLOSE = /\\s*}/y;\nconst TOKEN_BRACKET_OPEN = /\\[\\s*/y;\nconst TOKEN_BRACKET_CLOSE = /\\s*] */y;\nconst TOKEN_PAREN_OPEN = /\\s*\\(\\s*/y;\nconst TOKEN_ARROW = /\\s*->\\s*/y;\nconst TOKEN_COLON = /\\s*:\\s*/y;\n// Note the optional comma. As a deviation from the Fluent EBNF, the parser\n// doesn't enforce commas between call arguments.\nconst TOKEN_COMMA = /\\s*,?\\s*/y;\nconst TOKEN_BLANK = /\\s+/y;\n/**\n * Fluent Resource is a structure storing parsed localization entries.\n */\nexport class FluentResource {\n    constructor(source) {\n        this.body = [];\n        RE_MESSAGE_START.lastIndex = 0;\n        let cursor = 0;\n        // Iterate over the beginnings of messages and terms to efficiently skip\n        // comments and recover from errors.\n        while (true) {\n            let next = RE_MESSAGE_START.exec(source);\n            if (next === null) {\n                break;\n            }\n            cursor = RE_MESSAGE_START.lastIndex;\n            try {\n                this.body.push(parseMessage(next[1]));\n            }\n            catch (err) {\n                if (err instanceof SyntaxError) {\n                    // Don't report any Fluent syntax errors. Skip directly to the\n                    // beginning of the next message or term.\n                    continue;\n                }\n                throw err;\n            }\n        }\n        // The parser implementation is inlined below for performance reasons,\n        // as well as for convenience of accessing `source` and `cursor`.\n        // The parser focuses on minimizing the number of false negatives at the\n        // expense of increasing the risk of false positives. In other words, it\n        // aims at parsing valid Fluent messages with a success rate of 100%, but it\n        // may also parse a few invalid messages which the reference parser would\n        // reject. The parser doesn't perform any validation and may produce entries\n        // which wouldn't make sense in the real world. For best results users are\n        // advised to validate translations with the fluent-syntax parser\n        // pre-runtime.\n        // The parser makes an extensive use of sticky regexes which can be anchored\n        // to any offset of the source string without slicing it. Errors are thrown\n        // to bail out of parsing of ill-formed messages.\n        function test(re) {\n            re.lastIndex = cursor;\n            return re.test(source);\n        }\n        // Advance the cursor by the char if it matches. May be used as a predicate\n        // (was the match found?) or, if errorClass is passed, as an assertion.\n        function consumeChar(char, errorClass) {\n            if (source[cursor] === char) {\n                cursor++;\n                return true;\n            }\n            if (errorClass) {\n                throw new errorClass(`Expected ${char}`);\n            }\n            return false;\n        }\n        // Advance the cursor by the token if it matches. May be used as a predicate\n        // (was the match found?) or, if errorClass is passed, as an assertion.\n        function consumeToken(re, errorClass) {\n            if (test(re)) {\n                cursor = re.lastIndex;\n                return true;\n            }\n            if (errorClass) {\n                throw new errorClass(`Expected ${re.toString()}`);\n            }\n            return false;\n        }\n        // Execute a regex, advance the cursor, and return all capture groups.\n        function match(re) {\n            re.lastIndex = cursor;\n            let result = re.exec(source);\n            if (result === null) {\n                throw new SyntaxError(`Expected ${re.toString()}`);\n            }\n            cursor = re.lastIndex;\n            return result;\n        }\n        // Execute a regex, advance the cursor, and return the capture group.\n        function match1(re) {\n            return match(re)[1];\n        }\n        function parseMessage(id) {\n            let value = parsePattern();\n            let attributes = parseAttributes();\n            if (value === null && Object.keys(attributes).length === 0) {\n                throw new SyntaxError(\"Expected message value or attributes\");\n            }\n            return { id, value, attributes };\n        }\n        function parseAttributes() {\n            let attrs = Object.create(null);\n            while (test(RE_ATTRIBUTE_START)) {\n                let name = match1(RE_ATTRIBUTE_START);\n                let value = parsePattern();\n                if (value === null) {\n                    throw new SyntaxError(\"Expected attribute value\");\n                }\n                attrs[name] = value;\n            }\n            return attrs;\n        }\n        function parsePattern() {\n            let first;\n            // First try to parse any simple text on the same line as the id.\n            if (test(RE_TEXT_RUN)) {\n                first = match1(RE_TEXT_RUN);\n            }\n            // If there's a placeable on the first line, parse a complex pattern.\n            if (source[cursor] === \"{\" || source[cursor] === \"}\") {\n                // Re-use the text parsed above, if possible.\n                return parsePatternElements(first ? [first] : [], Infinity);\n            }\n            // RE_TEXT_VALUE stops at newlines. Only continue parsing the pattern if\n            // what comes after the newline is indented.\n            let indent = parseIndent();\n            if (indent) {\n                if (first) {\n                    // If there's text on the first line, the blank block is part of the\n                    // translation content in its entirety.\n                    return parsePatternElements([first, indent], indent.length);\n                }\n                // Otherwise, we're dealing with a block pattern, i.e. a pattern which\n                // starts on a new line. Discrad the leading newlines but keep the\n                // inline indent; it will be used by the dedentation logic.\n                indent.value = trim(indent.value, RE_LEADING_NEWLINES);\n                return parsePatternElements([indent], indent.length);\n            }\n            if (first) {\n                // It was just a simple inline text after all.\n                return trim(first, RE_TRAILING_SPACES);\n            }\n            return null;\n        }\n        // Parse a complex pattern as an array of elements.\n        function parsePatternElements(elements = [], commonIndent) {\n            while (true) {\n                if (test(RE_TEXT_RUN)) {\n                    elements.push(match1(RE_TEXT_RUN));\n                    continue;\n                }\n                if (source[cursor] === \"{\") {\n                    elements.push(parsePlaceable());\n                    continue;\n                }\n                if (source[cursor] === \"}\") {\n                    throw new SyntaxError(\"Unbalanced closing brace\");\n                }\n                let indent = parseIndent();\n                if (indent) {\n                    elements.push(indent);\n                    commonIndent = Math.min(commonIndent, indent.length);\n                    continue;\n                }\n                break;\n            }\n            let lastIndex = elements.length - 1;\n            let lastElement = elements[lastIndex];\n            // Trim the trailing spaces in the last element if it's a TextElement.\n            if (typeof lastElement === \"string\") {\n                elements[lastIndex] = trim(lastElement, RE_TRAILING_SPACES);\n            }\n            let baked = [];\n            for (let element of elements) {\n                if (element instanceof Indent) {\n                    // Dedent indented lines by the maximum common indent.\n                    element = element.value.slice(0, element.value.length - commonIndent);\n                }\n                if (element) {\n                    baked.push(element);\n                }\n            }\n            return baked;\n        }\n        function parsePlaceable() {\n            consumeToken(TOKEN_BRACE_OPEN, SyntaxError);\n            let selector = parseInlineExpression();\n            if (consumeToken(TOKEN_BRACE_CLOSE)) {\n                return selector;\n            }\n            if (consumeToken(TOKEN_ARROW)) {\n                let variants = parseVariants();\n                consumeToken(TOKEN_BRACE_CLOSE, SyntaxError);\n                return {\n                    type: \"select\",\n                    selector,\n                    ...variants,\n                };\n            }\n            throw new SyntaxError(\"Unclosed placeable\");\n        }\n        function parseInlineExpression() {\n            if (source[cursor] === \"{\") {\n                // It's a nested placeable.\n                return parsePlaceable();\n            }\n            if (test(RE_REFERENCE)) {\n                let [, sigil, name, attr = null] = match(RE_REFERENCE);\n                if (sigil === \"$\") {\n                    return { type: \"var\", name };\n                }\n                if (consumeToken(TOKEN_PAREN_OPEN)) {\n                    let args = parseArguments();\n                    if (sigil === \"-\") {\n                        // A parameterized term: -term(...).\n                        return { type: \"term\", name, attr, args };\n                    }\n                    if (RE_FUNCTION_NAME.test(name)) {\n                        return { type: \"func\", name, args };\n                    }\n                    throw new SyntaxError(\"Function names must be all upper-case\");\n                }\n                if (sigil === \"-\") {\n                    // A non-parameterized term: -term.\n                    return {\n                        type: \"term\",\n                        name,\n                        attr,\n                        args: [],\n                    };\n                }\n                return { type: \"mesg\", name, attr };\n            }\n            return parseLiteral();\n        }\n        function parseArguments() {\n            let args = [];\n            while (true) {\n                switch (source[cursor]) {\n                    case \")\": // End of the argument list.\n                        cursor++;\n                        return args;\n                    case undefined: // EOF\n                        throw new SyntaxError(\"Unclosed argument list\");\n                }\n                args.push(parseArgument());\n                // Commas between arguments are treated as whitespace.\n                consumeToken(TOKEN_COMMA);\n            }\n        }\n        function parseArgument() {\n            let expr = parseInlineExpression();\n            if (expr.type !== \"mesg\") {\n                return expr;\n            }\n            if (consumeToken(TOKEN_COLON)) {\n                // The reference is the beginning of a named argument.\n                return {\n                    type: \"narg\",\n                    name: expr.name,\n                    value: parseLiteral(),\n                };\n            }\n            // It's a regular message reference.\n            return expr;\n        }\n        function parseVariants() {\n            let variants = [];\n            let count = 0;\n            let star;\n            while (test(RE_VARIANT_START)) {\n                if (consumeChar(\"*\")) {\n                    star = count;\n                }\n                let key = parseVariantKey();\n                let value = parsePattern();\n                if (value === null) {\n                    throw new SyntaxError(\"Expected variant value\");\n                }\n                variants[count++] = { key, value };\n            }\n            if (count === 0) {\n                return null;\n            }\n            if (star === undefined) {\n                throw new SyntaxError(\"Expected default variant\");\n            }\n            return { variants, star };\n        }\n        function parseVariantKey() {\n            consumeToken(TOKEN_BRACKET_OPEN, SyntaxError);\n            let key;\n            if (test(RE_NUMBER_LITERAL)) {\n                key = parseNumberLiteral();\n            }\n            else {\n                key = {\n                    type: \"str\",\n                    value: match1(RE_IDENTIFIER),\n                };\n            }\n            consumeToken(TOKEN_BRACKET_CLOSE, SyntaxError);\n            return key;\n        }\n        function parseLiteral() {\n            if (test(RE_NUMBER_LITERAL)) {\n                return parseNumberLiteral();\n            }\n            if (source[cursor] === '\"') {\n                return parseStringLiteral();\n            }\n            throw new SyntaxError(\"Invalid expression\");\n        }\n        function parseNumberLiteral() {\n            let [, value, fraction = \"\"] = match(RE_NUMBER_LITERAL);\n            let precision = fraction.length;\n            return {\n                type: \"num\",\n                value: parseFloat(value),\n                precision,\n            };\n        }\n        function parseStringLiteral() {\n            consumeChar('\"', SyntaxError);\n            let value = \"\";\n            while (true) {\n                value += match1(RE_STRING_RUN);\n                if (source[cursor] === \"\\\\\") {\n                    value += parseEscapeSequence();\n                    continue;\n                }\n                if (consumeChar('\"')) {\n                    return { type: \"str\", value };\n                }\n                // We've reached an EOL of EOF.\n                throw new SyntaxError(\"Unclosed string literal\");\n            }\n        }\n        // Unescape known escape sequences.\n        function parseEscapeSequence() {\n            if (test(RE_STRING_ESCAPE)) {\n                return match1(RE_STRING_ESCAPE);\n            }\n            if (test(RE_UNICODE_ESCAPE)) {\n                let [, codepoint4, codepoint6] = match(RE_UNICODE_ESCAPE);\n                let codepoint = parseInt(codepoint4 || codepoint6, 16);\n                return codepoint <= 0xd7ff || 0xe000 <= codepoint\n                    ? // It's a Unicode scalar value.\n                        String.fromCodePoint(codepoint)\n                    : // Lonely surrogates can cause trouble when the parsing result is\n                        // saved using UTF-8. Use U+FFFD REPLACEMENT CHARACTER instead.\n                        \"\";\n            }\n            throw new SyntaxError(\"Unknown escape sequence\");\n        }\n        // Parse blank space. Return it if it looks like indent before a pattern\n        // line. Skip it othwerwise.\n        function parseIndent() {\n            let start = cursor;\n            consumeToken(TOKEN_BLANK);\n            // Check the first non-blank character after the indent.\n            switch (source[cursor]) {\n                case \".\":\n                case \"[\":\n                case \"*\":\n                case \"}\":\n                case undefined: // EOF\n                    // A special character. End the Pattern.\n                    return false;\n                case \"{\":\n                    // Placeables don't require indentation (in EBNF: block-placeable).\n                    // Continue the Pattern.\n                    return makeIndent(source.slice(start, cursor));\n            }\n            // If the first character on the line is not one of the special characters\n            // listed above, it's a regular text character. Check if there's at least\n            // one space of indent before it.\n            if (source[cursor - 1] === \" \") {\n                // It's an indented text character (in EBNF: indented-char). Continue\n                // the Pattern.\n                return makeIndent(source.slice(start, cursor));\n            }\n            // A not-indented text character is likely the identifier of the next\n            // message. End the Pattern.\n            return false;\n        }\n        // Trim blanks in text according to the given regex.\n        function trim(text, re) {\n            return text.replace(re, \"\");\n        }\n        // Normalize a blank block and extract the indent details.\n        function makeIndent(blank) {\n            let value = blank.replace(RE_BLANK_LINES, \"\\n\");\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            let length = RE_INDENT.exec(blank)[1].length;\n            return new Indent(value, length);\n        }\n    }\n}\nclass Indent {\n    constructor(value, length) {\n        this.value = value;\n        this.length = length;\n    }\n}\n","/* eslint no-magic-numbers: 0 */\nconst languageCodeRe = \"([a-z]{2,3}|\\\\*)\";\nconst scriptCodeRe = \"(?:-([a-z]{4}|\\\\*))\";\nconst regionCodeRe = \"(?:-([a-z]{2}|\\\\*))\";\nconst variantCodeRe = \"(?:-(([0-9][a-z0-9]{3}|[a-z0-9]{5,8})|\\\\*))\";\n/**\n * Regular expression splitting locale id into four pieces:\n *\n * Example: `en-Latn-US-macos`\n *\n * language: en\n * script:   Latn\n * region:   US\n * variant:  macos\n *\n * It can also accept a range `*` character on any position.\n */\nconst localeRe = new RegExp(`^${languageCodeRe}${scriptCodeRe}?${regionCodeRe}?${variantCodeRe}?$`, \"i\");\nexport class Locale {\n    /**\n     * Parses a locale id using the localeRe into an array with four elements.\n     *\n     * If the second argument `range` is set to true, it places range `*` char\n     * in place of any missing piece.\n     *\n     * It also allows skipping the script section of the id, so `en-US` is\n     * properly parsed as `en-*-US-*`.\n     */\n    constructor(locale) {\n        const result = localeRe.exec(locale.replace(/_/g, \"-\"));\n        if (!result) {\n            this.isWellFormed = false;\n            return;\n        }\n        let [, language, script, region, variant] = result;\n        if (language) {\n            this.language = language.toLowerCase();\n        }\n        if (script) {\n            this.script = script[0].toUpperCase() + script.slice(1);\n        }\n        if (region) {\n            this.region = region.toUpperCase();\n        }\n        this.variant = variant;\n        this.isWellFormed = true;\n    }\n    isEqual(other) {\n        return (this.language === other.language &&\n            this.script === other.script &&\n            this.region === other.region &&\n            this.variant === other.variant);\n    }\n    matches(other, thisRange = false, otherRange = false) {\n        return ((this.language === other.language ||\n            (thisRange && this.language === undefined) ||\n            (otherRange && other.language === undefined)) &&\n            (this.script === other.script ||\n                (thisRange && this.script === undefined) ||\n                (otherRange && other.script === undefined)) &&\n            (this.region === other.region ||\n                (thisRange && this.region === undefined) ||\n                (otherRange && other.region === undefined)) &&\n            (this.variant === other.variant ||\n                (thisRange && this.variant === undefined) ||\n                (otherRange && other.variant === undefined)));\n    }\n    toString() {\n        return [this.language, this.script, this.region, this.variant]\n            .filter(part => part !== undefined)\n            .join(\"-\");\n    }\n    clearVariants() {\n        this.variant = undefined;\n    }\n    clearRegion() {\n        this.region = undefined;\n    }\n    addLikelySubtags() {\n        const newLocale = getLikelySubtagsMin(this.toString().toLowerCase());\n        if (newLocale) {\n            this.language = newLocale.language;\n            this.script = newLocale.script;\n            this.region = newLocale.region;\n            this.variant = newLocale.variant;\n            return true;\n        }\n        return false;\n    }\n}\n/**\n * Below is a manually a list of likely subtags corresponding to Unicode\n * CLDR likelySubtags list.\n * This list is curated by the maintainers of Project Fluent and is\n * intended to be used in place of the full likelySubtags list in use cases\n * where full list cannot be (for example, due to the size).\n *\n * This version of the list is based on CLDR 30.0.3.\n */\nconst likelySubtagsMin = {\n    ar: \"ar-arab-eg\",\n    \"az-arab\": \"az-arab-ir\",\n    \"az-ir\": \"az-arab-ir\",\n    be: \"be-cyrl-by\",\n    da: \"da-latn-dk\",\n    el: \"el-grek-gr\",\n    en: \"en-latn-us\",\n    fa: \"fa-arab-ir\",\n    ja: \"ja-jpan-jp\",\n    ko: \"ko-kore-kr\",\n    pt: \"pt-latn-br\",\n    sr: \"sr-cyrl-rs\",\n    \"sr-ru\": \"sr-latn-ru\",\n    sv: \"sv-latn-se\",\n    ta: \"ta-taml-in\",\n    uk: \"uk-cyrl-ua\",\n    zh: \"zh-hans-cn\",\n    \"zh-hant\": \"zh-hant-tw\",\n    \"zh-hk\": \"zh-hant-hk\",\n    \"zh-mo\": \"zh-hant-mo\",\n    \"zh-tw\": \"zh-hant-tw\",\n    \"zh-gb\": \"zh-hant-gb\",\n    \"zh-us\": \"zh-hant-us\",\n};\nconst regionMatchingLangs = [\n    \"az\",\n    \"bg\",\n    \"cs\",\n    \"de\",\n    \"es\",\n    \"fi\",\n    \"fr\",\n    \"hu\",\n    \"it\",\n    \"lt\",\n    \"lv\",\n    \"nl\",\n    \"pl\",\n    \"ro\",\n    \"ru\",\n];\nfunction getLikelySubtagsMin(loc) {\n    if (Object.prototype.hasOwnProperty.call(likelySubtagsMin, loc)) {\n        return new Locale(likelySubtagsMin[loc]);\n    }\n    const locale = new Locale(loc);\n    if (locale.language && regionMatchingLangs.includes(locale.language)) {\n        locale.region = locale.language.toUpperCase();\n        return locale;\n    }\n    return null;\n}\n","import { FluentBundle, FluentResource } from \"@fluent/bundle\";\nimport { negotiateLanguages } from \"@fluent/langneg\";\n// This is automatically populated by `tools/bundle_texts.js` via a postbuild script\nconst BUNDLED_TEXTS = {\n  \"ca-ES\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"de-DE\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"en-US\": {\n    \"context_menu.ftl\": \"context-menu-download-swf = Download .swf\\ncontext-menu-copy-debug-info = Copy debug info\\ncontext-menu-open-save-manager = Open Save Manager\\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension] About Ruffle Extension ({$version})\\n        *[other] About Ruffle ({$version})\\n    }\\ncontext-menu-hide = Hide this menu\\ncontext-menu-exit-fullscreen = Exit fullscreen\\ncontext-menu-enter-fullscreen = Enter fullscreen\",\n    \"messages.ftl\": \"message-unsupported-avm2 =\\n    The Ruffle emulator may not yet fully support all of ActionScript 3 used by this content.\\n    Some parts of the content may not work as expected.\\nmessage-cant-embed =\\n    Ruffle wasn't able to run the Flash embedded in this page.\\n    You can try to open the file in a separate tab, to sidestep this issue.\\npanic-title = Something went wrong :(\\nmore-info = More info\\nrun-anyway = Run anyway\\ncontinue = Continue\\nreport-bug = Report Bug\\nupdate-ruffle = Update Ruffle\\nruffle-demo = Web Demo\\nruffle-desktop = Desktop Application\\nruffle-wiki = View Ruffle Wiki\\nview-error-details = View Error Details\\nopen-in-new-tab = Open in a new tab\\nclick-to-unmute = Click to unmute\\nerror-file-protocol =\\n    It appears you are running Ruffle on the \\\"file:\\\" protocol.\\n    This doesn't work as browsers block many features from working for security reasons.\\n    Instead, we invite you to setup a local server or either use the web demo or the desktop application.\\nerror-javascript-config =\\n    Ruffle has encountered a major issue due to an incorrect JavaScript configuration.\\n    If you are the server administrator, we invite you to check the error details to find out which parameter is at fault.\\n    You can also consult the Ruffle wiki for help.\\nerror-wasm-not-found =\\n    Ruffle failed to load the required \\\".wasm\\\" file component.\\n    If you are the server administrator, please ensure the file has correctly been uploaded.\\n    If the issue persists, you may need to use the \\\"publicPath\\\" setting: please consult the Ruffle wiki for help.\\nerror-wasm-mime-type =\\n    Ruffle has encountered a major issue whilst trying to initialize.\\n    This web server is not serving \\\".wasm\\\" files with the correct MIME type.\\n    If you are the server administrator, please consult the Ruffle wiki for help.\\nerror-swf-fetch =\\n    Ruffle failed to load the Flash SWF file.\\n    The most likely reason is that the file no longer exists, so there is nothing for Ruffle to load.\\n    Try contacting the website administrator for help.\\nerror-swf-cors =\\n    Ruffle failed to load the Flash SWF file.\\n    Access to fetch has likely been blocked by CORS policy.\\n    If you are the server administrator, please consult the Ruffle wiki for help.\\nerror-wasm-cors =\\n    Ruffle failed to load the required \\\".wasm\\\" file component.\\n    Access to fetch has likely been blocked by CORS policy.\\n    If you are the server administrator, please consult the Ruffle wiki for help.\\nerror-wasm-invalid =\\n    Ruffle has encountered a major issue whilst trying to initialize.\\n    It seems like this page has missing or invalid files for running Ruffle.\\n    If you are the server administrator, please consult the Ruffle wiki for help.\\nerror-wasm-download =\\n    Ruffle has encountered a major issue whilst trying to initialize.\\n    This can often resolve itself, so you can try reloading the page.\\n    Otherwise, please contact the website administrator.\\nerror-wasm-disabled-on-edge =\\n    Ruffle failed to load the required \\\".wasm\\\" file component.\\n    To fix this, try opening your browser's settings, clicking \\\"Privacy, search, and services\\\", scrolling down, and turning off \\\"Enhance your security on the web\\\".\\n    This will allow your browser to load the required \\\".wasm\\\" files.\\n    If the issue persists, you might have to use a different browser.\\nerror-javascript-conflict =\\n    Ruffle has encountered a major issue whilst trying to initialize.\\n    It seems like this page uses JavaScript code that conflicts with Ruffle.\\n    If you are the server administrator, we invite you to try loading the file on a blank page.\\nerror-javascript-conflict-outdated = You can also try to upload a more recent version of Ruffle that may circumvent the issue (current build is outdated: {$buildDate}).\\nerror-csp-conflict =\\n    Ruffle has encountered a major issue whilst trying to initialize.\\n    This web server's Content Security Policy does not allow the required \\\".wasm\\\" component to run.\\n    If you are the server administrator, please consult the Ruffle wiki for help.\\nerror-unknown =\\n    Ruffle has encountered a major issue whilst trying to display this Flash content.\\n    {$outdated ->\\n        [true] If you are the server administrator, please try to upload a more recent version of Ruffle (current build is outdated: {$buildDate}).\\n        *[false] This isn't supposed to happen, so we'd really appreciate if you could file a bug!\\n    }\",\n    \"save-manager.ftl\": \"save-delete-prompt = Are you sure you want to delete this save file?\\nsave-reload-prompt =\\n    The only way to {$action ->\\n    [delete] delete\\n    *[replace] replace\\n    } this save file without potential conflict is to reload this content. Do you wish to continue anyway?\\nsave-download = Download\\nsave-replace = Replace\\nsave-delete = Delete\\nsave-backup-all = Backup all saves (download all sols)\"\n  },\n  \"es-ES\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"fr-FR\": {\n    \"context_menu.ftl\": \"context-menu-download-swf = Tlcharger en tant que .swf\\ncontext-menu-copy-debug-info = Copier les infos de dbogage\\ncontext-menu-open-save-manager = Ouvrir le gestionnaire de stockage\\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension]  propos de Ruffle Extension ({ $version })\\n       *[other]  propos de Ruffle ({ $version })\\n    }\\ncontext-menu-hide = Masquer ce menu\\ncontext-menu-exit-fullscreen = Sortir du mode plein cran\\ncontext-menu-enter-fullscreen = Afficher en plein cran\\n\",\n    \"messages.ftl\": \"message-unsupported-avm2 =\\n    L'mulateur Ruffle ne prend pas encore en charge toutes les fonctionnalits du langage ActionScript 3.\\n    Certaines parties de ce contenu pourraient ainsi ne pas fonctionner correctement.\\nmessage-cant-embed =\\n    Ruffle n'a pas t en mesure de lire le fichier Flash intgr dans cette page.\\n    Vous pouvez essayer d'ouvrir le fichier dans un onglet isol, pour contourner le problme.\\nmore-info = Plus d'infos\\nrun-anyway = Excuter quand mme\\ncontinue = Continuer\\nopen-in-new-tab = Ouvrir dans un nouvel onglet\\nclick-to-unmute = Cliquez pour activer le son\\n\",\n    \"save-manager.ftl\": \"save-delete-prompt = Voulez-vous vraiment supprimer ce fichier de sauvegarde ?\\nsave-reload-prompt =\\n    La seule faon de { $action ->\\n        [delete] supprimer\\n       *[replace] remplacer\\n    } ce fichier de sauvegarde sans conflit potentiel est de recharger ce contenu. Souhaitez-vous quand mme continuer ?\\nsave-download = Tlcharger\\nsave-replace = Remplacer\\nsave-delete = Supprimer\\n\"\n  },\n  \"hu-HU\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"it-IT\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"ja-JP\": {\n    \"context_menu.ftl\": \"context-menu-download-swf = .swf\\ncontext-menu-copy-debug-info = \\ncontext-menu-open-save-manager = \\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension] Ruffle ({ $version })\\n       *[other] Ruffle ({ $version })\\n    }\\ncontext-menu-hide = \\ncontext-menu-exit-fullscreen = \\ncontext-menu-enter-fullscreen = \\n\",\n    \"messages.ftl\": \"message-unsupported-avm2 = RuffleActionScript3\\nmessage-cant-embed =\\n    Ruffle Flash \\n    \\npanic-title =  :(\\nmore-info = \\nrun-anyway = \\ncontinue = \\nreport-bug = \\nupdate-ruffle = Ruffle\\nruffle-demo = Web\\nruffle-desktop = \\nruffle-wiki = Ruffle Wiki\\nview-error-details = \\nopen-in-new-tab = \\nclick-to-unmute = \\nerror-file-protocol =\\n    Ruffle\\\"file:\\\"\\n    \\n    \\nerror-javascript-config =\\n    JavaScriptRuffle\\n    \\n    Rufflewiki\\nerror-swf-cors =\\n    RuffleSWF\\n    CORSfetch\\n    Rufflewiki\\nerror-unknown =\\n    FlashRuffle\\n    { $outdated ->\\n        [true] Ruffle(: { $buildDate })\\n       *[false] !\\n    }\\n\",\n    \"save-manager.ftl\": \"save-delete-prompt = ?\\nsave-reload-prompt =\\n     { $action ->\\n        [delete] \\n       *[replace] \\n    } \\nsave-download = \\nsave-replace = \\nsave-delete = \\nsave-backup-all = (sols)\\n\"\n  },\n  \"ko-KR\": {\n    \"context_menu.ftl\": \"context-menu-download-swf = .swf \\ncontext-menu-copy-debug-info =   \\ncontext-menu-open-save-manager =   \\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension] Ruffle    ({ $version })\\n       *[other] Ruffle  ({ $version })\\n    }\\ncontext-menu-hide =   \\ncontext-menu-exit-fullscreen =  \\ncontext-menu-enter-fullscreen =  \\n\",\n    \"messages.ftl\": \"message-unsupported-avm2 = Ruffle   3         .        .\\nmessage-cant-embed = Ruffle       .         .\\npanic-title =   :(\\nmore-info =  \\nrun-anyway =  \\ncontinue = \\nreport-bug =  \\nupdate-ruffle = Ruffle \\nruffle-demo =  \\nruffle-desktop =  \\nruffle-wiki = Ruffle  \\nview-error-details =    \\nopen-in-new-tab =   \\nclick-to-unmute =   \\nerror-file-protocol =\\n    Ruffle \\\"file:\\\"     .\\n                 .\\n    ,            .\\nerror-javascript-config =\\n        Ruffle   .\\n        ,       .\\n     Ruffle       .\\nerror-wasm-not-found =\\n    Ruffle \\\".wasm\\\"     .\\n           .\\n      \\\"publicPath\\\"     : Ruffle    .\\nerror-wasm-mime-type =\\n    Ruffle      .\\n        MIME  \\\".wasm\\\"   .\\n        Ruffle    .\\nerror-swf-fetch =\\n    Ruffle  SWF    .\\n           Ruffle       .\\n        .\\nerror-swf-cors =\\n    Ruffle  SWF    .\\n    CORS         .\\n        Ruffle      .\\nerror-wasm-cors =\\n    Ruffle \\\".wasm\\\"     .\\n    CORS         .\\n        Ruffle      .\\nerror-wasm-invalid =\\n    Ruffle      .\\n      Ruffle       .\\n        Ruffle      .\\nerror-wasm-download =\\n    Ruffle      .\\n              .\\n      ,   .\\nerror-wasm-disabled-on-edge =\\n    Ruffle \\\".wasm\\\"     .\\n        \\\" ,   \\\"  ,   \\\"  \\\"   .\\n      \\\".wasm\\\"      .\\n             .\\nerror-javascript-conflict =\\n    Ruffle      .\\n         Ruffle   .\\n           .\\nerror-javascript-conflict-outdated =  Ruffle         . (  : { $buildDate }).\\nerror-csp-conflict =\\n    Ruffle      .\\n       CSP(Content Security Policy)  \\\".wasm\\\"      .\\n        Ruffle      .\\nerror-unknown =\\n    Ruffle        .\\n    { $outdated ->\\n        [true]    , Ruffle     . (  : { $buildDate }).\\n       *[false]    ,   !\\n    }\\n\",\n    \"save-manager.ftl\": \"save-delete-prompt =     ?\\nsave-reload-prompt =\\n    \\b     { $action ->\\n        [delete] \\n       *[replace] \\n    }    .  ?\\nsave-download = \\nsave-replace = \\nsave-delete = \\nsave-backup-all =     ( sol )\\n\"\n  },\n  \"nl-NL\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"pt-PT\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"ro-RO\": {\n    \"context_menu.ftl\": \"context-menu-download-swf = Descarc .swf\\ncontext-menu-copy-debug-info = Copiai informaiile de depanare\\ncontext-menu-open-save-manager = Deschide manager de salvri\\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension] Despre extensia Ruffle ({ $version })\\n       *[other] Despre Ruffle ({ $version })\\n    }\\ncontext-menu-hide = Ascunde acest meniu\\ncontext-menu-exit-fullscreen = Ieii din ecranul complet\\ncontext-menu-enter-fullscreen = Intr n ecran complet\\n\",\n    \"messages.ftl\": \"message-unsupported-avm2 =\\n    Emulatorul Ruffle poate s nu accepte nc pe deplin tot ActionScript 3 folosit de acest coninut.\\n    Este posibil ca unele pri ale coninutului s nu funcioneze conform ateptrilor.\\nmessage-cant-embed =\\n    Ruffle nu a putut rula Flash ncorporat n aceast pagin.\\n    Putei ncerca s deschidei fiierul ntr-o fil separat, pentru a evita aceast problem.\\npanic-title = Ceva a mers prost :(\\nmore-info = Mai multe informatii\\nrun-anyway = Ruleaz oricum\\ncontinue = Continuare\\nreport-bug = Raporteaz o eroare\\nupdate-ruffle = Actualizeaz\\nruffle-demo = Demo Web\\nruffle-desktop = Aplicaie desktop\\nruffle-wiki = Vezi Ruffle Wiki\\nview-error-details = Vezi detaliile de eroare\\nopen-in-new-tab = Deschidere in fil nou\\nclick-to-unmute = nltur amuirea\\nerror-file-protocol =\\n    Se pare c rulai Ruffle pe protocolul \\\"fiier:\\\".\\n    Aceasta nu funcioneaz ca browsere blocheaz multe caracteristici din motive de securitate.\\n    n schimb, v invitm s configurai un server local sau s folosii aplicaia web demo sau desktop.\\nerror-javascript-config =\\n    Ruffle a ntmpinat o problem major din cauza unei configurri incorecte a JavaScript.\\n    Dac suntei administratorul serverului, v invitm s verificai detaliile de eroare pentru a afla care parametru este defect.\\n    Putei consulta i Ruffle wiki pentru ajutor.\\nerror-wasm-not-found =\\n    Ruffle a euat la ncrcarea componentei de fiier \\\".wasm\\\".\\n    Dac suntei administratorul serverului, v rugm s v asigurai c fiierul a fost ncrcat corect.\\n    Dac problema persist, poate fi necesar s utilizai setarea \\\"publicPath\\\": v rugm s consultai Ruffle wiki pentru ajutor.\\nerror-wasm-mime-type =\\n    Ruffle a ntmpinat o problem major n timp ce se ncerca iniializarea.\\n    Acest server web nu servete \\\". asm\\\" fiiere cu tipul corect MIME.\\n    Dac suntei administrator de server, v rugm s consultai Ruffle wiki pentru ajutor.\\nerror-swf-fetch =\\n    Ruffle a euat la ncrcarea fiierului Flash SWF.\\n    Motivul cel mai probabil este c fiierul nu mai exist, deci nu exist nimic pentru Ruffle s se ncarce.\\n    ncercai s contactai administratorul site-ului web pentru ajutor.\\nerror-swf-cors =\\n    Ruffle a euat la ncrcarea fiierului Flash SWF.\\n    Accesul la preluare a fost probabil blocat de politica CORS.\\n    Dac suntei administratorul serverului, v rugm s consultai Ruffle wiki pentru ajutor.\\nerror-wasm-cors =\\n    Ruffle a euat n ncrcarea componentei de fiier \\\".wasm\\\".\\n    Accesul la preluare a fost probabil blocat de politica CORS.\\n    Dac suntei administratorul serverului, v rugm s consultai Ruffle wiki pentru ajutor.\\nerror-wasm-invalid =\\n    Ruffle a ntmpinat o problem major n timp ce se ncearc iniializarea.\\n    Se pare c aceast pagin are fiiere lips sau invalide pentru rularea Ruffle.\\n    Dac suntei administratorul serverului, v rugm s consultai Ruffle wiki pentru ajutor.\\nerror-wasm-download =\\n    Ruffle a ntmpinat o problem major n timp ce ncerca s iniializeze.\\n    Acest lucru se poate rezolva adesea, astfel nct putei ncerca s rencrcai pagina.\\n    Altfel, v rugm s contactai administratorul site-ului.\\nerror-wasm-disabled-on-edge =\\n    Ruffle nu a putut ncrca componenta de fiier \\\".wasm\\\".\\n    Pentru a remedia acest lucru, ncercai s deschidei setrile browser-ului dvs., apsnd pe \\\"Confidenialitate, cutare i servicii\\\", derulnd n jos i nchiznd \\\"mbuntete-i securitatea pe web\\\".\\n    Acest lucru va permite browser-ului s ncarce fiierele \\\".wasm\\\" necesare.\\n    Dac problema persist, ar putea fi necesar s folosii un browser diferit.\\nerror-javascript-conflict =\\n    Ruffle a ntmpinat o problem major n timp ce ncerca s iniializeze.\\n    Se pare c aceast pagin folosete codul JavaScript care intr n conflict cu Ruffle.\\n    Dac suntei administratorul serverului, v invitm s ncrcai fiierul pe o pagin goal.\\nerror-javascript-conflict-outdated = De asemenea, poi ncerca s ncarci o versiune mai recent de Ruffle care poate ocoli problema (versiunea curent este expirat: { $buildDate }).\\nerror-csp-conflict =\\n    Ruffle a ntmpinat o problem major n timp ce se ncerca iniializarea.\\n    Politica de securitate a coninutului acestui server web nu permite serviciul necesar\\\". asm\\\" component pentru a rula.\\n    Dac suntei administratorul de server, consultai Ruffle wiki pentru ajutor.\\nerror-unknown =\\n    Ruffle a ntmpinat o problem major n timp ce se ncerca afiarea coninutului Flash.\\n    { $outdated ->\\n        [true] Dac suntei administratorul de server, v rugm s ncercai s ncrcai o versiune mai recent de Ruffle (versiunea curent este depit: { $buildDate }).\\n       *[false] Acest lucru nu ar trebui s se ntmple, aa c am aprecia foarte mult dac ai putea trimite un bug!\\n    }\\n\",\n    \"save-manager.ftl\": \"save-delete-prompt = Suntei sigur c dorii s tergei acest fiier salvat?\\nsave-reload-prompt =\\n    Singura cale de a { $action ->\\n        [delete] terge\\n       *[replace] nlocuiete\\n    } acest fiier de salvare fr un conflict potenial este de a rencrca acest coninut. Dorii s continuai oricum?\\nsave-download = Descrcare\\nsave-replace = nlocuiete\\nsave-delete = tergere\\nsave-backup-all = Copie de rezerv toate salvrile (descarc toate sols?)\\n\"\n  },\n  \"ru-RU\": {\n    \"context_menu.ftl\": \"context-menu-download-swf =  .swf\\ncontext-menu-copy-debug-info =   \\ncontext-menu-open-save-manager =  \\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension]   Ruffle ({ $version })\\n       *[other]  Ruffle ({ $version })\\n    }\\ncontext-menu-hide =   \\ncontext-menu-exit-fullscreen =  \\ncontext-menu-enter-fullscreen =  \\n\",\n    \"messages.ftl\": \"message-unsupported-avm2 =\\n     Ruffle     ActionScript 3,    .\\n            .\\nmessage-cant-embed =\\n    Ruffle    Flash,    .\\n       ,        .\\npanic-title = -    :(\\nmore-info = \\nrun-anyway =   \\ncontinue = \\nreport-bug =   \\nupdate-ruffle =  Ruffle\\nruffle-demo = -\\nruffle-desktop =  \\nruffle-wiki =   Ruffle\\nview-error-details =   \\nopen-in-new-tab =    \\nclick-to-unmute =  \\nerror-file-protocol =\\n    ,    Ruffle   \\\"file:\\\".\\n      ,         .\\n           , -    .\\nerror-javascript-config =\\n       -   JavaScript.\\n        ,      ,  ,    .\\n            Ruffle.\\nerror-wasm-not-found =\\n    Ruffle       \\\".wasm\\\".\\n       , , ,     .\\n       ,      \\\"publicPath\\\":    Ruffle.\\nerror-wasm-mime-type =\\n    Ruffle       .\\n     -    \\\".wasm\\\"    MIME.\\n       ,      Ruffle.\\nerror-swf-fetch =\\n    Ruffle    SWF- Flash.\\n     ,    ,  Ruffle  .\\n           .\\nerror-swf-cors =\\n    Ruffle    SWF- Flash.\\n     ,       CORS.\\n       ,      Ruffle.\\nerror-wasm-cors =\\n    Ruffle       \\\".wasm\\\".\\n     ,       CORS.\\n       ,      Ruffle.\\nerror-wasm-invalid =\\n    Ruffle       .\\n    ,         Ruffle   .\\n       ,      Ruffle.\\nerror-wasm-download =\\n    Ruffle       .\\n          ,      .\\n       ,    .\\nerror-wasm-disabled-on-edge =\\n    Ruffle       \\\".wasm\\\".\\n       ,       .      WASM-.\\n      ,     .\\nerror-javascript-conflict =\\n    Ruffle       .\\n    ,       Ruffle  JavaScript.\\n        ,         .\\nerror-javascript-conflict-outdated =        Ruffle,     (  : { $buildDate }).\\nerror-csp-conflict =\\n    Ruffle       .\\n        -        \\\".wasm\\\".\\n        ,      Ruffle.\\nerror-unknown =\\n    Ruffle         Flash-.\\n    { $outdated ->\\n        [true]    ,      Ruffle (  : { $buildDate }).\\n       *[false]    ,     ,      !\\n    }\\n\",\n    \"save-manager.ftl\": \"save-delete-prompt =    ?\\nsave-reload-prompt =\\n      { $action ->\\n        [delete] \\n       *[replace] \\n    }          .   ?\\nsave-download = \\nsave-replace = \\nsave-delete = \\nsave-backup-all =   \\n\"\n  },\n  \"sv-SE\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"tr-TR\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"zh-CN\": {\n    \"context_menu.ftl\": \"\",\n    \"messages.ftl\": \"\",\n    \"save-manager.ftl\": \"\"\n  },\n  \"zh-TW\": {\n    \"context_menu.ftl\": \"context-menu-download-swf = SWF\\ncontext-menu-copy-debug-info = \\ncontext-menu-open-save-manager = \\ncontext-menu-about-ruffle =\\n    { $flavor ->\\n        [extension] Ruffle ({ $version })\\n       *[other] Ruffle ({ $version })\\n    }\\ncontext-menu-hide = \\ncontext-menu-exit-fullscreen = \\ncontext-menu-enter-fullscreen = \\n\",\n    \"messages.ftl\": \"message-unsupported-avm2 =\\n    RuffleActionScript 3\\n    \\nmessage-cant-embed =\\n    RuffleFlash\\n    \\npanic-title =  :(\\nmore-info = \\nrun-anyway = \\ncontinue = \\nreport-bug = BUG\\nupdate-ruffle = Ruffle\\nruffle-demo = \\nruffle-desktop = \\nruffle-wiki = Ruffle Wiki\\nview-error-details = \\nopen-in-new-tab = \\nclick-to-unmute = \\nerror-file-protocol =\\n    Ruffle\\\"file:\\\"\\n    \\n    \\nerror-javascript-config =\\n    RuffleJavaScript\\n    \\n    Ruffle wiki\\nerror-wasm-not-found =\\n    Ruffle\\\".wasm\\\"\\n    \\n    \\\"publicPath\\\": Ruffle wiki\\n\",\n    \"save-manager.ftl\": \"\"\n  }\n};\nconst bundles = {};\nfor (const locale in BUNDLED_TEXTS) {\n    const bundle = new FluentBundle(locale);\n    const files = BUNDLED_TEXTS[locale];\n    if (files) {\n        for (const filename in files) {\n            const text = files[filename];\n            if (text) {\n                for (const error in bundle.addResource(new FluentResource(text))) {\n                    console.error(`Error in text for ${locale} ${filename}: ${error}`);\n                }\n            }\n        }\n    }\n    bundles[locale] = bundle;\n}\n/**\n * Gets the localised text for the given locale and text ID.\n *\n * If the locale does not contain a text for this ID, it will return null.\n *\n * @param locale Locale to prefer when retrieving text, ie \"en-US\"\n * @param id ID of the text to retrieve\n * @param args Any arguments to use when creating the localised text\n * @returns Localised text or null if not found\n */\nfunction tryText(locale, id, args) {\n    const bundle = bundles[locale];\n    if (bundle !== undefined) {\n        const message = bundle.getMessage(id);\n        if (message !== undefined && message.value) {\n            return bundle.formatPattern(message.value, args);\n        }\n    }\n    return null;\n}\n/**\n * Gets the localised text for the given text ID.\n *\n * The users preferred locales are used, in priority order, to find the given text.\n *\n * If no text is found for any preferred locale, en-US will be used.\n * If en-US does not contain a text for this ID, an error will be logged and the ID itself will be returned.\n *\n * @param id ID of the text to retrieve\n * @param args Any arguments to use when creating the localised text\n * @returns Localised text\n */\nexport function text(id, args) {\n    const locales = negotiateLanguages(navigator.languages, Object.keys(bundles), { defaultLocale: \"en-US\" });\n    for (const i in locales) {\n        const result = tryText(locales[i], id, args);\n        if (result) {\n            return result;\n        }\n    }\n    console.error(`Unknown text key '${id}'`);\n    return id;\n}\n/**\n * Gets the localised text for the given text ID, as <p>paragraphs</p> and HTML entities safely encoded.\n *\n * The users preferred locales are used, in priority order, to find the given text.\n *\n * If no text is found for any preferred locale, en-US will be used.\n * If en-US does not contain a text for this ID, an error will be logged and the ID itself will be returned.\n *\n * @param id ID of the text to retrieve\n * @param args Any arguments to use when creating the localised text\n * @returns Localised text with each line in a Paragraph element\n */\nexport function textAsParagraphs(id, args) {\n    const result = document.createElement(\"div\");\n    text(id, args)\n        .split(\"\\n\")\n        .forEach((line) => {\n        const p = document.createElement(\"p\");\n        p.innerText = line;\n        result.appendChild(p);\n    });\n    return result.innerHTML;\n}\n","import { filterMatches } from \"./matches.js\";\n/**\n * Negotiates the languages between the list of requested locales against\n * a list of available locales.\n *\n * It accepts three arguments:\n *\n *   requestedLocales:\n *     an Array of strings with BCP47 locale IDs sorted\n *     according to user preferences.\n *\n *   availableLocales:\n *     an Array of strings with BCP47 locale IDs of locale for which\n *     resources are available. Unsorted.\n *\n *   options:\n *     An object with the following, optional keys:\n *\n *       strategy: 'filtering' (default) | 'matching' | 'lookup'\n *\n *       defaultLocale:\n *         a string with BCP47 locale ID to be used\n *         as a last resort locale.\n *\n *\n * It returns an Array of strings with BCP47 locale IDs sorted according to the\n * user preferences.\n *\n * The exact list will be selected differently depending on the strategy:\n *\n *   'filtering': (default)\n *     In the filtering strategy, the algorithm will attempt to match\n *     as many keys in the available locales in order of the requested locales.\n *\n *   'matching':\n *     In the matching strategy, the algorithm will attempt to find the\n *     best possible match for each element of the requestedLocales list.\n *\n *   'lookup':\n *     In the lookup strategy, the algorithm will attempt to find a single\n *     best available locale based on the requested locales list.\n *\n *     This strategy requires defaultLocale option to be set.\n */\nexport function negotiateLanguages(requestedLocales, availableLocales, { strategy = \"filtering\", defaultLocale } = {}) {\n    const supportedLocales = filterMatches(Array.from(requestedLocales !== null && requestedLocales !== void 0 ? requestedLocales : []).map(String), Array.from(availableLocales !== null && availableLocales !== void 0 ? availableLocales : []).map(String), strategy);\n    if (strategy === \"lookup\") {\n        if (defaultLocale === undefined) {\n            throw new Error(\"defaultLocale cannot be undefined for strategy `lookup`\");\n        }\n        if (supportedLocales.length === 0) {\n            supportedLocales.push(defaultLocale);\n        }\n    }\n    else if (defaultLocale && !supportedLocales.includes(defaultLocale)) {\n        supportedLocales.push(defaultLocale);\n    }\n    return supportedLocales;\n}\n","/* eslint no-magic-numbers: 0 */\nimport { Locale } from \"./locale.js\";\n/**\n * Negotiates the languages between the list of requested locales against\n * a list of available locales.\n *\n * The algorithm is based on the BCP4647 3.3.2 Extended Filtering algorithm,\n * with several modifications:\n *\n *  1) available locales are treated as ranges\n *\n *    This change allows us to match a more specific request against\n *    more generic available locale.\n *\n *    For example, if the available locale list provides locale `en`,\n *    and the requested locale is `en-US`, we treat the available locale as\n *    a locale that matches all possible english requests.\n *\n *    This means that we expect available locale ID to be as precize as\n *    the matches they want to cover.\n *\n *    For example, if there is only `sr` available, it's ok to list\n *    it in available locales. But once the available locales has both,\n *    Cyrl and Latn variants, the locale IDs should be `sr-Cyrl` and `sr-Latn`\n *    to avoid any `sr-*` request to match against whole `sr` range.\n *\n *    What it does ([requested] * [available] = [supported]):\n *\n *    ['en-US'] * ['en'] = ['en']\n *\n *  2) likely subtags from LDML 4.3 Likely Subtags has been added\n *\n *    The most obvious likely subtag that can be computed is a duplication\n *    of the language field onto region field (`fr` => `fr-FR`).\n *\n *    On top of that, likely subtags may use a list of mappings, that\n *    allow the algorithm to handle non-obvious matches.\n *    For example, making sure that we match `en` to `en-US` or `sr` to\n *    `sr-Cyrl`, while `sr-RU` to `sr-Latn-RU`.\n *\n *    This list can be taken directly from CLDR Supplemental Data.\n *\n *    What it does ([requested] * [available] = [supported]):\n *\n *    ['fr'] * ['fr-FR'] = ['fr-FR']\n *    ['en'] * ['en-US'] = ['en-US']\n *    ['sr'] * ['sr-Latn', 'sr-Cyrl'] = ['sr-Cyrl']\n *\n *  3) variant/region range check has been added\n *\n *    Lastly, the last form of check is against the requested locale ID\n *    but with the variant/region field replaced with a `*` range.\n *\n *    The rationale here laid out in LDML 4.4 Language Matching:\n *      \"(...) normally the fall-off between the user's languages is\n *      substantially greated than regional variants.\"\n *\n *    In other words, if we can't match for the given region, maybe\n *    we can match for the same language/script but other region, and\n *    it will in most cases be preferred over falling back on the next\n *    language.\n *\n *    What it does ([requested] * [available] = [supported]):\n *\n *    ['en-AU'] * ['en-US'] = ['en-US']\n *    ['sr-RU'] * ['sr-Latn-RO'] = ['sr-Latn-RO'] // sr-RU -> sr-Latn-RU\n *\n *    It works similarly to getParentLocales algo, except that we stop\n *    after matching against variant/region ranges and don't try to match\n *    ignoring script ranges. That means that `sr-Cyrl` will never match\n *    against `sr-Latn`.\n */\nexport function filterMatches(requestedLocales, availableLocales, strategy) {\n    const supportedLocales = new Set();\n    const availableLocalesMap = new Map();\n    for (let locale of availableLocales) {\n        let newLocale = new Locale(locale);\n        if (newLocale.isWellFormed) {\n            availableLocalesMap.set(locale, new Locale(locale));\n        }\n    }\n    outer: for (const reqLocStr of requestedLocales) {\n        const reqLocStrLC = reqLocStr.toLowerCase();\n        const requestedLocale = new Locale(reqLocStrLC);\n        if (requestedLocale.language === undefined) {\n            continue;\n        }\n        // 1) Attempt to make an exact match\n        // Example: `en-US` === `en-US`\n        for (const key of availableLocalesMap.keys()) {\n            if (reqLocStrLC === key.toLowerCase()) {\n                supportedLocales.add(key);\n                availableLocalesMap.delete(key);\n                if (strategy === \"lookup\") {\n                    return Array.from(supportedLocales);\n                }\n                else if (strategy === \"filtering\") {\n                    continue;\n                }\n                else {\n                    continue outer;\n                }\n            }\n        }\n        // 2) Attempt to match against the available range\n        // This turns `en` into `en-*-*-*` and `en-US` into `en-*-US-*`\n        // Example: ['en-US'] * ['en'] = ['en']\n        for (const [key, availableLocale] of availableLocalesMap.entries()) {\n            if (availableLocale.matches(requestedLocale, true, false)) {\n                supportedLocales.add(key);\n                availableLocalesMap.delete(key);\n                if (strategy === \"lookup\") {\n                    return Array.from(supportedLocales);\n                }\n                else if (strategy === \"filtering\") {\n                    continue;\n                }\n                else {\n                    continue outer;\n                }\n            }\n        }\n        // 3) Attempt to retrieve a maximal version of the requested locale ID\n        // If data is available, it'll expand `en` into `en-Latn-US` and\n        // `zh` into `zh-Hans-CN`.\n        // Example: ['en'] * ['en-GB', 'en-US'] = ['en-US']\n        if (requestedLocale.addLikelySubtags()) {\n            for (const [key, availableLocale] of availableLocalesMap.entries()) {\n                if (availableLocale.matches(requestedLocale, true, false)) {\n                    supportedLocales.add(key);\n                    availableLocalesMap.delete(key);\n                    if (strategy === \"lookup\") {\n                        return Array.from(supportedLocales);\n                    }\n                    else if (strategy === \"filtering\") {\n                        continue;\n                    }\n                    else {\n                        continue outer;\n                    }\n                }\n            }\n        }\n        // 4) Attempt to look up for a different variant for the same locale ID\n        // Example: ['en-US-mac'] * ['en-US-win'] = ['en-US-win']\n        requestedLocale.clearVariants();\n        for (const [key, availableLocale] of availableLocalesMap.entries()) {\n            if (availableLocale.matches(requestedLocale, true, true)) {\n                supportedLocales.add(key);\n                availableLocalesMap.delete(key);\n                if (strategy === \"lookup\") {\n                    return Array.from(supportedLocales);\n                }\n                else if (strategy === \"filtering\") {\n                    continue;\n                }\n                else {\n                    continue outer;\n                }\n            }\n        }\n        // 5) Attempt to match against the likely subtag without region\n        // In the example below, addLikelySubtags will turn\n        // `zh-Hant` into `zh-Hant-TW` giving `zh-TW` priority match\n        // over `zh-CN`.\n        //\n        // Example: ['zh-Hant-HK'] * ['zh-TW', 'zh-CN'] = ['zh-TW']\n        requestedLocale.clearRegion();\n        if (requestedLocale.addLikelySubtags()) {\n            for (const [key, availableLocale] of availableLocalesMap.entries()) {\n                if (availableLocale.matches(requestedLocale, true, false)) {\n                    supportedLocales.add(key);\n                    availableLocalesMap.delete(key);\n                    if (strategy === \"lookup\") {\n                        return Array.from(supportedLocales);\n                    }\n                    else if (strategy === \"filtering\") {\n                        continue;\n                    }\n                    else {\n                        continue outer;\n                    }\n                }\n            }\n        }\n        // 6) Attempt to look up for a different region for the same locale ID\n        // Example: ['en-US'] * ['en-AU'] = ['en-AU']\n        requestedLocale.clearRegion();\n        for (const [key, availableLocale] of availableLocalesMap.entries()) {\n            if (availableLocale.matches(requestedLocale, true, true)) {\n                supportedLocales.add(key);\n                availableLocalesMap.delete(key);\n                if (strategy === \"lookup\") {\n                    return Array.from(supportedLocales);\n                }\n                else if (strategy === \"filtering\") {\n                    continue;\n                }\n                else {\n                    continue outer;\n                }\n            }\n        }\n    }\n    return Array.from(supportedLocales);\n}\n","import { loadRuffle } from \"./load-ruffle\";\nimport { ruffleShadowTemplate } from \"./shadow-template\";\nimport { lookupElement } from \"./register-element\";\nimport { DEFAULT_CONFIG } from \"./config\";\nimport { swfFileName } from \"./swf-utils\";\nimport { buildInfo } from \"./build-info\";\nimport { text, textAsParagraphs } from \"./i18n\";\nconst RUFFLE_ORIGIN = \"https://ruffle.rs\";\nconst DIMENSION_REGEX = /^\\s*(\\d+(\\.\\d+)?(%)?)/;\nlet isAudioContextUnmuted = false;\n/**\n * Converts arbitrary input to an easy to use record object.\n *\n * @param parameters Parameters to sanitize\n * @returns A sanitized map of param name to param value\n */\nfunction sanitizeParameters(parameters) {\n    if (parameters === null || parameters === undefined) {\n        return {};\n    }\n    if (!(parameters instanceof URLSearchParams)) {\n        parameters = new URLSearchParams(parameters);\n    }\n    const output = {};\n    for (const [key, value] of parameters) {\n        // Every value must be type of string\n        output[key] = value.toString();\n    }\n    return output;\n}\nclass Point {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    distanceTo(other) {\n        const dx = other.x - this.x;\n        const dy = other.y - this.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n}\n/**\n * The ruffle player element that should be inserted onto the page.\n *\n * This element will represent the rendered and intractable flash movie.\n */\nclass RufflePlayer extends HTMLElement {\n    /**\n     * Indicates the readiness of the playing movie.\n     *\n     * @returns The `ReadyState` of the player.\n     */\n    get readyState() {\n        return this._readyState;\n    }\n    /**\n     * The metadata of the playing movie (such as movie width and height).\n     * These are inherent properties stored in the SWF file and are not affected by runtime changes.\n     * For example, `metadata.width` is the width of the SWF file, and not the width of the Ruffle player.\n     *\n     * @returns The metadata of the movie, or `null` if the movie metadata has not yet loaded.\n     */\n    get metadata() {\n        return this._metadata;\n    }\n    /**\n     * Constructs a new Ruffle flash player for insertion onto the page.\n     */\n    constructor() {\n        super();\n        // Allows the user to permanently disable the context menu.\n        this.contextMenuForceDisabled = false;\n        // Whether this device is a touch device.\n        // Set to true when a touch event is encountered.\n        this.isTouch = false;\n        // Whether this device sends contextmenu events.\n        // Set to true when a contextmenu event is seen.\n        this.contextMenuSupported = false;\n        this.panicked = false;\n        this._cachedDebugInfo = null;\n        this.isExtension = false;\n        this.longPressTimer = null;\n        this.pointerDownPosition = null;\n        this.pointerMoveMaxDistance = 0;\n        /**\n         * Any configuration that should apply to this specific player.\n         * This will be defaulted with any global configuration.\n         */\n        this.config = {};\n        this.shadow = this.attachShadow({ mode: \"open\" });\n        this.shadow.appendChild(ruffleShadowTemplate.content.cloneNode(true));\n        this.dynamicStyles = (this.shadow.getElementById(\"dynamic_styles\"));\n        this.container = this.shadow.getElementById(\"container\");\n        this.playButton = this.shadow.getElementById(\"play_button\");\n        this.playButton.addEventListener(\"click\", () => this.play());\n        this.unmuteOverlay = this.shadow.getElementById(\"unmute_overlay\");\n        this.splashScreen = this.shadow.getElementById(\"splash-screen\");\n        this.virtualKeyboard = (this.shadow.getElementById(\"virtual-keyboard\"));\n        this.virtualKeyboard.addEventListener(\"input\", this.virtualKeyboardInput.bind(this));\n        this.saveManager = (this.shadow.getElementById(\"save-manager\"));\n        this.saveManager.addEventListener(\"click\", () => this.saveManager.classList.add(\"hidden\"));\n        const modalArea = this.saveManager.querySelector(\"#modal-area\");\n        if (modalArea) {\n            modalArea.addEventListener(\"click\", (event) => event.stopPropagation());\n        }\n        const closeSaveManager = this.saveManager.querySelector(\"#close-modal\");\n        if (closeSaveManager) {\n            closeSaveManager.addEventListener(\"click\", () => this.saveManager.classList.add(\"hidden\"));\n        }\n        const backupSaves = (this.saveManager.querySelector(\"#backup-saves\"));\n        if (backupSaves) {\n            backupSaves.addEventListener(\"click\", this.backupSaves.bind(this));\n            backupSaves.innerText = text(\"save-backup-all\");\n        }\n        const unmuteSvg = (this.unmuteOverlay.querySelector(\"#unmute_overlay_svg\"));\n        if (unmuteSvg) {\n            const unmuteText = (unmuteSvg.querySelector(\"#unmute_text\"));\n            unmuteText.textContent = text(\"click-to-unmute\");\n        }\n        this.contextMenuElement = this.shadow.getElementById(\"context-menu\");\n        window.addEventListener(\"pointerdown\", this.checkIfTouch.bind(this));\n        this.addEventListener(\"contextmenu\", this.showContextMenu.bind(this));\n        this.container.addEventListener(\"pointerdown\", this.pointerDown.bind(this));\n        this.container.addEventListener(\"pointermove\", this.checkLongPressMovement.bind(this));\n        this.container.addEventListener(\"pointerup\", this.checkLongPress.bind(this));\n        this.container.addEventListener(\"pointercancel\", this.clearLongPressTimer.bind(this));\n        this.addEventListener(\"fullscreenchange\", this.fullScreenChange.bind(this));\n        this.addEventListener(\"webkitfullscreenchange\", this.fullScreenChange.bind(this));\n        this.instance = null;\n        this.onFSCommand = null;\n        this._readyState = 0 /* ReadyState.HaveNothing */;\n        this._metadata = null;\n        this.lastActivePlayingState = false;\n        this.setupPauseOnTabHidden();\n    }\n    /**\n     * Setup event listener to detect when tab is not active to pause instance playback.\n     * this.instance.play() is called when the tab becomes visible only if the\n     * the instance was not paused before tab became hidden.\n     *\n     * See: https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API\n     * @ignore\n     * @internal\n     */\n    setupPauseOnTabHidden() {\n        document.addEventListener(\"visibilitychange\", () => {\n            if (!this.instance) {\n                return;\n            }\n            // Tab just changed to be inactive. Record whether instance was playing.\n            if (document.hidden) {\n                this.lastActivePlayingState = this.instance.is_playing();\n                this.instance.pause();\n            }\n            // Play only if instance was playing originally.\n            if (!document.hidden && this.lastActivePlayingState === true) {\n                this.instance.play();\n            }\n        }, false);\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    connectedCallback() {\n        this.updateStyles();\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    static get observedAttributes() {\n        return [\"width\", \"height\"];\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    attributeChangedCallback(name, _oldValue, _newValue) {\n        if (name === \"width\" || name === \"height\") {\n            this.updateStyles();\n        }\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    disconnectedCallback() {\n        this.destroy();\n    }\n    /**\n     * Updates the internal shadow DOM to reflect any set attributes from\n     * this element.\n     */\n    updateStyles() {\n        if (this.dynamicStyles.sheet) {\n            if (this.dynamicStyles.sheet.rules) {\n                for (let i = 0; i < this.dynamicStyles.sheet.rules.length; i++) {\n                    this.dynamicStyles.sheet.deleteRule(i);\n                }\n            }\n            const widthAttr = this.attributes.getNamedItem(\"width\");\n            if (widthAttr !== undefined && widthAttr !== null) {\n                const width = RufflePlayer.htmlDimensionToCssDimension(widthAttr.value);\n                if (width !== null) {\n                    this.dynamicStyles.sheet.insertRule(`:host { width: ${width}; }`);\n                }\n            }\n            const heightAttr = this.attributes.getNamedItem(\"height\");\n            if (heightAttr !== undefined && heightAttr !== null) {\n                const height = RufflePlayer.htmlDimensionToCssDimension(heightAttr.value);\n                if (height !== null) {\n                    this.dynamicStyles.sheet.insertRule(`:host { height: ${height}; }`);\n                }\n            }\n        }\n    }\n    /**\n     * Determine if this element is the fallback content of another Ruffle\n     * player.\n     *\n     * This heuristic assumes Ruffle objects will never use their fallback\n     * content. If this changes, then this code also needs to change.\n     *\n     * @private\n     */\n    isUnusedFallbackObject() {\n        const element = lookupElement(\"ruffle-object\");\n        if (element !== null) {\n            let parent = this.parentNode;\n            while (parent !== document && parent !== null) {\n                if (parent.nodeName === element.name) {\n                    return true;\n                }\n                parent = parent.parentNode;\n            }\n        }\n        return false;\n    }\n    /**\n     * Ensure a fresh Ruffle instance is ready on this player before continuing.\n     *\n     * @throws Any exceptions generated by loading Ruffle Core will be logged\n     * and passed on.\n     *\n     * @private\n     */\n    async ensureFreshInstance() {\n        var _a;\n        this.destroy();\n        if (this.loadedConfig &&\n            this.loadedConfig.splashScreen !== false &&\n            this.loadedConfig.preloader !== false) {\n            this.showSplashScreen();\n        }\n        if (this.loadedConfig && this.loadedConfig.preloader === false) {\n            console.warn(\"The configuration option preloader has been replaced with splashScreen. If you own this website, please update the configuration.\");\n        }\n        if (this.loadedConfig &&\n            this.loadedConfig.maxExecutionDuration &&\n            typeof this.loadedConfig.maxExecutionDuration !== \"number\") {\n            console.warn(\"Configuration: An obsolete format for duration for 'maxExecutionDuration' was used, \" +\n                \"please use a single number indicating seconds instead. For instance '15' instead of \" +\n                \"'{secs: 15, nanos: 0}'.\");\n        }\n        if (this.loadedConfig &&\n            typeof this.loadedConfig.contextMenu === \"boolean\") {\n            console.warn('The configuration option contextMenu no longer takes a boolean. Use \"on\", \"off\", or \"rightClickOnly\".');\n        }\n        const ruffleConstructor = await loadRuffle(this.loadedConfig || {}, this.onRuffleDownloadProgress.bind(this)).catch((e) => {\n            console.error(`Serious error loading Ruffle: ${e}`);\n            // Serious duck typing. In error conditions, let's not make assumptions.\n            if (window.location.protocol === \"file:\") {\n                e.ruffleIndexError = 2 /* PanicError.FileProtocol */;\n            }\n            else {\n                e.ruffleIndexError = 9 /* PanicError.WasmNotFound */;\n                const message = String(e.message).toLowerCase();\n                if (message.includes(\"mime\")) {\n                    e.ruffleIndexError = 8 /* PanicError.WasmMimeType */;\n                }\n                else if (message.includes(\"networkerror\") ||\n                    message.includes(\"failed to fetch\")) {\n                    e.ruffleIndexError = 6 /* PanicError.WasmCors */;\n                }\n                else if (message.includes(\"disallowed by embedder\")) {\n                    e.ruffleIndexError = 1 /* PanicError.CSPConflict */;\n                }\n                else if (e.name === \"CompileError\") {\n                    e.ruffleIndexError = 3 /* PanicError.InvalidWasm */;\n                }\n                else if (message.includes(\"could not download wasm module\") &&\n                    e.name === \"TypeError\") {\n                    e.ruffleIndexError = 7 /* PanicError.WasmDownload */;\n                }\n                else if (e.name === \"TypeError\") {\n                    e.ruffleIndexError = 5 /* PanicError.JavascriptConflict */;\n                }\n                else if (navigator.userAgent.includes(\"Edg\") &&\n                    message.includes(\"webassembly is not defined\")) {\n                    // Microsoft Edge detection.\n                    e.ruffleIndexError = 10 /* PanicError.WasmDisabledMicrosoftEdge */;\n                }\n            }\n            this.panic(e);\n            throw e;\n        });\n        this.instance = await new ruffleConstructor(this.container, this, this.loadedConfig);\n        this._cachedDebugInfo = this.instance.renderer_debug_info();\n        const actuallyUsedRendererName = this.instance.renderer_name();\n        console.log(\"%c\" +\n            \"New Ruffle instance created (WebAssembly extensions: \" +\n            (ruffleConstructor.is_wasm_simd_used() ? \"ON\" : \"OFF\") +\n            \" | Used renderer: \" +\n            (actuallyUsedRendererName !== null && actuallyUsedRendererName !== void 0 ? actuallyUsedRendererName : \"\") +\n            \")\", \"background: #37528C; color: #FFAD33\");\n        // In Firefox, AudioContext.state is always \"suspended\" when the object has just been created.\n        // It may change by itself to \"running\" some milliseconds later. So we need to wait a little\n        // bit before checking if autoplay is supported and applying the instance config.\n        if (this.audioState() !== \"running\") {\n            this.container.style.visibility = \"hidden\";\n            await new Promise((resolve) => {\n                window.setTimeout(() => {\n                    resolve();\n                }, 200);\n            });\n            this.container.style.visibility = \"\";\n        }\n        this.unmuteAudioContext();\n        // On Android, the virtual keyboard needs to be dismissed as otherwise it re-focuses when clicking elsewhere\n        if (navigator.userAgent.toLowerCase().includes(\"android\")) {\n            this.container.addEventListener(\"click\", () => this.virtualKeyboard.blur());\n        }\n        // Treat invalid values as `AutoPlay.Auto`.\n        if (!this.loadedConfig ||\n            this.loadedConfig.autoplay === \"on\" /* AutoPlay.On */ ||\n            (this.loadedConfig.autoplay !== \"off\" /* AutoPlay.Off */ &&\n                this.audioState() === \"running\")) {\n            this.play();\n            if (this.audioState() !== \"running\") {\n                // Treat invalid values as `UnmuteOverlay.Visible`.\n                if (!this.loadedConfig ||\n                    this.loadedConfig.unmuteOverlay !== \"hidden\" /* UnmuteOverlay.Hidden */) {\n                    this.unmuteOverlay.style.display = \"block\";\n                }\n                this.container.addEventListener(\"click\", this.unmuteOverlayClicked.bind(this), {\n                    once: true,\n                });\n                const audioContext = (_a = this.instance) === null || _a === void 0 ? void 0 : _a.audio_context();\n                if (audioContext) {\n                    audioContext.onstatechange = () => {\n                        if (audioContext.state === \"running\") {\n                            this.unmuteOverlayClicked();\n                        }\n                        audioContext.onstatechange = null;\n                    };\n                }\n            }\n        }\n        else {\n            this.playButton.style.display = \"block\";\n        }\n    }\n    /**\n     * Uploads the splash screen progress bar.\n     *\n     * @param bytesLoaded The size of the Ruffle WebAssembly file downloaded so far.\n     * @param bytesTotal The total size of the Ruffle WebAssembly file.\n     */\n    onRuffleDownloadProgress(bytesLoaded, bytesTotal) {\n        const loadBar = (this.splashScreen.querySelector(\".loadbar-inner\"));\n        const outerLoadbar = (this.splashScreen.querySelector(\".loadbar\"));\n        if (Number.isNaN(bytesTotal)) {\n            if (outerLoadbar) {\n                outerLoadbar.style.display = \"none\";\n            }\n        }\n        else {\n            loadBar.style.width = `${100.0 * (bytesLoaded / bytesTotal)}%`;\n        }\n    }\n    /**\n     * Destroys the currently running instance of Ruffle.\n     */\n    destroy() {\n        if (this.instance) {\n            this.instance.destroy();\n            this.instance = null;\n            this._metadata = null;\n            this._readyState = 0 /* ReadyState.HaveNothing */;\n            console.log(\"Ruffle instance destroyed.\");\n        }\n    }\n    checkOptions(options) {\n        if (typeof options === \"string\") {\n            return { url: options };\n        }\n        const check = (condition, message) => {\n            if (!condition) {\n                const error = new TypeError(message);\n                error.ruffleIndexError = 4 /* PanicError.JavascriptConfiguration */;\n                this.panic(error);\n                throw error;\n            }\n        };\n        check(options !== null && typeof options === \"object\", \"Argument 0 must be a string or object\");\n        check(\"url\" in options || \"data\" in options, \"Argument 0 must contain a `url` or `data` key\");\n        check(!(\"url\" in options) || typeof options.url === \"string\", \"`url` must be a string\");\n        return options;\n    }\n    /**\n     * Gets the configuration set by the Ruffle extension\n     *\n     * @returns The configuration set by the Ruffle extension\n     */\n    getExtensionConfig() {\n        var _a;\n        return window.RufflePlayer &&\n            window.RufflePlayer.conflict &&\n            (window.RufflePlayer.conflict[\"newestName\"] === \"extension\" ||\n                window.RufflePlayer[\"newestName\"] === \"extension\")\n            ? (_a = window.RufflePlayer) === null || _a === void 0 ? void 0 : _a.conflict[\"config\"]\n            : {};\n    }\n    /**\n     * Loads a specified movie into this player.\n     *\n     * This will replace any existing movie that may be playing.\n     *\n     * @param options One of the following:\n     * - A URL, passed as a string, which will load a URL with default options.\n     * - A [[URLLoadOptions]] object, to load a URL with options.\n     * - A [[DataLoadOptions]] object, to load data with options.\n     *\n     * The options will be defaulted by the [[config]] field, which itself\n     * is defaulted by a global `window.RufflePlayer.config`.\n     */\n    async load(options) {\n        var _a, _b;\n        options = this.checkOptions(options);\n        if (!this.isConnected || this.isUnusedFallbackObject()) {\n            console.warn(\"Ignoring attempt to play a disconnected or suspended Ruffle element\");\n            return;\n        }\n        if (isFallbackElement(this)) {\n            // Silently fail on attempt to play a Ruffle element inside a specific node.\n            return;\n        }\n        try {\n            const extensionConfig = this.getExtensionConfig();\n            this.loadedConfig = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, DEFAULT_CONFIG), extensionConfig), ((_b = (_a = window.RufflePlayer) === null || _a === void 0 ? void 0 : _a.config) !== null && _b !== void 0 ? _b : {})), this.config), options);\n            // `allowScriptAccess` can only be set in `options`.\n            this.loadedConfig.allowScriptAccess =\n                options.allowScriptAccess === true;\n            // Pre-emptively set background color of container while Ruffle/SWF loads.\n            if (this.loadedConfig.backgroundColor &&\n                this.loadedConfig.wmode !== \"transparent\" /* WindowMode.Transparent */) {\n                this.container.style.backgroundColor =\n                    this.loadedConfig.backgroundColor;\n            }\n            await this.ensureFreshInstance();\n            if (\"url\" in options) {\n                console.log(`Loading SWF file ${options.url}`);\n                this.swfUrl = new URL(options.url, document.baseURI);\n                const parameters = Object.assign(Object.assign({}, sanitizeParameters(options.url.substring(options.url.indexOf(\"?\")))), sanitizeParameters(options.parameters));\n                this.instance.stream_from(this.swfUrl.href, parameters);\n            }\n            else if (\"data\" in options) {\n                console.log(\"Loading SWF data\");\n                this.instance.load_data(new Uint8Array(options.data), sanitizeParameters(options.parameters), options.swfFileName || \"movie.swf\");\n            }\n        }\n        catch (e) {\n            console.error(`Serious error occurred loading SWF file: ${e}`);\n            const err = new Error(e);\n            if (err.message.includes(\"Error parsing config\")) {\n                err.ruffleIndexError = 4 /* PanicError.JavascriptConfiguration */;\n            }\n            this.panic(err);\n            throw err;\n        }\n    }\n    /**\n     * Plays or resumes the movie.\n     */\n    play() {\n        if (this.instance) {\n            this.instance.play();\n            this.playButton.style.display = \"none\";\n        }\n    }\n    /**\n     * Whether this player is currently playing.\n     *\n     * @returns True if this player is playing, false if it's paused or hasn't started yet.\n     */\n    get isPlaying() {\n        if (this.instance) {\n            return this.instance.is_playing();\n        }\n        return false;\n    }\n    /**\n     * Returns the master volume of the player.\n     *\n     * @returns The volume. 1.0 is 100% volume.\n     */\n    get volume() {\n        if (this.instance) {\n            return this.instance.volume();\n        }\n        return 1.0;\n    }\n    /**\n     * Sets the master volume of the player.\n     *\n     * @param value The volume. 1.0 is 100% volume.\n     */\n    set volume(value) {\n        if (this.instance) {\n            this.instance.set_volume(value);\n        }\n    }\n    /**\n     * Checks if this player is allowed to be fullscreen by the browser.\n     *\n     * @returns True if you may call [[enterFullscreen]].\n     */\n    get fullscreenEnabled() {\n        return !!(document.fullscreenEnabled || document.webkitFullscreenEnabled);\n    }\n    /**\n     * Checks if this player is currently fullscreen inside the browser.\n     *\n     * @returns True if it is fullscreen.\n     */\n    get isFullscreen() {\n        return ((document.fullscreenElement || document.webkitFullscreenElement) ===\n            this);\n    }\n    /**\n     * Exported function that requests the browser to change the fullscreen state if\n     * it is allowed.\n     *\n     * @param isFull Whether to set to fullscreen or return to normal.\n     */\n    setFullscreen(isFull) {\n        if (this.fullscreenEnabled) {\n            if (isFull) {\n                this.enterFullscreen();\n            }\n            else {\n                this.exitFullscreen();\n            }\n        }\n    }\n    /**\n     * Requests the browser to make this player fullscreen.\n     *\n     * This is not guaranteed to succeed, please check [[fullscreenEnabled]] first.\n     */\n    enterFullscreen() {\n        const options = {\n            navigationUI: \"hide\",\n        };\n        if (this.requestFullscreen) {\n            this.requestFullscreen(options);\n        }\n        else if (this.webkitRequestFullscreen) {\n            this.webkitRequestFullscreen(options);\n        }\n        else if (this.webkitRequestFullScreen) {\n            this.webkitRequestFullScreen(options);\n        }\n    }\n    /**\n     * Requests the browser to no longer make this player fullscreen.\n     */\n    exitFullscreen() {\n        if (document.exitFullscreen) {\n            document.exitFullscreen();\n        }\n        else if (document.webkitExitFullscreen) {\n            document.webkitExitFullscreen();\n        }\n        else if (document.webkitCancelFullScreen) {\n            document.webkitCancelFullScreen();\n        }\n    }\n    /**\n     * Called when entering / leaving fullscreen\n     */\n    fullScreenChange() {\n        var _a;\n        (_a = this.instance) === null || _a === void 0 ? void 0 : _a.set_fullscreen(this.isFullscreen);\n    }\n    checkIfTouch(event) {\n        if (event.pointerType === \"touch\" || event.pointerType === \"pen\") {\n            this.isTouch = true;\n        }\n    }\n    base64ToBlob(bytesBase64, mimeString) {\n        const byteString = atob(bytesBase64);\n        const ab = new ArrayBuffer(byteString.length);\n        const ia = new Uint8Array(ab);\n        for (let i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n        }\n        const blob = new Blob([ab], { type: mimeString });\n        return blob;\n    }\n    /**\n     * Download base-64 string as file\n     *\n     * @param bytesBase64 The base-64 encoded SOL string\n     * @param mimeType The MIME type\n     * @param fileName The name to give the file\n     */\n    saveFile(bytesBase64, mimeType, fileName) {\n        const blob = this.base64ToBlob(bytesBase64, mimeType);\n        const blobURL = URL.createObjectURL(blob);\n        const link = document.createElement(\"a\");\n        link.href = blobURL;\n        link.style.display = \"none\";\n        link.download = fileName;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(blobURL);\n    }\n    /**\n     * @returns If the string represent a base-64 encoded SOL file\n     * Check if string is a base-64 encoded SOL file\n     * @param solData The base-64 encoded SOL string\n     */\n    isB64SOL(solData) {\n        try {\n            const decodedData = atob(solData);\n            return decodedData.slice(6, 10) === \"TCSO\";\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    confirmReloadSave(solKey, b64SolData, replace) {\n        if (this.isB64SOL(b64SolData)) {\n            if (localStorage[solKey]) {\n                if (!replace) {\n                    const confirmDelete = confirm(text(\"save-delete-prompt\"));\n                    if (!confirmDelete) {\n                        return;\n                    }\n                }\n                const swfPath = this.swfUrl ? this.swfUrl.pathname : \"\";\n                const swfHost = this.swfUrl\n                    ? this.swfUrl.hostname\n                    : document.location.hostname;\n                const savePath = solKey.split(\"/\").slice(1, -1).join(\"/\");\n                if (swfPath.includes(savePath) && solKey.startsWith(swfHost)) {\n                    const confirmReload = confirm(text(\"save-reload-prompt\", {\n                        action: replace ? \"replace\" : \"delete\",\n                    }));\n                    if (confirmReload && this.loadedConfig) {\n                        this.destroy();\n                        replace\n                            ? localStorage.setItem(solKey, b64SolData)\n                            : localStorage.removeItem(solKey);\n                        this.load(this.loadedConfig);\n                        this.populateSaves();\n                        this.saveManager.classList.add(\"hidden\");\n                    }\n                    return;\n                }\n                replace\n                    ? localStorage.setItem(solKey, b64SolData)\n                    : localStorage.removeItem(solKey);\n                this.populateSaves();\n                this.saveManager.classList.add(\"hidden\");\n            }\n        }\n    }\n    /**\n     * Replace save from SOL file.\n     *\n     * @param event The change event fired\n     * @param solKey The localStorage save file key\n     */\n    replaceSOL(event, solKey) {\n        const fileInput = event.target;\n        const reader = new FileReader();\n        reader.addEventListener(\"load\", () => {\n            if (reader.result && typeof reader.result === \"string\") {\n                const b64Regex = new RegExp(\"data:.*;base64,\");\n                const b64SolData = reader.result.replace(b64Regex, \"\");\n                this.confirmReloadSave(solKey, b64SolData, true);\n            }\n        });\n        if (fileInput &&\n            fileInput.files &&\n            fileInput.files.length > 0 &&\n            fileInput.files[0]) {\n            reader.readAsDataURL(fileInput.files[0]);\n        }\n    }\n    /**\n     * Delete local save.\n     *\n     * @param key The key to remove from local storage\n     */\n    deleteSave(key) {\n        const b64SolData = localStorage.getItem(key);\n        if (b64SolData) {\n            this.confirmReloadSave(key, b64SolData, false);\n        }\n    }\n    /**\n     * Puts the local save SOL file keys in a table.\n     */\n    populateSaves() {\n        const saveTable = this.saveManager.querySelector(\"#local-saves\");\n        if (!saveTable) {\n            return;\n        }\n        try {\n            localStorage;\n        }\n        catch (e) {\n            return;\n        }\n        saveTable.textContent = \"\";\n        Object.keys(localStorage).forEach((key) => {\n            const solName = key.split(\"/\").pop();\n            const solData = localStorage.getItem(key);\n            if (solName && solData && this.isB64SOL(solData)) {\n                const row = document.createElement(\"TR\");\n                const keyCol = document.createElement(\"TD\");\n                keyCol.textContent = solName;\n                keyCol.title = key;\n                const downloadCol = document.createElement(\"TD\");\n                const downloadSpan = document.createElement(\"SPAN\");\n                downloadSpan.textContent = text(\"save-download\");\n                downloadSpan.className = \"save-option\";\n                downloadSpan.addEventListener(\"click\", () => this.saveFile(solData, \"application/octet-stream\", solName + \".sol\"));\n                downloadCol.appendChild(downloadSpan);\n                const replaceCol = document.createElement(\"TD\");\n                const replaceInput = (document.createElement(\"INPUT\"));\n                replaceInput.type = \"file\";\n                replaceInput.accept = \".sol\";\n                replaceInput.className = \"replace-save\";\n                replaceInput.id = \"replace-save-\" + key;\n                const replaceLabel = (document.createElement(\"LABEL\"));\n                replaceLabel.htmlFor = \"replace-save-\" + key;\n                replaceLabel.textContent = text(\"save-replace\");\n                replaceLabel.className = \"save-option\";\n                replaceInput.addEventListener(\"change\", (event) => this.replaceSOL(event, key));\n                replaceCol.appendChild(replaceInput);\n                replaceCol.appendChild(replaceLabel);\n                const deleteCol = document.createElement(\"TD\");\n                const deleteSpan = document.createElement(\"SPAN\");\n                deleteSpan.textContent = text(\"save-delete\");\n                deleteSpan.className = \"save-option\";\n                deleteSpan.addEventListener(\"click\", () => this.deleteSave(key));\n                deleteCol.appendChild(deleteSpan);\n                row.appendChild(keyCol);\n                row.appendChild(downloadCol);\n                row.appendChild(replaceCol);\n                row.appendChild(deleteCol);\n                saveTable.appendChild(row);\n            }\n        });\n    }\n    /**\n     * Gets the local save information as SOL files and downloads them.\n     */\n    backupSaves() {\n        Object.keys(localStorage).forEach((key) => {\n            const solName = key.split(\"/\").pop();\n            const solData = localStorage.getItem(key);\n            if (solData && this.isB64SOL(solData)) {\n                this.saveFile(solData, \"application/octet-stream\", solName + \".sol\");\n            }\n        });\n    }\n    /**\n     * Opens the save manager.\n     */\n    openSaveManager() {\n        this.saveManager.classList.remove(\"hidden\");\n    }\n    /**\n     * Fetches the loaded SWF and downloads it.\n     */\n    async downloadSwf() {\n        try {\n            if (this.swfUrl) {\n                console.log(\"Downloading SWF: \" + this.swfUrl);\n                const response = await fetch(this.swfUrl.href);\n                if (!response.ok) {\n                    console.error(\"SWF download failed\");\n                    return;\n                }\n                const blob = await response.blob();\n                const blobUrl = URL.createObjectURL(blob);\n                const swfDownloadA = document.createElement(\"a\");\n                swfDownloadA.style.display = \"none\";\n                swfDownloadA.href = blobUrl;\n                swfDownloadA.download = swfFileName(this.swfUrl);\n                document.body.appendChild(swfDownloadA);\n                swfDownloadA.click();\n                document.body.removeChild(swfDownloadA);\n                URL.revokeObjectURL(blobUrl);\n            }\n            else {\n                console.error(\"SWF download failed\");\n            }\n        }\n        catch (err) {\n            console.error(\"SWF download failed\");\n        }\n    }\n    virtualKeyboardInput() {\n        const input = this.virtualKeyboard;\n        const string = input.value;\n        for (const char of string) {\n            for (const eventType of [\"keydown\", \"keyup\"]) {\n                this.dispatchEvent(new KeyboardEvent(eventType, {\n                    key: char,\n                    bubbles: true,\n                }));\n            }\n        }\n        input.value = \"\";\n    }\n    openVirtualKeyboard() {\n        // On Android, the Rust code that opens the virtual keyboard triggers\n        // before the TypeScript code that closes it, so delay opening it\n        if (navigator.userAgent.toLowerCase().includes(\"android\")) {\n            setTimeout(() => {\n                this.virtualKeyboard.focus({ preventScroll: true });\n            }, 100);\n        }\n        else {\n            this.virtualKeyboard.focus({ preventScroll: true });\n        }\n    }\n    contextMenuItems() {\n        const CHECKMARK = String.fromCharCode(0x2713);\n        const items = [];\n        const addSeparator = () => {\n            // Don't start with or duplicate separators.\n            if (items.length > 0 && items[items.length - 1] !== null) {\n                items.push(null);\n            }\n        };\n        if (this.instance) {\n            const customItems = this.instance.prepare_context_menu();\n            customItems.forEach((item, index) => {\n                if (item.separatorBefore) {\n                    addSeparator();\n                }\n                items.push({\n                    // TODO: better checkboxes\n                    text: item.caption + (item.checked ? ` (${CHECKMARK})` : ``),\n                    onClick: () => { var _a; return (_a = this.instance) === null || _a === void 0 ? void 0 : _a.run_context_menu_callback(index); },\n                    enabled: item.enabled,\n                });\n            });\n            addSeparator();\n        }\n        if (this.fullscreenEnabled) {\n            if (this.isFullscreen) {\n                items.push({\n                    text: text(\"context-menu-exit-fullscreen\"),\n                    onClick: () => { var _a; return (_a = this.instance) === null || _a === void 0 ? void 0 : _a.set_fullscreen(false); },\n                });\n            }\n            else {\n                items.push({\n                    text: text(\"context-menu-enter-fullscreen\"),\n                    onClick: () => { var _a; return (_a = this.instance) === null || _a === void 0 ? void 0 : _a.set_fullscreen(true); },\n                });\n            }\n        }\n        if (this.instance &&\n            this.swfUrl &&\n            this.loadedConfig &&\n            this.loadedConfig.showSwfDownload === true) {\n            addSeparator();\n            items.push({\n                text: text(\"context-menu-download-swf\"),\n                onClick: this.downloadSwf.bind(this),\n            });\n        }\n        if (window.isSecureContext) {\n            items.push({\n                text: text(\"context-menu-copy-debug-info\"),\n                onClick: () => navigator.clipboard.writeText(this.getPanicData()),\n            });\n        }\n        this.populateSaves();\n        const localSaveTable = this.saveManager.querySelector(\"#local-saves\");\n        if (localSaveTable && localSaveTable.textContent !== \"\") {\n            items.push({\n                text: text(\"context-menu-open-save-manager\"),\n                onClick: this.openSaveManager.bind(this),\n            });\n        }\n        addSeparator();\n        const extensionString = this.isExtension ? \"extension\" : \"\";\n        items.push({\n            text: text(\"context-menu-about-ruffle\", {\n                flavor: extensionString,\n                version: buildInfo.versionName,\n            }),\n            onClick() {\n                window.open(RUFFLE_ORIGIN, \"_blank\");\n            },\n        });\n        // Give option to disable context menu when touch support is being used\n        // to avoid a long press triggering the context menu. (#1972)\n        if (this.isTouch) {\n            addSeparator();\n            items.push({\n                text: text(\"context-menu-hide\"),\n                onClick: () => (this.contextMenuForceDisabled = true),\n            });\n        }\n        return items;\n    }\n    pointerDown(event) {\n        this.pointerDownPosition = new Point(event.pageX, event.pageY);\n        this.pointerMoveMaxDistance = 0;\n        this.startLongPressTimer();\n    }\n    clearLongPressTimer() {\n        if (this.longPressTimer) {\n            clearTimeout(this.longPressTimer);\n            this.longPressTimer = null;\n        }\n    }\n    startLongPressTimer() {\n        const longPressTimeout = 800;\n        this.clearLongPressTimer();\n        this.longPressTimer = setTimeout(() => this.clearLongPressTimer(), longPressTimeout);\n    }\n    checkLongPressMovement(event) {\n        if (this.pointerDownPosition !== null) {\n            const currentPosition = new Point(event.pageX, event.pageY);\n            const distance = this.pointerDownPosition.distanceTo(currentPosition);\n            if (distance > this.pointerMoveMaxDistance) {\n                this.pointerMoveMaxDistance = distance;\n            }\n        }\n    }\n    checkLongPress(event) {\n        const maxAllowedDistance = 15;\n        if (this.longPressTimer) {\n            this.clearLongPressTimer();\n            // The pointerType condition is to ensure right-click does not trigger\n            // a context menu the wrong way the first time you right-click,\n            // before contextMenuSupported is set.\n        }\n        else if (!this.contextMenuSupported &&\n            event.pointerType !== \"mouse\" &&\n            this.pointerMoveMaxDistance < maxAllowedDistance) {\n            this.showContextMenu(event);\n        }\n    }\n    showContextMenu(event) {\n        var _a, _b, _c;\n        event.preventDefault();\n        if (event.type === \"contextmenu\") {\n            this.contextMenuSupported = true;\n            window.addEventListener(\"click\", this.hideContextMenu.bind(this), {\n                once: true,\n            });\n        }\n        else {\n            window.addEventListener(\"pointerup\", this.hideContextMenu.bind(this), { once: true });\n            event.stopPropagation();\n        }\n        if ([false, \"off\" /* ContextMenu.Off */].includes((_b = (_a = this.loadedConfig) === null || _a === void 0 ? void 0 : _a.contextMenu) !== null && _b !== void 0 ? _b : \"on\" /* ContextMenu.On */) ||\n            (this.isTouch &&\n                ((_c = this.loadedConfig) === null || _c === void 0 ? void 0 : _c.contextMenu) ===\n                    \"rightClickOnly\" /* ContextMenu.RightClickOnly */) ||\n            this.contextMenuForceDisabled) {\n            return;\n        }\n        // Clear all context menu items.\n        while (this.contextMenuElement.firstChild) {\n            this.contextMenuElement.removeChild(this.contextMenuElement.firstChild);\n        }\n        // Populate context menu items.\n        for (const item of this.contextMenuItems()) {\n            if (item === null) {\n                const menuSeparator = document.createElement(\"li\");\n                menuSeparator.className = \"menu_separator\";\n                const hr = document.createElement(\"hr\");\n                menuSeparator.appendChild(hr);\n                this.contextMenuElement.appendChild(menuSeparator);\n            }\n            else {\n                const { text, onClick, enabled } = item;\n                const menuItem = document.createElement(\"li\");\n                menuItem.className = \"menu_item\";\n                menuItem.textContent = text;\n                this.contextMenuElement.appendChild(menuItem);\n                if (enabled !== false) {\n                    menuItem.addEventListener(this.contextMenuSupported ? \"click\" : \"pointerup\", onClick);\n                }\n                else {\n                    menuItem.classList.add(\"disabled\");\n                }\n            }\n        }\n        // Place a context menu in the top-left corner, so\n        // its `clientWidth` and `clientHeight` are not clamped.\n        this.contextMenuElement.style.left = \"0\";\n        this.contextMenuElement.style.top = \"0\";\n        this.contextMenuElement.style.display = \"block\";\n        const rect = this.getBoundingClientRect();\n        const x = event.clientX - rect.x;\n        const y = event.clientY - rect.y;\n        const maxX = rect.width - this.contextMenuElement.clientWidth - 1;\n        const maxY = rect.height - this.contextMenuElement.clientHeight - 1;\n        this.contextMenuElement.style.left =\n            Math.floor(Math.min(x, maxX)) + \"px\";\n        this.contextMenuElement.style.top =\n            Math.floor(Math.min(y, maxY)) + \"px\";\n    }\n    hideContextMenu() {\n        var _a;\n        (_a = this.instance) === null || _a === void 0 ? void 0 : _a.clear_custom_menu_items();\n        this.contextMenuElement.style.display = \"none\";\n    }\n    /**\n     * Pauses this player.\n     *\n     * No more frames, scripts or sounds will be executed.\n     * This movie will be considered inactive and will not wake up until resumed.\n     */\n    pause() {\n        if (this.instance) {\n            this.instance.pause();\n            this.playButton.style.display = \"block\";\n        }\n    }\n    audioState() {\n        if (this.instance) {\n            const audioContext = this.instance.audio_context();\n            return (audioContext && audioContext.state) || \"running\";\n        }\n        return \"suspended\";\n    }\n    unmuteOverlayClicked() {\n        if (this.instance) {\n            if (this.audioState() !== \"running\") {\n                const audioContext = this.instance.audio_context();\n                if (audioContext) {\n                    audioContext.resume();\n                }\n            }\n            this.unmuteOverlay.style.display = \"none\";\n        }\n    }\n    /**\n     * Plays a silent sound based on the AudioContext's sample rate.\n     *\n     * This is used to unmute audio on iOS and iPadOS when silent mode is enabled on the device (issue 1552).\n     */\n    unmuteAudioContext() {\n        // No need to play the dummy sound again once audio is unmuted.\n        if (isAudioContextUnmuted) {\n            return;\n        }\n        // TODO: Use `navigator.userAgentData` to detect the platform when support improves?\n        if (navigator.maxTouchPoints < 1) {\n            isAudioContextUnmuted = true;\n            return;\n        }\n        this.container.addEventListener(\"click\", () => {\n            var _a;\n            if (isAudioContextUnmuted) {\n                return;\n            }\n            const audioContext = (_a = this.instance) === null || _a === void 0 ? void 0 : _a.audio_context();\n            if (!audioContext) {\n                return;\n            }\n            const audio = new Audio();\n            audio.src = (() => {\n                // Returns a seven samples long 8 bit mono WAVE file.\n                // This is required to prevent the AudioContext from desyncing and crashing.\n                const arrayBuffer = new ArrayBuffer(10);\n                const dataView = new DataView(arrayBuffer);\n                const sampleRate = audioContext.sampleRate;\n                dataView.setUint32(0, sampleRate, true);\n                dataView.setUint32(4, sampleRate, true);\n                dataView.setUint16(8, 1, true);\n                const missingCharacters = window\n                    .btoa(String.fromCharCode(...new Uint8Array(arrayBuffer)))\n                    .slice(0, 13);\n                return `data:audio/wav;base64,UklGRisAAABXQVZFZm10IBAAAAABAAEA${missingCharacters}AgAZGF0YQcAAACAgICAgICAAAA=`;\n            })();\n            audio.load();\n            audio\n                .play()\n                .then(() => {\n                isAudioContextUnmuted = true;\n            })\n                .catch((err) => {\n                console.warn(`Failed to play dummy sound: ${err}`);\n            });\n        }, { once: true });\n    }\n    /**\n     * Copies attributes and children from another element to this player element.\n     * Used by the polyfill elements, RuffleObject and RuffleEmbed.\n     *\n     * @param element The element to copy all attributes from.\n     */\n    copyElement(element) {\n        if (element) {\n            for (const attribute of element.attributes) {\n                if (attribute.specified) {\n                    // Issue 468: Chrome \"Click to Active Flash\" box stomps on title attribute\n                    if (attribute.name === \"title\" &&\n                        attribute.value === \"Adobe Flash Player\") {\n                        continue;\n                    }\n                    try {\n                        this.setAttribute(attribute.name, attribute.value);\n                    }\n                    catch (err) {\n                        // The embed may have invalid attributes, so handle these gracefully.\n                        console.warn(`Unable to set attribute ${attribute.name} on Ruffle instance`);\n                    }\n                }\n            }\n            for (const node of Array.from(element.children)) {\n                this.appendChild(node);\n            }\n        }\n    }\n    /**\n     * Converts a dimension attribute on an HTML embed/object element to a valid CSS dimension.\n     * HTML element dimensions are unitless, but can also be percentages.\n     * Add a 'px' unit unless the value is a percentage.\n     * Returns null if this is not a valid dimension.\n     *\n     * @param attribute The attribute to convert\n     *\n     * @private\n     */\n    static htmlDimensionToCssDimension(attribute) {\n        if (attribute) {\n            const match = attribute.match(DIMENSION_REGEX);\n            if (match) {\n                let out = match[1];\n                if (!match[3]) {\n                    // Unitless -- add px for CSS.\n                    out += \"px\";\n                }\n                return out;\n            }\n        }\n        return null;\n    }\n    /**\n     * When a movie presents a new callback through `ExternalInterface.addCallback`,\n     * we are informed so that we can expose the method on any relevant DOM element.\n     *\n     * This should only be called by Ruffle itself and not by users.\n     *\n     * @param name The name of the callback that is now available.\n     *\n     * @internal\n     * @ignore\n     */\n    onCallbackAvailable(name) {\n        const instance = this.instance;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this[name] = (...args) => {\n            return instance === null || instance === void 0 ? void 0 : instance.call_exposed_callback(name, args);\n        };\n    }\n    /**\n     * Sets a trace observer on this flash player.\n     *\n     * The observer will be called, as a function, for each message that the playing movie will \"trace\" (output).\n     *\n     * @param observer The observer that will be called for each trace.\n     */\n    set traceObserver(observer) {\n        var _a;\n        (_a = this.instance) === null || _a === void 0 ? void 0 : _a.set_trace_observer(observer);\n    }\n    /**\n     * Get data included in any panic of this ruffle-player\n     *\n     * @returns A string containing all the data included in the panic.\n     */\n    getPanicData() {\n        const dataArray = [];\n        dataArray.push(\"\\n# Player Info\\n\");\n        dataArray.push(this.debugPlayerInfo());\n        dataArray.push(\"\\n# Page Info\\n\");\n        dataArray.push(`Page URL: ${document.location.href}\\n`);\n        if (this.swfUrl) {\n            dataArray.push(`SWF URL: ${this.swfUrl}\\n`);\n        }\n        dataArray.push(\"\\n# Browser Info\\n\");\n        dataArray.push(`User Agent: ${window.navigator.userAgent}\\n`);\n        dataArray.push(`Platform: ${window.navigator.platform}\\n`);\n        dataArray.push(`Has touch support: ${window.navigator.maxTouchPoints > 0}\\n`);\n        dataArray.push(\"\\n# Ruffle Info\\n\");\n        dataArray.push(`Version: ${buildInfo.versionNumber}\\n`);\n        dataArray.push(`Name: ${buildInfo.versionName}\\n`);\n        dataArray.push(`Channel: ${buildInfo.versionChannel}\\n`);\n        dataArray.push(`Built: ${buildInfo.buildDate}\\n`);\n        dataArray.push(`Commit: ${buildInfo.commitHash}\\n`);\n        dataArray.push(`Is extension: ${this.isExtension}\\n`);\n        dataArray.push(\"\\n# Metadata\\n\");\n        if (this.metadata) {\n            for (const [key, value] of Object.entries(this.metadata)) {\n                dataArray.push(`${key}: ${value}\\n`);\n            }\n        }\n        return dataArray.join(\"\");\n    }\n    /**\n     * Panics this specific player, forcefully destroying all resources and displays an error message to the user.\n     *\n     * This should be called when something went absolutely, incredibly and disastrously wrong and there is no chance\n     * of recovery.\n     *\n     * Ruffle will attempt to isolate all damage to this specific player instance, but no guarantees can be made if there\n     * was a core issue which triggered the panic. If Ruffle is unable to isolate the cause to a specific player, then\n     * all players will panic and Ruffle will become \"poisoned\" - no more players will run on this page until it is\n     * reloaded fresh.\n     *\n     * @param error The error, if any, that triggered this panic.\n     */\n    panic(error) {\n        var _a;\n        if (this.panicked) {\n            // Only show the first major error, not any repeats - they aren't as important\n            return;\n        }\n        this.panicked = true;\n        this.hideSplashScreen();\n        if (error instanceof Error &&\n            (error.name === \"AbortError\" ||\n                error.message.includes(\"AbortError\"))) {\n            // Firefox: Don't display the panic screen if the user leaves the page while something is still loading\n            return;\n        }\n        const errorIndex = (_a = error === null || error === void 0 ? void 0 : error.ruffleIndexError) !== null && _a !== void 0 ? _a : 0 /* PanicError.Unknown */;\n        const errorArray = Object.assign([], {\n            stackIndex: -1,\n            avmStackIndex: -1,\n        });\n        errorArray.push(\"# Error Info\\n\");\n        if (error instanceof Error) {\n            errorArray.push(`Error name: ${error.name}\\n`);\n            errorArray.push(`Error message: ${error.message}\\n`);\n            if (error.stack) {\n                const stackIndex = errorArray.push(`Error stack:\\n\\`\\`\\`\\n${error.stack}\\n\\`\\`\\`\\n`) - 1;\n                if (error.avmStack) {\n                    const avmStackIndex = errorArray.push(`AVM2 stack:\\n\\`\\`\\`\\n    ${error.avmStack\n                        .trim()\n                        .replace(/\\t/g, \"    \")}\\n\\`\\`\\`\\n`) - 1;\n                    errorArray.avmStackIndex = avmStackIndex;\n                }\n                errorArray.stackIndex = stackIndex;\n            }\n        }\n        else {\n            errorArray.push(`Error: ${error}\\n`);\n        }\n        errorArray.push(this.getPanicData());\n        const errorText = errorArray.join(\"\");\n        const buildDate = new Date(buildInfo.buildDate);\n        const monthsPrior = new Date();\n        monthsPrior.setMonth(monthsPrior.getMonth() - 6); // 6 months prior\n        const isBuildOutdated = monthsPrior > buildDate;\n        // Create a link to GitHub with all of the error data, if the build is not outdated.\n        // Otherwise, create a link to the downloads section on the Ruffle website.\n        let actionTag;\n        if (!isBuildOutdated) {\n            // Remove query params for the issue title.\n            const pageUrl = document.location.href.split(/[?#]/)[0];\n            const issueTitle = `Error on ${pageUrl}`;\n            let issueLink = `https://github.com/ruffle-rs/ruffle/issues/new?title=${encodeURIComponent(issueTitle)}&template=error_report.md&labels=error-report&body=`;\n            let issueBody = encodeURIComponent(errorText);\n            if (errorArray.stackIndex > -1 &&\n                String(issueLink + issueBody).length > 8195) {\n                // Strip the stack error from the array when the produced URL is way too long.\n                // This should prevent \"414 Request-URI Too Large\" errors on GitHub.\n                errorArray[errorArray.stackIndex] = null;\n                if (errorArray.avmStackIndex > -1) {\n                    errorArray[errorArray.avmStackIndex] = null;\n                }\n                issueBody = encodeURIComponent(errorArray.join(\"\"));\n            }\n            issueLink += issueBody;\n            actionTag = `<a target=\"_top\" href=\"${issueLink}\">${text(\"report-bug\")}</a>`;\n        }\n        else {\n            actionTag = `<a target=\"_top\" href=\"${RUFFLE_ORIGIN}#downloads\">${text(\"update-ruffle\")}</a>`;\n        }\n        // Clears out any existing content (ie play button or canvas) and replaces it with the error screen\n        let errorBody, errorFooter;\n        switch (errorIndex) {\n            case 2 /* PanicError.FileProtocol */:\n                // General error: Running on the `file:` protocol\n                errorBody = textAsParagraphs(\"error-file-protocol\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"${RUFFLE_ORIGIN}/demo\">${text(\"ruffle-demo\")}</a></li>\n                    <li><a target=\"_top\" href=\"${RUFFLE_ORIGIN}#downloads\">${text(\"ruffle-desktop\")}</a></li>\n                `;\n                break;\n            case 4 /* PanicError.JavascriptConfiguration */:\n                // General error: Incorrect JavaScript configuration\n                errorBody = textAsParagraphs(\"error-javascript-config\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#javascript-api\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 9 /* PanicError.WasmNotFound */:\n                // Self hosted: Cannot load `.wasm` file - file not found\n                errorBody = textAsParagraphs(\"error-wasm-not-found\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#configuration-options\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 8 /* PanicError.WasmMimeType */:\n                // Self hosted: Cannot load `.wasm` file - incorrect MIME type\n                errorBody = textAsParagraphs(\"error-wasm-mime-type\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#configure-webassembly-mime-type\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 11 /* PanicError.SwfFetchError */:\n                errorBody = textAsParagraphs(\"error-swf-fetch\");\n                errorFooter = `\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 12 /* PanicError.SwfCors */:\n                // Self hosted: Cannot load SWF file - CORS issues\n                errorBody = textAsParagraphs(\"error-swf-cors\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#configure-cors-header\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 6 /* PanicError.WasmCors */:\n                // Self hosted: Cannot load `.wasm` file - CORS issues\n                errorBody = textAsParagraphs(\"error-wasm-cors\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#configure-cors-header\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 3 /* PanicError.InvalidWasm */:\n                // Self hosted: Cannot load `.wasm` file - incorrect configuration or missing files\n                errorBody = textAsParagraphs(\"error-wasm-invalid\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#addressing-a-compileerror\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 7 /* PanicError.WasmDownload */:\n                // Usually a transient network error or botched deployment\n                errorBody = textAsParagraphs(\"error-wasm-download\");\n                errorFooter = `\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 10 /* PanicError.WasmDisabledMicrosoftEdge */:\n                // Self hosted: User has disabled WebAssembly in Microsoft Edge through the\n                // \"Enhance your Security on the web\" setting.\n                errorBody = textAsParagraphs(\"error-wasm-disabled-on-edge\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Frequently-Asked-Questions-For-Users#edge-webassembly-error\">${text(\"more-info\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 5 /* PanicError.JavascriptConflict */:\n                // Self hosted: Cannot load `.wasm` file - a native object / function is overriden\n                errorBody = textAsParagraphs(\"error-javascript-conflict\");\n                if (isBuildOutdated) {\n                    errorBody += textAsParagraphs(\"error-javascript-conflict-outdated\", { buildDate: buildInfo.buildDate });\n                }\n                errorFooter = `\n                    <li>${actionTag}</li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            case 1 /* PanicError.CSPConflict */:\n                // General error: Cannot load `.wasm` file - a native object / function is overriden\n                errorBody = textAsParagraphs(\"error-csp-conflict\");\n                errorFooter = `\n                    <li><a target=\"_top\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#configure-wasm-csp\">${text(\"ruffle-wiki\")}</a></li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n            default:\n                // Unknown error\n                errorBody = textAsParagraphs(\"error-unknown\", {\n                    buildDate: buildInfo.buildDate,\n                    outdated: String(isBuildOutdated),\n                });\n                errorFooter = `\n                    <li>${actionTag}</li>\n                    <li><a href=\"#\" id=\"panic-view-details\">${text(\"view-error-details\")}</a></li>\n                `;\n                break;\n        }\n        this.container.innerHTML = `\n            <div id=\"panic\">\n                <div id=\"panic-title\">${text(\"panic-title\")}</div>\n                <div id=\"panic-body\">${errorBody}</div>\n                <div id=\"panic-footer\">\n                    <ul>${errorFooter}</ul>\n                </div>\n            </div>\n        `;\n        const viewDetails = (this.container.querySelector(\"#panic-view-details\"));\n        if (viewDetails) {\n            viewDetails.onclick = () => {\n                const panicBody = (this.container.querySelector(\"#panic-body\"));\n                panicBody.classList.add(\"details\");\n                const panicText = document.createElement(\"textarea\");\n                panicText.readOnly = true;\n                panicText.value = errorText;\n                panicBody.replaceChildren(panicText);\n                return false;\n            };\n        }\n        // Do this last, just in case it causes any cascading issues.\n        this.destroy();\n    }\n    displayRootMovieDownloadFailedMessage() {\n        if (this.isExtension &&\n            window.location.origin !== this.swfUrl.origin) {\n            this.hideSplashScreen();\n            const div = document.createElement(\"div\");\n            div.id = \"message_overlay\";\n            div.innerHTML = `<div class=\"message\">\n                ${textAsParagraphs(\"message-cant-embed\")}\n                <div>\n                    <a target=\"_blank\" href=\"${this.swfUrl}\">${text(\"open-in-new-tab\")}</a>\n                </div>\n            </div>`;\n            this.container.prepend(div);\n        }\n        else {\n            const error = new Error(\"Failed to fetch: \" + this.swfUrl);\n            if (!this.swfUrl.protocol.includes(\"http\")) {\n                error.ruffleIndexError = 2 /* PanicError.FileProtocol */;\n            }\n            else if (window.location.origin === this.swfUrl.origin) {\n                error.ruffleIndexError = 11 /* PanicError.SwfFetchError */;\n            }\n            else {\n                // This is a selfhosted build of Ruffle that tried to make a cross-origin request\n                error.ruffleIndexError = 12 /* PanicError.SwfCors */;\n            }\n            this.panic(error);\n        }\n    }\n    displayUnsupportedMessage() {\n        const div = document.createElement(\"div\");\n        div.id = \"message_overlay\";\n        // TODO: Change link to https://ruffle.rs/faq or similar\n        // TODO: Pause content until message is dismissed\n        div.innerHTML = `<div class=\"message\">\n            ${textAsParagraphs(\"message-unsupported-avm2\")}\n            <div>\n                <a target=\"_blank\" class=\"more-info-link\" href=\"https://github.com/ruffle-rs/ruffle/wiki/Frequently-Asked-Questions-For-Users\">${text(\"more-info\")}</a>\n                <button id=\"run-anyway-btn\">${text(\"run-anyway\")}</button>\n            </div>\n        </div>`;\n        this.container.prepend(div);\n        const button = div.querySelector(\"#run-anyway-btn\");\n        button.onclick = () => {\n            div.parentNode.removeChild(div);\n        };\n    }\n    /**\n     * Show a dismissible message in front of the player.\n     *\n     * @param message The message shown to the user.\n     */\n    displayMessage(message) {\n        const div = document.createElement(\"div\");\n        div.id = \"message_overlay\";\n        div.innerHTML = `<div class=\"message\">\n            <p>${message}</p>\n            <div>\n                <button id=\"continue-btn\">${text(\"continue\")}</button>\n            </div>\n        </div>`;\n        this.container.prepend(div);\n        (this.container.querySelector(\"#continue-btn\")).onclick = () => {\n            div.parentNode.removeChild(div);\n        };\n    }\n    debugPlayerInfo() {\n        let result = `Allows script access: ${this.loadedConfig ? this.loadedConfig.allowScriptAccess : false}\\n`;\n        let renderInfo = `(Cached) ${this._cachedDebugInfo}`;\n        if (this.instance) {\n            try {\n                renderInfo = this.instance.renderer_debug_info();\n            }\n            catch (_a) {\n                // ignored\n            }\n        }\n        if (renderInfo) {\n            result += `${renderInfo}\\n`;\n        }\n        return result;\n    }\n    hideSplashScreen() {\n        this.splashScreen.classList.add(\"hidden\");\n        this.container.classList.remove(\"hidden\");\n    }\n    showSplashScreen() {\n        this.splashScreen.classList.remove(\"hidden\");\n        this.container.classList.add(\"hidden\");\n    }\n    setMetadata(metadata) {\n        this._metadata = metadata;\n        // TODO: Switch this to ReadyState.Loading when we have streaming support.\n        this._readyState = 2 /* ReadyState.Loaded */;\n        this.hideSplashScreen();\n        this.dispatchEvent(new Event(RufflePlayer.LOADED_METADATA));\n        // TODO: Move this to whatever function changes the ReadyState to Loaded when we have streaming support.\n        this.dispatchEvent(new Event(RufflePlayer.LOADED_DATA));\n    }\n    setIsExtension(isExtension) {\n        this.isExtension = isExtension;\n    }\n}\n/**\n * Triggered when a movie metadata has been loaded (such as movie width and height).\n *\n * @event RufflePlayer#loadedmetadata\n */\nRufflePlayer.LOADED_METADATA = \"loadedmetadata\";\n/**\n * Triggered when a movie is fully loaded.\n *\n * @event RufflePlayer#loadeddata\n */\nRufflePlayer.LOADED_DATA = \"loadeddata\";\nexport { RufflePlayer };\n/**\n * Returns whether a SWF file can call JavaScript code in the surrounding HTML file.\n *\n * @param access The value of the `allowScriptAccess` attribute.\n * @param url The URL of the SWF file.\n * @returns True if script access is allowed.\n */\nexport function isScriptAccessAllowed(access, url) {\n    if (!access) {\n        access = \"sameDomain\";\n    }\n    switch (access.toLowerCase()) {\n        case \"always\":\n            return true;\n        case \"never\":\n            return false;\n        case \"samedomain\":\n        default:\n            try {\n                return (new URL(window.location.href).origin ===\n                    new URL(url, window.location.href).origin);\n            }\n            catch (_a) {\n                return false;\n            }\n    }\n}\n/**\n * Returns whether a SWF file should show the built-in context menu items.\n *\n * @param menu The value of the `menu` attribute.\n * @returns True if the built-in context items should be shown.\n */\nexport function isBuiltInContextMenuVisible(menu) {\n    if (menu === null || menu.toLowerCase() === \"true\") {\n        return true;\n    }\n    return false;\n}\n/**\n * Returns whether the given filename is a Youtube Flash source.\n *\n * @param filename The filename to test.\n * @returns True if the filename is a Youtube Flash source.\n */\nexport function isYoutubeFlashSource(filename) {\n    if (filename) {\n        let pathname = \"\";\n        let cleaned_hostname = \"\";\n        try {\n            // A base URL is required if `filename` is a relative URL, but we don't need to detect the real URL origin.\n            const url = new URL(filename, RUFFLE_ORIGIN);\n            pathname = url.pathname;\n            cleaned_hostname = url.hostname.replace(\"www.\", \"\");\n        }\n        catch (err) {\n            // Some invalid filenames, like `///`, could raise a TypeError. Let's fail silently in this situation.\n        }\n        // See https://wiki.mozilla.org/QA/Youtube_Embedded_Rewrite\n        if (pathname.startsWith(\"/v/\") &&\n            (cleaned_hostname === \"youtube.com\" ||\n                cleaned_hostname === \"youtube-nocookie.com\")) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Workaround Youtube mixed content if upgradeToHttps is true.\n *\n * @param elem The element to change.\n * @param attr The attribute to adjust.\n */\nexport function workaroundYoutubeMixedContent(elem, attr) {\n    var _a, _b;\n    const elem_attr = elem.getAttribute(attr);\n    const window_config = (_b = (_a = window.RufflePlayer) === null || _a === void 0 ? void 0 : _a.config) !== null && _b !== void 0 ? _b : {};\n    if (elem_attr) {\n        try {\n            const url = new URL(elem_attr);\n            if (url.protocol === \"http:\" &&\n                window.location.protocol === \"https:\" &&\n                (!(\"upgradeToHttps\" in window_config) ||\n                    window_config.upgradeToHttps !== false)) {\n                url.protocol = \"https:\";\n                elem.setAttribute(attr, url.toString());\n            }\n        }\n        catch (err) {\n            // Some invalid filenames, like `///`, could raise a TypeError. Let's fail silently in this situation.\n        }\n    }\n}\n/**\n * Determine if an element is a child of a node that was not supported\n * in non-HTML5 compliant browsers. If so, the element was meant to be\n * used as a fallback content.\n *\n * @param elem The element to test.\n * @returns True if the element is inside an <audio> or <video> node.\n */\nexport function isFallbackElement(elem) {\n    let parent = elem.parentElement;\n    while (parent !== null) {\n        switch (parent.tagName) {\n            case \"AUDIO\":\n            case \"VIDEO\":\n                return true;\n        }\n        parent = parent.parentElement;\n    }\n    return false;\n}\n","import { isBuiltInContextMenuVisible, isFallbackElement, isScriptAccessAllowed, isYoutubeFlashSource, RufflePlayer, workaroundYoutubeMixedContent, } from \"./ruffle-player\";\nimport { registerElement } from \"./register-element\";\nimport { isSwfFilename, isSwfMimeType } from \"./swf-utils\";\n/**\n * A polyfill html element.\n *\n * This specific class tries to polyfill existing `<embed>` tags,\n * and should not be used. Prefer [[RufflePlayer]] instead.\n *\n * @internal\n */\nexport class RuffleEmbed extends RufflePlayer {\n    /**\n     * Constructs a new Ruffle flash player for insertion onto the page.\n     *\n     * This specific class tries to polyfill existing `<embed>` tags,\n     * and should not be used. Prefer [[RufflePlayer]] instead.\n     */\n    constructor() {\n        super();\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    connectedCallback() {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v;\n        super.connectedCallback();\n        const src = this.attributes.getNamedItem(\"src\");\n        if (src) {\n            const allowScriptAccess = (_b = (_a = this.attributes.getNamedItem(\"allowScriptAccess\")) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : null;\n            const menu = (_d = (_c = this.attributes.getNamedItem(\"menu\")) === null || _c === void 0 ? void 0 : _c.value) !== null && _d !== void 0 ? _d : null;\n            // Kick off the SWF download.\n            this.load({\n                url: src.value,\n                allowScriptAccess: isScriptAccessAllowed(allowScriptAccess, src.value),\n                parameters: (_f = (_e = this.attributes.getNamedItem(\"flashvars\")) === null || _e === void 0 ? void 0 : _e.value) !== null && _f !== void 0 ? _f : null,\n                backgroundColor: (_h = (_g = this.attributes.getNamedItem(\"bgcolor\")) === null || _g === void 0 ? void 0 : _g.value) !== null && _h !== void 0 ? _h : null,\n                base: (_k = (_j = this.attributes.getNamedItem(\"base\")) === null || _j === void 0 ? void 0 : _j.value) !== null && _k !== void 0 ? _k : null,\n                menu: isBuiltInContextMenuVisible(menu),\n                salign: (_m = (_l = this.attributes.getNamedItem(\"salign\")) === null || _l === void 0 ? void 0 : _l.value) !== null && _m !== void 0 ? _m : \"\",\n                quality: (_p = (_o = this.attributes.getNamedItem(\"quality\")) === null || _o === void 0 ? void 0 : _o.value) !== null && _p !== void 0 ? _p : \"high\",\n                scale: (_r = (_q = this.attributes.getNamedItem(\"scale\")) === null || _q === void 0 ? void 0 : _q.value) !== null && _r !== void 0 ? _r : \"showAll\",\n                wmode: (_t = (_s = this.attributes.getNamedItem(\"wmode\")) === null || _s === void 0 ? void 0 : _s.value) !== null && _t !== void 0 ? _t : \"window\" /* WindowMode.Window */,\n                allowNetworking: (_v = (_u = this.attributes.getNamedItem(\"allowNetworking\")) === null || _u === void 0 ? void 0 : _u.value) !== null && _v !== void 0 ? _v : \"all\" /* NetworkingAccessMode.All */,\n            });\n        }\n    }\n    /**\n     * Polyfill of HTMLObjectElement.\n     *\n     * @ignore\n     * @internal\n     */\n    get src() {\n        var _a;\n        return (_a = this.attributes.getNamedItem(\"src\")) === null || _a === void 0 ? void 0 : _a.value;\n    }\n    /**\n     * Polyfill of HTMLObjectElement.\n     *\n     * @ignore\n     * @internal\n     */\n    set src(srcval) {\n        if (srcval) {\n            const attr = document.createAttribute(\"src\");\n            attr.value = srcval;\n            this.attributes.setNamedItem(attr);\n        }\n        else {\n            this.attributes.removeNamedItem(\"src\");\n        }\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    static get observedAttributes() {\n        return [\"src\", \"width\", \"height\"];\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    attributeChangedCallback(name, oldValue, newValue) {\n        var _a, _b, _c, _d;\n        super.attributeChangedCallback(name, oldValue, newValue);\n        if (this.isConnected && name === \"src\") {\n            const src = this.attributes.getNamedItem(\"src\");\n            if (src) {\n                this.load({\n                    url: src.value,\n                    parameters: (_b = (_a = this.attributes.getNamedItem(\"flashvars\")) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : null,\n                    base: (_d = (_c = this.attributes.getNamedItem(\"base\")) === null || _c === void 0 ? void 0 : _c.value) !== null && _d !== void 0 ? _d : null,\n                });\n            }\n        }\n    }\n    /**\n     * Checks if the given element may be polyfilled with this one.\n     *\n     * @param elem Element to check.\n     * @returns True if the element looks like a flash embed.\n     */\n    static isInterdictable(elem) {\n        // Don't polyfill if the element is inside a specific node.\n        if (isFallbackElement(elem)) {\n            return false;\n        }\n        // Don't polyfill when no file is specified.\n        if (!elem.getAttribute(\"src\")) {\n            return false;\n        }\n        // Don't polyfill when the file is a Youtube Flash source.\n        if (isYoutubeFlashSource(elem.getAttribute(\"src\"))) {\n            // Workaround YouTube mixed content; this isn't what browsers do automatically, but while we're here, we may as well\n            workaroundYoutubeMixedContent(elem, \"src\");\n            return false;\n        }\n        // Check for MIME type.\n        const type = elem.getAttribute(\"type\");\n        if (!type) {\n            // If no MIME type is specified, polyfill if movie is an SWF file.\n            return isSwfFilename(elem.getAttribute(\"src\"));\n        }\n        else {\n            return isSwfMimeType(type);\n        }\n    }\n    /**\n     * Creates a RuffleEmbed that will polyfill and replace the given element.\n     *\n     * @param elem Element to replace.\n     * @returns Created RuffleEmbed.\n     */\n    static fromNativeEmbedElement(elem) {\n        const externalName = registerElement(\"ruffle-embed\", RuffleEmbed);\n        const ruffleObj = document.createElement(externalName);\n        ruffleObj.copyElement(elem);\n        return ruffleObj;\n    }\n}\n","import { isBuiltInContextMenuVisible, isFallbackElement, isScriptAccessAllowed, isYoutubeFlashSource, workaroundYoutubeMixedContent, RufflePlayer, } from \"./ruffle-player\";\nimport { FLASH_ACTIVEX_CLASSID } from \"./flash-identifiers\";\nimport { registerElement } from \"./register-element\";\nimport { RuffleEmbed } from \"./ruffle-embed\";\nimport { isSwfFilename, isSwfMimeType } from \"./swf-utils\";\n/**\n * Find and return the first value in obj with the given key.\n * Many Flash params were case insensitive, so we use this when checking for them.\n *\n * @param obj Object to check\n * @param key Key to find\n * @param defaultValue Value if not found\n * @returns Value if found, else [[defaultValue]]\n */\nfunction findCaseInsensitive(obj, key, defaultValue) {\n    key = key.toLowerCase();\n    for (const [k, value] of Object.entries(obj)) {\n        if (k.toLowerCase() === key) {\n            return value;\n        }\n    }\n    return defaultValue;\n}\n/**\n * Returns all flash params ([[HTMLParamElement]]) that are for the given object.\n *\n * @param elem Element to check.\n * @returns A record of every parameter.\n */\nfunction paramsOf(elem) {\n    var _a, _b;\n    const params = {};\n    for (const param of elem.children) {\n        if (param instanceof HTMLParamElement) {\n            const key = (_a = param.attributes.getNamedItem(\"name\")) === null || _a === void 0 ? void 0 : _a.value;\n            const value = (_b = param.attributes.getNamedItem(\"value\")) === null || _b === void 0 ? void 0 : _b.value;\n            if (key && value) {\n                params[key] = value;\n            }\n        }\n    }\n    return params;\n}\n/**\n * A polyfill html element.\n *\n * This specific class tries to polyfill existing `<object>` tags,\n * and should not be used. Prefer [[RufflePlayer]] instead.\n *\n * @internal\n */\nexport class RuffleObject extends RufflePlayer {\n    /**\n     * Constructs a new Ruffle flash player for insertion onto the page.\n     *\n     * This specific class tries to polyfill existing `<object>` tags,\n     * and should not be used. Prefer [[RufflePlayer]] instead.\n     */\n    constructor() {\n        super();\n        this.params = {};\n    }\n    /**\n     * @ignore\n     * @internal\n     */\n    connectedCallback() {\n        var _a;\n        super.connectedCallback();\n        this.params = paramsOf(this);\n        let url = null;\n        if (this.attributes.getNamedItem(\"data\")) {\n            url = (_a = this.attributes.getNamedItem(\"data\")) === null || _a === void 0 ? void 0 : _a.value;\n        }\n        else if (this.params[\"movie\"]) {\n            url = this.params[\"movie\"];\n        }\n        const allowScriptAccess = findCaseInsensitive(this.params, \"allowScriptAccess\", null);\n        const parameters = findCaseInsensitive(this.params, \"flashvars\", this.getAttribute(\"flashvars\"));\n        const backgroundColor = findCaseInsensitive(this.params, \"bgcolor\", this.getAttribute(\"bgcolor\"));\n        const allowNetworking = findCaseInsensitive(this.params, \"allowNetworking\", this.getAttribute(\"allowNetworking\"));\n        const base = findCaseInsensitive(this.params, \"base\", this.getAttribute(\"base\"));\n        const menu = findCaseInsensitive(this.params, \"menu\", null);\n        const salign = findCaseInsensitive(this.params, \"salign\", \"\");\n        const quality = findCaseInsensitive(this.params, \"quality\", \"high\");\n        const scale = findCaseInsensitive(this.params, \"scale\", \"showAll\");\n        const wmode = findCaseInsensitive(this.params, \"wmode\", \"window\");\n        if (url) {\n            const options = { url };\n            options.allowScriptAccess = isScriptAccessAllowed(allowScriptAccess, url);\n            if (parameters) {\n                options.parameters = parameters;\n            }\n            if (backgroundColor) {\n                options.backgroundColor = backgroundColor;\n            }\n            if (base) {\n                options.base = base;\n            }\n            options.menu = isBuiltInContextMenuVisible(menu);\n            if (salign) {\n                options.salign = salign;\n            }\n            if (quality) {\n                options.quality = quality;\n            }\n            if (scale) {\n                options.scale = scale;\n            }\n            if (wmode) {\n                options.wmode = wmode;\n            }\n            if (allowNetworking) {\n                options.allowNetworking =\n                    allowNetworking;\n            }\n            // Kick off the SWF download.\n            this.load(options);\n        }\n    }\n    debugPlayerInfo() {\n        var _a;\n        let errorText = super.debugPlayerInfo();\n        errorText += \"Player type: Object\\n\";\n        let url = null;\n        if (this.attributes.getNamedItem(\"data\")) {\n            url = (_a = this.attributes.getNamedItem(\"data\")) === null || _a === void 0 ? void 0 : _a.value;\n        }\n        else if (this.params[\"movie\"]) {\n            url = this.params[\"movie\"];\n        }\n        errorText += `SWF URL: ${url}\\n`;\n        Object.keys(this.params).forEach((key) => {\n            errorText += `Param ${key}: ${this.params[key]}\\n`;\n        });\n        Object.keys(this.attributes).forEach((key) => {\n            var _a;\n            errorText += `Attribute ${key}: ${(_a = this.attributes.getNamedItem(key)) === null || _a === void 0 ? void 0 : _a.value}\\n`;\n        });\n        return errorText;\n    }\n    /**\n     * Polyfill of HTMLObjectElement.\n     *\n     * @ignore\n     * @internal\n     */\n    get data() {\n        return this.getAttribute(\"data\");\n    }\n    /**\n     * Polyfill of HTMLObjectElement.\n     *\n     * @ignore\n     * @internal\n     */\n    set data(href) {\n        if (href) {\n            const attr = document.createAttribute(\"data\");\n            attr.value = href;\n            this.attributes.setNamedItem(attr);\n        }\n        else {\n            this.attributes.removeNamedItem(\"data\");\n        }\n    }\n    /**\n     * Checks if the given element may be polyfilled with this one.\n     *\n     * @param elem Element to check.\n     * @returns True if the element looks like a flash object.\n     */\n    static isInterdictable(elem) {\n        var _a, _b;\n        // Don't polyfill if the element is inside a specific node.\n        if (isFallbackElement(elem)) {\n            return false;\n        }\n        // Don't polyfill if there's already a <ruffle-object> or a <ruffle-embed> inside the <object>.\n        if (elem.getElementsByTagName(\"ruffle-object\").length > 0 ||\n            elem.getElementsByTagName(\"ruffle-embed\").length > 0) {\n            return false;\n        }\n        // Don't polyfill if no movie specified.\n        const data = (_a = elem.attributes.getNamedItem(\"data\")) === null || _a === void 0 ? void 0 : _a.value.toLowerCase();\n        const params = paramsOf(elem);\n        let isSwf;\n        // Check for SWF file.\n        if (data) {\n            // Don't polyfill when the file is a Youtube Flash source.\n            if (isYoutubeFlashSource(data)) {\n                // Workaround YouTube mixed content; this isn't what browsers do automatically, but while we're here, we may as well\n                workaroundYoutubeMixedContent(elem, \"data\");\n                return false;\n            }\n            isSwf = isSwfFilename(data);\n        }\n        else if (params && params[\"movie\"]) {\n            // Don't polyfill when the file is a Youtube Flash source.\n            if (isYoutubeFlashSource(params[\"movie\"])) {\n                // Workaround YouTube mixed content; this isn't what browsers do automatically, but while we're here, we may as well\n                const movie_elem = elem.querySelector(\"param[name='movie']\");\n                if (movie_elem) {\n                    workaroundYoutubeMixedContent(movie_elem, \"value\");\n                    // The data attribute needs to be set for the re-fetch to happen\n                    // It also needs to be set on Firefox for the YouTube object rewrite to work, regardless of mixed content\n                    const movie_src = movie_elem.getAttribute(\"value\");\n                    if (movie_src) {\n                        elem.setAttribute(\"data\", movie_src);\n                    }\n                }\n                return false;\n            }\n            isSwf = isSwfFilename(params[\"movie\"]);\n        }\n        else {\n            // Don't polyfill when no file is specified.\n            return false;\n        }\n        // Check ActiveX class ID.\n        const classid = (_b = elem.attributes\n            .getNamedItem(\"classid\")) === null || _b === void 0 ? void 0 : _b.value.toLowerCase();\n        if (classid === FLASH_ACTIVEX_CLASSID.toLowerCase()) {\n            // classid is an old-IE style embed that would not work on modern browsers.\n            // Often there will be an <embed> inside the <object> that would take precedence.\n            // Only polyfill this <object> if it doesn't contain a polyfillable <embed> or\n            // another <object> that would be supported on modern browsers.\n            return (!Array.from(elem.getElementsByTagName(\"object\")).some(RuffleObject.isInterdictable) &&\n                !Array.from(elem.getElementsByTagName(\"embed\")).some(RuffleEmbed.isInterdictable));\n        }\n        else if (classid) {\n            // Non-Flash classid.\n            return false;\n        }\n        // Check for MIME type.\n        const type = elem.attributes.getNamedItem(\"type\");\n        if (!type) {\n            // If no MIME type is specified, polyfill if movie is an SWF file.\n            return isSwf;\n        }\n        else {\n            return isSwfMimeType(type.value);\n        }\n    }\n    /**\n     * Creates a RuffleObject that will polyfill and replace the given element.\n     *\n     * @param elem Element to replace.\n     * @returns Created RuffleObject.\n     */\n    static fromNativeObjectElement(elem) {\n        const externalName = registerElement(\"ruffle-object\", RuffleObject);\n        const ruffleObj = (document.createElement(externalName));\n        // Avoid copying embeds-inside-objects to avoid double polyfilling.\n        for (const embedElem of Array.from(elem.getElementsByTagName(\"embed\"))) {\n            if (RuffleEmbed.isInterdictable(embedElem)) {\n                embedElem.remove();\n            }\n        }\n        // Avoid copying objects-inside-objects to avoid double polyfilling.\n        // This may happen when Internet Explorer's conditional comments are used.\n        for (const objectElem of Array.from(elem.getElementsByTagName(\"object\"))) {\n            if (RuffleObject.isInterdictable(objectElem)) {\n                objectElem.remove();\n            }\n        }\n        ruffleObj.copyElement(elem);\n        return ruffleObj;\n    }\n}\n","import { FLASH_MIMETYPE, FUTURESPLASH_MIMETYPE, FLASH7_AND_8_MIMETYPE, FLASH_MOVIE_MIMETYPE, } from \"./flash-identifiers\";\n/**\n * Replacement object for `MimeTypeArray` that lets us install new fake mime\n * types.\n *\n * Unlike plugins we can at least enumerate mime types in Firefox, so we don't\n * lose data.\n *\n * We also expose a method called `install` which adds a new plugin. This is\n * used to falsify Flash detection. If the existing `navigator.mimeTypes` has an\n * `install` method, you should not use `RuffleMimeTypeArray` as some other\n * plugin emulator is already present.\n */\nclass RuffleMimeTypeArray {\n    constructor(mimeTypes) {\n        this.__mimeTypes = [];\n        this.__namedMimeTypes = {};\n        if (mimeTypes) {\n            for (let i = 0; i < mimeTypes.length; i++) {\n                this.install(mimeTypes[i]);\n            }\n        }\n    }\n    /**\n     * Install a MIME Type into the array.\n     *\n     * @param mimeType The mime type to install\n     */\n    install(mimeType) {\n        const index = this.__mimeTypes.length;\n        this.__mimeTypes.push(mimeType);\n        this.__namedMimeTypes[mimeType.type] = mimeType;\n        this[mimeType.type] = mimeType;\n        this[index] = mimeType;\n    }\n    item(index) {\n        // This behavior is done to emulate a 32-bit uint,\n        // which browsers use.\n        return this.__mimeTypes[index >>> 0];\n    }\n    namedItem(name) {\n        return this.__namedMimeTypes[name];\n    }\n    get length() {\n        return this.__mimeTypes.length;\n    }\n    [Symbol.iterator]() {\n        return this.__mimeTypes[Symbol.iterator]();\n    }\n}\n/**\n * Equivalent object to `Plugin` that allows us to falsify plugins.\n */\nclass RufflePlugin extends RuffleMimeTypeArray {\n    constructor(name, description, filename) {\n        super();\n        this.name = name;\n        this.description = description;\n        this.filename = filename;\n    }\n}\n/**\n * Replacement object for `PluginArray` that lets us install new fake plugins.\n *\n * This object needs to wrap the native plugin array, since the user might have\n * actual plugins installed. Firefox doesn't let us enumerate the array, though,\n * which has some consequences. Namely, we can't actually perfectly wrap the\n * native plugin array, at least unless there's some secret \"unresolved object\n * property name handler\" that I've never known before in JS...\n *\n * We can still wrap `namedItem` perfectly at least.\n *\n * We also expose a method called `install` which adds a new plugin. This is\n * used to falsify Flash detection. If the existing `navigator.plugins` has an\n * `install` method, you should not use `RufflePluginArray` as some other plugin\n * emulator is already present.\n */\nclass RufflePluginArray {\n    constructor(plugins) {\n        this.__plugins = [];\n        this.__namedPlugins = {};\n        for (let i = 0; i < plugins.length; i++) {\n            this.install(plugins[i]);\n        }\n    }\n    install(plugin) {\n        const index = this.__plugins.length;\n        this.__plugins.push(plugin);\n        this.__namedPlugins[plugin.name] = plugin;\n        this[plugin.name] = plugin;\n        this[index] = plugin;\n    }\n    item(index) {\n        // This behavior is done to emulate a 32-bit uint,\n        // which browsers use. Cloudflare's anti-bot\n        // checks rely on this.\n        return this.__plugins[index >>> 0];\n    }\n    namedItem(name) {\n        return this.__namedPlugins[name];\n    }\n    refresh() {\n        // Nothing to do, we just need to define the method.\n    }\n    [Symbol.iterator]() {\n        return this.__plugins[Symbol.iterator]();\n    }\n    get length() {\n        return this.__plugins.length;\n    }\n}\n/**\n * A fake plugin designed to trigger Flash detection scripts.\n */\nexport const FLASH_PLUGIN = new RufflePlugin(\"Shockwave Flash\", \"Shockwave Flash 32.0 r0\", \"ruffle.js\");\n/**\n * A fake plugin designed to allow early detection of if the Ruffle extension is in use.\n */\nexport const RUFFLE_EXTENSION = new RufflePlugin(\"Ruffle Extension\", \"Ruffle Extension\", \"ruffle.js\");\nFLASH_PLUGIN.install({\n    type: FUTURESPLASH_MIMETYPE,\n    description: \"Shockwave Flash\",\n    suffixes: \"spl\",\n    enabledPlugin: FLASH_PLUGIN,\n});\nFLASH_PLUGIN.install({\n    type: FLASH_MIMETYPE,\n    description: \"Shockwave Flash\",\n    suffixes: \"swf\",\n    enabledPlugin: FLASH_PLUGIN,\n});\nFLASH_PLUGIN.install({\n    type: FLASH7_AND_8_MIMETYPE,\n    description: \"Shockwave Flash\",\n    suffixes: \"swf\",\n    enabledPlugin: FLASH_PLUGIN,\n});\nFLASH_PLUGIN.install({\n    type: FLASH_MOVIE_MIMETYPE,\n    description: \"Shockwave Flash\",\n    suffixes: \"swf\",\n    enabledPlugin: FLASH_PLUGIN,\n});\nRUFFLE_EXTENSION.install({\n    type: \"\",\n    description: \"Ruffle Detection\",\n    suffixes: \"\",\n    enabledPlugin: RUFFLE_EXTENSION,\n});\n/**\n * Install a fake plugin such that detectors will see it in `navigator.plugins`.\n *\n * This function takes care to check if the existing implementation of\n * `navigator.plugins` already accepts fake plugin entries. If so, it will use\n * that version of the plugin array. This allows the plugin polyfill to compose\n * across multiple plugin emulators with the first emulator's polyfill winning.\n *\n * @param plugin The plugin to install\n */\nexport function installPlugin(plugin) {\n    if (!(\"install\" in navigator.plugins) || !navigator.plugins[\"install\"]) {\n        Object.defineProperty(navigator, \"plugins\", {\n            value: new RufflePluginArray(navigator.plugins),\n            writable: false,\n        });\n    }\n    const plugins = navigator.plugins;\n    plugins.install(plugin);\n    if (plugin.length > 0 &&\n        (!(\"install\" in navigator.mimeTypes) || !navigator.mimeTypes[\"install\"])) {\n        Object.defineProperty(navigator, \"mimeTypes\", {\n            value: new RuffleMimeTypeArray(navigator.mimeTypes),\n            writable: false,\n        });\n    }\n    const mimeTypes = navigator.mimeTypes;\n    for (let i = 0; i < plugin.length; i += 1) {\n        mimeTypes.install(plugin[i]);\n    }\n}\n","var _a, _b;\nimport { RuffleObject } from \"./ruffle-object\";\nimport { RuffleEmbed } from \"./ruffle-embed\";\nimport { installPlugin, FLASH_PLUGIN } from \"./plugin-polyfill\";\nimport { publicPath } from \"./public-path\";\nlet isExtension;\nconst globalConfig = (_b = (_a = window.RufflePlayer) === null || _a === void 0 ? void 0 : _a.config) !== null && _b !== void 0 ? _b : {};\nconst jsScriptUrl = publicPath(globalConfig) + \"ruffle.js\";\n/**\n * Polyfill native Flash elements with Ruffle equivalents.\n *\n * This polyfill isn't fool-proof: If there's a chance site JavaScript has\n * access to a pre-polyfill element, then this will break horribly. We can\n * keep native objects out of the DOM, and thus out of JavaScript's grubby\n * little hands, but only if we load first.\n */\nlet objects;\nlet embeds;\n/**\n *\n */\nfunction polyfillFlashInstances() {\n    try {\n        // Create live collections to track embed tags.\n        objects = objects !== null && objects !== void 0 ? objects : document.getElementsByTagName(\"object\");\n        embeds = embeds !== null && embeds !== void 0 ? embeds : document.getElementsByTagName(\"embed\");\n        // Replace <object> first, because <object> often wraps <embed>.\n        for (const elem of Array.from(objects)) {\n            if (RuffleObject.isInterdictable(elem)) {\n                const ruffleObject = RuffleObject.fromNativeObjectElement(elem);\n                ruffleObject.setIsExtension(isExtension);\n                elem.replaceWith(ruffleObject);\n            }\n        }\n        for (const elem of Array.from(embeds)) {\n            if (RuffleEmbed.isInterdictable(elem)) {\n                const ruffleEmbed = RuffleEmbed.fromNativeEmbedElement(elem);\n                ruffleEmbed.setIsExtension(isExtension);\n                elem.replaceWith(ruffleEmbed);\n            }\n        }\n    }\n    catch (err) {\n        console.error(`Serious error encountered when polyfilling native Flash elements: ${err}`);\n    }\n}\n/**\n * Inject Ruffle into <iframe> and <frame> elements.\n *\n * This polyfill isn't fool-proof either: On self-hosted builds, it may\n * not work due to browsers CORS policy or be loaded too late for some\n * libraries like SWFObject. These should be less of a problem on the\n * web extension. This polyfill should, however, do the trick in most\n * cases, but users should be aware of its natural limits.\n */\nlet iframes;\nlet frames;\n/**\n *\n */\nfunction polyfillFrames() {\n    // Create live collections to track embed tags.\n    iframes = iframes !== null && iframes !== void 0 ? iframes : document.getElementsByTagName(\"iframe\");\n    frames = frames !== null && frames !== void 0 ? frames : document.getElementsByTagName(\"frame\");\n    [iframes, frames].forEach((elements) => {\n        for (const element of elements) {\n            if (element.dataset[\"rufflePolyfilled\"] !== undefined) {\n                // Don't re-polyfill elements with the \"data-ruffle-polyfilled\" attribute.\n                continue;\n            }\n            element.dataset[\"rufflePolyfilled\"] = \"\";\n            const elementWindow = element.contentWindow;\n            // Cross origin requests may reach an exception, so let's prepare for this eventuality.\n            const errorMessage = `Couldn't load Ruffle into ${element.tagName}[${element.src}]: `;\n            try {\n                if (elementWindow.document.readyState === \"complete\") {\n                    injectRuffle(elementWindow, errorMessage);\n                }\n            }\n            catch (err) {\n                if (!isExtension) {\n                    // The web extension should be able to load Ruffle into cross origin frames\n                    // because it has \"all_frames\" set to true in its manifest.json: RufflePlayer\n                    // config won't be injected but it's not worth showing an error.\n                    console.warn(errorMessage + err);\n                }\n            }\n            // Attach listener to the element to handle frame navigation.\n            element.addEventListener(\"load\", () => {\n                injectRuffle(elementWindow, errorMessage);\n            }, false);\n        }\n    });\n}\n/**\n * @param elementWindow The (i)frame's window object.\n * @param errorMessage The message to log when Ruffle cannot access the (i)frame's document.\n */\nasync function injectRuffle(elementWindow, errorMessage) {\n    var _a;\n    // The document is supposed to be completely loaded when this function is run.\n    // As Chrome may be unable to access the document properties, we have to delay the execution a little bit.\n    await new Promise((resolve) => {\n        window.setTimeout(() => {\n            resolve();\n        }, 100);\n    });\n    let elementDocument;\n    try {\n        elementDocument = elementWindow.document;\n        if (!elementDocument) {\n            // Don't polyfill if the window has no document: the element may have been removed from the parent window.\n            return;\n        }\n    }\n    catch (err) {\n        if (!isExtension) {\n            console.warn(errorMessage + err);\n        }\n        return;\n    }\n    if (!isExtension &&\n        elementDocument.documentElement.dataset[\"ruffleOptout\"] !== undefined) {\n        // Don't polyfill elements with the \"data-ruffle-optout\" attribute.\n        return;\n    }\n    if (!isExtension) {\n        if (!elementWindow.RufflePlayer) {\n            const script = elementDocument.createElement(\"script\");\n            script.setAttribute(\"src\", jsScriptUrl);\n            script.onload = () => {\n                // Inject parent configuration once the script is loaded, preventing it from being ignored.\n                elementWindow.RufflePlayer = {};\n                elementWindow.RufflePlayer.config = globalConfig;\n            };\n            elementDocument.head.appendChild(script);\n        }\n    }\n    else {\n        if (!elementWindow.RufflePlayer) {\n            elementWindow.RufflePlayer = {};\n        }\n        // Merge parent window and frame configurations, will likely be applied too late though.\n        elementWindow.RufflePlayer.config = Object.assign(Object.assign({}, globalConfig), ((_a = elementWindow.RufflePlayer.config) !== null && _a !== void 0 ? _a : {}));\n    }\n}\n/**\n * Listen for changes to the DOM.\n */\nfunction initMutationObserver() {\n    const observer = new MutationObserver(function (mutationsList) {\n        // If any nodes were added, re-run the polyfill to detect any new instances.\n        const nodesAdded = mutationsList.some((mutation) => mutation.addedNodes.length > 0);\n        if (nodesAdded) {\n            polyfillFlashInstances();\n            polyfillFrames();\n        }\n    });\n    observer.observe(document, { childList: true, subtree: true });\n}\n/**\n * Polyfills the detection of Flash plugins in the browser.\n */\nexport function pluginPolyfill() {\n    installPlugin(FLASH_PLUGIN);\n}\n/**\n * Polyfills legacy Flash content on the page.\n *\n * @param isExt Whether or not Ruffle is running as a browser's extension.\n */\nexport function polyfill(isExt) {\n    var _a;\n    isExtension = isExt;\n    const usingExtension = ((_a = navigator.plugins.namedItem(\"Ruffle Extension\")) === null || _a === void 0 ? void 0 : _a.filename) ===\n        \"ruffle.js\";\n    if (isExtension || !usingExtension) {\n        polyfillFlashInstances();\n        polyfillFrames();\n        initMutationObserver();\n    }\n}\n","import { pluginPolyfill, polyfill } from \"./polyfills\";\nimport { registerElement } from \"./register-element\";\nimport { RufflePlayer } from \"./ruffle-player\";\nimport { buildInfo } from \"./build-info\";\n/**\n * Represents this particular version of Ruffle.\n *\n * Multiple APIs can be instantiated from different sources; e.g. an \"extension\"\n * version, versus a \"local\" version. This expresses to the Public API\n * negotiator (see [[PublicAPI]]) what this particular version of Ruffle is and\n * how to control it.\n */\nexport const SourceAPI = {\n    /**\n     * The version of this particular API, as a string in a semver compatible format.\n     */\n    version: buildInfo.versionNumber,\n    /**\n     * Start up the polyfills.\n     *\n     * Do not run polyfills for more than one Ruffle source at a time.\n     *\n     * @param isExt Whether or not Ruffle is running as a browser's extension.\n     */\n    polyfill(isExt) {\n        polyfill(isExt);\n    },\n    /**\n     * Polyfill the plugin detection.\n     *\n     * This needs to run before any plugin detection script does.\n     */\n    pluginPolyfill() {\n        pluginPolyfill();\n    },\n    /**\n     * Create a Ruffle player element using this particular version of Ruffle.\n     *\n     * @returns The player element. This is a DOM element that may be inserted\n     * into the current page as you wish.\n     */\n    createPlayer() {\n        const name = registerElement(\"ruffle-player\", RufflePlayer);\n        return document.createElement(name);\n    },\n};\n","import { Version } from \"./version\";\nimport { VersionRange } from \"./version-range\";\nimport { SourceAPI } from \"./source-api\";\n/**\n * Represents the Ruffle public API.\n *\n * The public API exists primarily to allow multiple installs of Ruffle on a\n * page (e.g. an extension install and a local one) to cooperate. In an ideal\n * situation, all Ruffle sources on the page install themselves into a single\n * public API, and then the public API picks the newest version by default.\n *\n * This API *is* versioned, in case we need to upgrade it. However, it must be\n * backwards- and forwards-compatible with all known sources.\n */\nexport class PublicAPI {\n    /**\n     * Construct the Ruffle public API.\n     *\n     * Do not use this function to negotiate a public API. Instead, use\n     * `public_api` to register your Ruffle source with an existing public API\n     * if it exists.\n     *\n     * Constructing a Public API will also trigger it to initialize Ruffle once\n     * the page loads, if the API has not already been superseded.\n     *\n     * @param prev What used to be in the public API slot.\n     *\n     * This is used to upgrade from a prior version of the public API, or from\n     * a user-defined configuration object placed in the public API slot.\n     */\n    constructor(prev) {\n        this.sources = {};\n        this.config = {};\n        this.invoked = false;\n        this.newestName = null;\n        this.conflict = null;\n        if (prev !== undefined && prev !== null) {\n            if (prev instanceof PublicAPI) {\n                // We're upgrading from a previous API to a new one.\n                this.sources = prev.sources;\n                this.config = prev.config;\n                this.invoked = prev.invoked;\n                this.conflict = prev.conflict;\n                this.newestName = prev.newestName;\n                prev.superseded();\n            }\n            else if (prev.constructor === Object &&\n                prev[\"config\"] instanceof Object) {\n                // We're the first, install user configuration.\n                this.config = prev[\"config\"];\n            }\n            else {\n                // We're the first, but conflicting with someone else.\n                this.conflict = prev;\n            }\n        }\n        if (document.readyState === \"loading\") {\n            // Cloudflare Rocket Loader interferes with the DOMContentLoaded event,\n            // so we listen for readystatechange instead\n            document.addEventListener(\"readystatechange\", this.init.bind(this));\n        }\n        else {\n            window.setTimeout(this.init.bind(this), 0);\n        }\n    }\n    /**\n     * The version of the public API.\n     *\n     * This is *not* the version of Ruffle itself.\n     *\n     * This allows a page with an old version of the Public API to be upgraded\n     * to a new version of the API. The public API is intended to be changed\n     * very infrequently, if at all, but this provides an escape mechanism for\n     * newer Ruffle sources to upgrade older installations.\n     *\n     * @returns The version of this public API.\n     */\n    get version() {\n        return \"0.1.0\";\n    }\n    /**\n     * Register a given source with the Ruffle Public API.\n     *\n     * @param name The name of the source.\n     */\n    registerSource(name) {\n        this.sources[name] = SourceAPI;\n    }\n    /**\n     * Determine the name of the newest registered source in the Public API.\n     *\n     * @returns The name of the source, or `null` if no source\n     * has yet to be registered.\n     */\n    newestSourceName() {\n        let newestName = null, newestVersion = Version.fromSemver(\"0.0.0\");\n        for (const k in this.sources) {\n            if (Object.prototype.hasOwnProperty.call(this.sources, k)) {\n                const kVersion = Version.fromSemver(this.sources[k].version);\n                if (kVersion.hasPrecedenceOver(newestVersion)) {\n                    newestName = k;\n                    newestVersion = kVersion;\n                }\n            }\n        }\n        return newestName;\n    }\n    /**\n     * Negotiate and start Ruffle.\n     *\n     * This function reads the config parameter to determine which polyfills\n     * should be enabled. If the configuration parameter is missing, then we\n     * use a built-in set of defaults sufficient to fool sites with static\n     * content and weak plugin detection.\n     */\n    init() {\n        if (!this.invoked) {\n            this.invoked = true;\n            this.newestName = this.newestSourceName();\n            if (this.newestName === null) {\n                throw new Error(\"No registered Ruffle source!\");\n            }\n            const polyfills = \"polyfills\" in this.config ? this.config.polyfills : true;\n            if (polyfills !== false) {\n                this.sources[this.newestName].polyfill(this.newestName === \"extension\");\n            }\n        }\n    }\n    /**\n     * Look up the newest Ruffle source and return it's API.\n     *\n     * @returns An instance of the Source API.\n     */\n    newest() {\n        const name = this.newestSourceName();\n        return name !== null ? this.sources[name] : null;\n    }\n    /**\n     * Look up a specific Ruffle version (or any version satisfying a given set\n     * of requirements) and return it's API.\n     *\n     * @param ver_requirement A set of semantic version requirement\n     * strings that the player version must satisfy.\n     * @returns An instance of the Source API, if one or more\n     * sources satisfied the requirement.\n     */\n    satisfying(ver_requirement) {\n        const requirement = VersionRange.fromRequirementString(ver_requirement);\n        let valid = null;\n        for (const k in this.sources) {\n            if (Object.prototype.hasOwnProperty.call(this.sources, k)) {\n                const version = Version.fromSemver(this.sources[k].version);\n                if (requirement.satisfiedBy(version)) {\n                    valid = this.sources[k];\n                }\n            }\n        }\n        return valid;\n    }\n    /**\n     * Look up the newest Ruffle version compatible with the `local` source, if\n     * it's installed. Otherwise, use the latest version.\n     *\n     * @returns An instance of the Source API\n     */\n    localCompatible() {\n        if (this.sources[\"local\"] !== undefined) {\n            return this.satisfying(\"^\" + this.sources[\"local\"].version);\n        }\n        else {\n            return this.newest();\n        }\n    }\n    /**\n     * Look up the newest Ruffle version with the exact same version as the\n     * `local` source, if it's installed. Otherwise, use the latest version.\n     *\n     * @returns An instance of the Source API\n     */\n    local() {\n        if (this.sources[\"local\"] !== undefined) {\n            return this.satisfying(\"=\" + this.sources[\"local\"].version);\n        }\n        else {\n            return this.newest();\n        }\n    }\n    /**\n     * Indicates that this version of the public API has been superseded by a\n     * newer version.\n     *\n     * This should only be called by a newer version of the Public API.\n     * Identical versions of the Public API should not supersede older versions\n     * of that same API.\n     *\n     * Unfortunately, we can't disable polyfills after-the-fact, so this\n     * only lets you disable the init event...\n     */\n    superseded() {\n        this.invoked = true;\n    }\n    /**\n     * Join a source into the public API, if it doesn't already exist.\n     *\n     * @param prevRuffle The previous iteration of the Ruffle API.\n     *\n     * The `prevRuffle` param lists the previous object in the RufflePlayer\n     * slot. We perform some checks to see if this is a Ruffle public API or a\n     * conflicting object. If this is conflicting, then a new public API will\n     * be constructed (see the constructor information for what happens to\n     * `prevRuffle`).\n     *\n     * Note that Public API upgrades are deliberately not enabled in this\n     * version of Ruffle, since there is no Public API to upgrade from.\n     * @param sourceName The name of this particular\n     * Ruffle source.\n     *\n     * If both parameters are provided they will be used to define a new Ruffle\n     * source to register with the public API.\n     * @returns The Ruffle Public API.\n     */\n    static negotiate(prevRuffle, sourceName) {\n        let publicAPI;\n        if (prevRuffle instanceof PublicAPI) {\n            publicAPI = prevRuffle;\n        }\n        else {\n            publicAPI = new PublicAPI(prevRuffle);\n        }\n        if (sourceName !== undefined) {\n            publicAPI.registerSource(sourceName);\n            // Install the faux plugin detection immediately.\n            // This is necessary because scripts such as SWFObject check for the\n            // Flash Player immediately when they load.\n            // TODO: Maybe there's a better place for this.\n            const polyfills = \"polyfills\" in publicAPI.config\n                ? publicAPI.config.polyfills\n                : true;\n            if (polyfills !== false) {\n                SourceAPI.pluginPolyfill();\n            }\n        }\n        return publicAPI;\n    }\n}\n","import { PublicAPI } from \"ruffle-core\";\n\nwindow.RufflePlayer = PublicAPI.negotiate(window.RufflePlayer, \"local\");\n"],"names":["inProgress","dataWebpackPrefix","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","id","loaded","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","f","e","chunkId","Promise","all","keys","reduce","promises","u","g","globalThis","this","Function","window","hmd","create","children","set","Error","obj","prop","prototype","hasOwnProperty","call","l","url","done","push","script","needAttach","scripts","document","getElementsByTagName","i","length","s","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","fn","setTimeout","bind","type","target","head","appendChild","r","Symbol","toStringTag","value","p","b","baseURI","self","location","href","installedChunks","j","installedChunkData","promise","resolve","reject","error","errorType","realSrc","message","name","request","webpackJsonpCallback","parentChunkLoadingFunction","data","chunkIds","moreModules","runtime","some","chunkLoadingGlobal","Version","constructor","major","minor","patch","prIdent","buildIdent","static","versionString","buildSplit","split","prSplit","versionSplit","parseInt","isCompatibleWith","other","hasPrecedenceOver","isNumeric","test","isEqual","isStableOrCompatiblePrerelease","VersionRange","requirements","satisfiedBy","fver","requirement","matches","comparator","version","components","component","match","exec","slice","index","trim","fromSemver","bulkMemory","async","WebAssembly","validate","Uint8Array","referenceTypes","saturatedFloatToInt","signExtensions","simd","isNativeFunction","func","val","toString","indexOf","currentScriptURL","currentScript","endsWith","URL","console","warn","publicPath","config","path","lastLoaded","loadRuffle","progressCallback","Array","args","Prototype","callback","TypeError","len","k","Window","Reflect","has","ownKeys","getOwnPropertyNames","getOwnPropertySymbols","extensionsSupported","every","Boolean","log","default","init","Ruffle","response","wasmUrl","wasmResponse","fetch","contentLength","headers","bytesLoaded","bytesTotal","Response","ReadableStream","controller","_a","reader","body","getReader","read","byteLength","enqueue","close","fetchRuffle","ruffleShadowTemplate","innerHTML","privateRegistry","registerElement","elementName","elementClass","registration","class","tries","customElements","externalName","define","internalName","DEFAULT_CONFIG","allowScriptAccess","parameters","autoplay","backgroundColor","letterbox","unmuteOverlay","upgradeToHttps","compatibilityRules","warnOnUnsupportedContent","logLevel","showSwfDownload","contextMenu","preloader","splashScreen","maxExecutionDuration","base","menu","salign","quality","scale","forceScale","frameRate","wmode","polyfills","playerVersion","preferredRenderer","openUrlMode","allowNetworking","FLASH_MIMETYPE","FUTURESPLASH_MIMETYPE","FLASH7_AND_8_MIMETYPE","FLASH_MOVIE_MIMETYPE","isSwfFilename","filename","pathname","err","extension","toLowerCase","isSwfMimeType","mimeType","buildInfo","FluentType","valueOf","FluentNone","super","scope","FluentNumber","opts","memoizeIntlObject","Intl","NumberFormat","format","reportError","FluentDateTime","DateTimeFormat","Date","toISOString","MAX_PLACEABLES","FSI","PDI","selector","PluralRules","select","getDefault","variants","star","resolvePattern","RangeError","getArguments","positional","named","arg","resolveExpression","expr","minimumFractionDigits","precision","params","ReferenceError","getTime","resolveVariableReference","attr","bundle","_messages","attribute","attributes","resolveMessageReference","term","_terms","resolved","resolveTermReference","_functions","resolveFunctionReference","sel","variant","resolveSelectExpression","resolveComplexPattern","ptn","dirty","add","result","useIsolating","_useIsolating","elem","placeables","delete","_transform","join","Scope","errors","WeakSet","ctor","cache","_intls","JSON","stringify","locales","values","allowed","unwrapped","opt","entries","includes","NUMBER_ALLOWED","NUMBER","DATETIME_ALLOWED","DATETIME","Map","FluentBundle","functions","transform","v","isArray","stringLocale","memoizer","getMemoizerForLocale","hasMessage","getMessage","addResource","res","allowOverrides","entry","startsWith","formatPattern","pattern","RE_MESSAGE_START","RE_ATTRIBUTE_START","RE_VARIANT_START","RE_NUMBER_LITERAL","RE_IDENTIFIER","RE_REFERENCE","RE_FUNCTION_NAME","RE_TEXT_RUN","RE_STRING_RUN","RE_STRING_ESCAPE","RE_UNICODE_ESCAPE","RE_LEADING_NEWLINES","RE_TRAILING_SPACES","RE_BLANK_LINES","RE_INDENT","TOKEN_BRACE_OPEN","TOKEN_BRACE_CLOSE","TOKEN_BRACKET_OPEN","TOKEN_BRACKET_CLOSE","TOKEN_PAREN_OPEN","TOKEN_ARROW","TOKEN_COLON","TOKEN_COMMA","TOKEN_BLANK","FluentResource","source","lastIndex","cursor","next","parseMessage","SyntaxError","re","consumeChar","char","errorClass","consumeToken","match1","parsePattern","attrs","parseAttributes","first","parsePatternElements","Infinity","indent","parseIndent","elements","commonIndent","parsePlaceable","Math","min","lastElement","baked","element","Indent","parseInlineExpression","count","parseVariantKey","parseVariants","sigil","parseArgument","parseArguments","parseLiteral","parseNumberLiteral","parseEscapeSequence","parseStringLiteral","fraction","parseFloat","codepoint4","codepoint6","codepoint","String","fromCodePoint","start","makeIndent","text","replace","blank","localeRe","RegExp","Locale","locale","isWellFormed","language","region","toUpperCase","thisRange","otherRange","filter","part","clearVariants","clearRegion","addLikelySubtags","newLocale","loc","likelySubtagsMin","regionMatchingLangs","getLikelySubtagsMin","ar","be","da","el","en","fa","ja","ko","pt","sr","sv","ta","uk","zh","BUNDLED_TEXTS","bundles","files","tryText","requestedLocales","availableLocales","strategy","defaultLocale","supportedLocales","Set","availableLocalesMap","outer","reqLocStr","reqLocStrLC","requestedLocale","from","availableLocale","filterMatches","map","negotiateLanguages","navigator","languages","textAsParagraphs","line","innerText","RUFFLE_ORIGIN","DIMENSION_REGEX","isAudioContextUnmuted","sanitizeParameters","URLSearchParams","output","Point","x","y","distanceTo","dx","dy","sqrt","RufflePlayer","HTMLElement","readyState","_readyState","metadata","_metadata","contextMenuForceDisabled","isTouch","contextMenuSupported","panicked","_cachedDebugInfo","isExtension","longPressTimer","pointerDownPosition","pointerMoveMaxDistance","shadow","attachShadow","mode","content","cloneNode","dynamicStyles","getElementById","container","playButton","addEventListener","play","virtualKeyboard","virtualKeyboardInput","saveManager","classList","modalArea","querySelector","stopPropagation","closeSaveManager","backupSaves","unmuteSvg","textContent","contextMenuElement","checkIfTouch","showContextMenu","pointerDown","checkLongPressMovement","checkLongPress","clearLongPressTimer","fullScreenChange","instance","onFSCommand","lastActivePlayingState","setupPauseOnTabHidden","hidden","is_playing","pause","connectedCallback","updateStyles","observedAttributes","attributeChangedCallback","_oldValue","_newValue","disconnectedCallback","destroy","sheet","rules","deleteRule","widthAttr","getNamedItem","width","htmlDimensionToCssDimension","insertRule","heightAttr","height","isUnusedFallbackObject","lookupElement","parent","nodeName","loadedConfig","showSplashScreen","ruffleConstructor","onRuffleDownloadProgress","catch","protocol","ruffleIndexError","userAgent","panic","renderer_debug_info","actuallyUsedRendererName","renderer_name","is_wasm_simd_used","audioState","style","visibility","unmuteAudioContext","blur","display","unmuteOverlayClicked","once","audioContext","audio_context","onstatechange","state","loadBar","outerLoadbar","Number","isNaN","checkOptions","options","check","condition","getExtensionConfig","conflict","_b","isConnected","isFallbackElement","extensionConfig","assign","ensureFreshInstance","swfUrl","substring","stream_from","load_data","swfFileName","isPlaying","volume","set_volume","fullscreenEnabled","webkitFullscreenEnabled","isFullscreen","fullscreenElement","webkitFullscreenElement","setFullscreen","isFull","enterFullscreen","exitFullscreen","navigationUI","requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","webkitExitFullscreen","webkitCancelFullScreen","set_fullscreen","pointerType","base64ToBlob","bytesBase64","mimeString","byteString","atob","ab","ArrayBuffer","ia","charCodeAt","Blob","saveFile","fileName","blob","blobURL","createObjectURL","link","download","click","revokeObjectURL","isB64SOL","solData","confirmReloadSave","solKey","b64SolData","localStorage","confirm","swfPath","swfHost","hostname","savePath","action","setItem","removeItem","load","populateSaves","replaceSOL","fileInput","FileReader","b64Regex","readAsDataURL","deleteSave","getItem","saveTable","solName","pop","row","keyCol","title","downloadCol","downloadSpan","className","replaceCol","replaceInput","accept","replaceLabel","htmlFor","deleteCol","deleteSpan","openSaveManager","remove","ok","blobUrl","swfDownloadA","pathName","lastIndexOf","input","string","eventType","dispatchEvent","KeyboardEvent","bubbles","openVirtualKeyboard","focus","preventScroll","contextMenuItems","CHECKMARK","fromCharCode","items","addSeparator","prepare_context_menu","item","separatorBefore","caption","checked","onClick","run_context_menu_callback","enabled","downloadSwf","isSecureContext","clipboard","writeText","getPanicData","localSaveTable","extensionString","flavor","open","pageX","pageY","startLongPressTimer","currentPosition","distance","_c","preventDefault","hideContextMenu","firstChild","menuSeparator","hr","menuItem","left","top","rect","getBoundingClientRect","clientX","clientY","maxX","clientWidth","maxY","clientHeight","floor","clear_custom_menu_items","resume","maxTouchPoints","audio","Audio","arrayBuffer","dataView","DataView","sampleRate","setUint32","setUint16","btoa","then","copyElement","specified","node","out","onCallbackAvailable","call_exposed_callback","traceObserver","observer","set_trace_observer","dataArray","debugPlayerInfo","platform","hideSplashScreen","errorIndex","errorArray","stackIndex","avmStackIndex","stack","avmStack","errorText","buildDate","monthsPrior","setMonth","getMonth","isBuildOutdated","actionTag","errorBody","errorFooter","pageUrl","issueLink","encodeURIComponent","issueBody","outdated","viewDetails","onclick","panicBody","panicText","readOnly","replaceChildren","displayRootMovieDownloadFailedMessage","origin","div","prepend","displayUnsupportedMessage","displayMessage","renderInfo","setMetadata","Event","LOADED_METADATA","LOADED_DATA","setIsExtension","isScriptAccessAllowed","access","isBuiltInContextMenuVisible","isYoutubeFlashSource","cleaned_hostname","workaroundYoutubeMixedContent","elem_attr","window_config","parentElement","tagName","RuffleEmbed","_d","_e","_f","_g","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","_t","_u","_v","srcval","createAttribute","setNamedItem","removeNamedItem","oldValue","newValue","ruffleObj","findCaseInsensitive","defaultValue","paramsOf","param","HTMLParamElement","RuffleObject","isSwf","movie_elem","movie_src","classid","isInterdictable","embedElem","objectElem","RuffleMimeTypeArray","mimeTypes","__mimeTypes","__namedMimeTypes","install","namedItem","iterator","RufflePlugin","description","RufflePluginArray","plugins","__plugins","__namedPlugins","plugin","refresh","FLASH_PLUGIN","RUFFLE_EXTENSION","suffixes","enabledPlugin","globalConfig","jsScriptUrl","objects","iframes","polyfillFlashInstances","ruffleObject","fromNativeObjectElement","replaceWith","ruffleEmbed","fromNativeEmbedElement","polyfillFrames","dataset","elementWindow","contentWindow","errorMessage","injectRuffle","elementDocument","documentElement","SourceAPI","polyfill","isExt","usingExtension","MutationObserver","mutationsList","mutation","addedNodes","observe","childList","subtree","pluginPolyfill","writable","installPlugin","createPlayer","PublicAPI","sources","invoked","newestName","superseded","registerSource","newestSourceName","newestVersion","kVersion","newest","satisfying","ver_requirement","fromRequirementString","valid","localCompatible","local","prevRuffle","sourceName","publicAPI","negotiate"],"sourceRoot":""}